
/*
Easy
Copyright (C) 2021 Università degli Studi di Catania (www.unict.it)
This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.
You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/


-- CREAZIONE VISTA paymentview
IF EXISTS(select * from sysobjects where id = object_id(N'[paymentview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [paymentview]
GO



-- Inserire la ALTER  VIEW qui--
CREATE                              VIEW [paymentview]
	(
	kpay,
	ypay,
	npay,
	idstamphandling,
	stamphandling,
	idtreasurer,
	codetreasurer,
	flag,
	kind,
	idreg,
	registry,
	idfin,
	codefin,
	finance,
	idman,
	manager,
	kpaymenttransmission,
  	ypaymenttransmission,
  	npaymenttransmission,
  	transmissiondate,
	adate,
	printdate,
	annulmentdate,
	cu,
	ct,
	lu,
	lt,
	total,
	performed,
	notperformed
	)
	AS SELECT
	payment.kpay,
	payment.ypay,
	payment.npay,
	payment.idstamphandling,
	stamphandling.description,
	payment.idtreasurer,
	treasurer.codetreasurer,
	payment.flag,
	CASE
		WHEN ((payment.flag&1)<> 0) THEN 'C'
		WHEN ((payment.flag&2)<> 0) THEN 'R'
		WHEN ((payment.flag&4)<> 0) THEN 'M'
	END, 
	payment.idreg,
	registry.title,
	payment.idfin,
	fin.codefin,
	fin.title,
	payment.idman,
	manager.title,
	payment.kpaymenttransmission,
  	paymenttransmission.ypaymenttransmission,
  	paymenttransmission.npaymenttransmission,
  	paymenttransmission.transmissiondate,
	payment.adate,
	payment.printdate,
	payment.annulmentdate,
	payment.cu,
	payment.ct,
	payment.lu,
	payment.lt,
	(SELECT SUM(curramount) from expensetotal I join expense S on I.idexp=S.idexp 
		JOIN expenselast EL ON EL.idexp = S.idexp
	 WHERE  EL.kpay=payment.kpay AND
	        I.ayear = payment.ypay),
	ISNULL((SELECT SUM(amount) from banktransaction P where
		P.kpay=payment.kpay),0),
	(SELECT SUM(curramount) from expensetotal I join expense S on I.idexp=S.idexp 
		JOIN expenselast EL ON EL.idexp = S.idexp
	  WHERE EL.kpay=payment.kpay AND I.ayear = payment.ypay)
	  -ISNULL( (SELECT SUM(amount) from banktransaction P where
		P.kpay=payment.kpay),0)
	FROM payment 
	LEFT OUTER JOIN registry 
	ON registry.idreg = payment.idreg
	LEFT OUTER JOIN fin 
	ON fin.idfin = payment.idfin 
	LEFT OUTER JOIN manager 
	ON manager.idman = payment.idman
	LEFT OUTER JOIN stamphandling
	ON stamphandling.idstamphandling = payment.idstamphandling
	LEFT OUTER JOIN paymenttransmission
	ON paymenttransmission.kpaymenttransmission = payment.kpaymenttransmission
	LEFT OUTER JOIN treasurer (NOLOCK)
	ON treasurer.idtreasurer = payment.idtreasurer











GO

-- VERIFICA DI paymentview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'paymentview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'paymentview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentview','N','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'annulmentdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '8',field = 'annulmentdate',col_precision = '' where tablename = 'paymentview' AND field = 'annulmentdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','paymentview','N','','8','annulmentdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'paymentview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','paymentview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'codetreasurer')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '20',field = 'codetreasurer',col_precision = '' where tablename = 'paymentview' AND field = 'codetreasurer'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','paymentview','N','','20','codetreasurer','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'paymentview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','paymentview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'paymentview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'paymentview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','paymentview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'paymentview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','paymentview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentview',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'paymentview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','paymentview','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'paymentview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'paymentview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'paymentview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'idstamphandling')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '4',field = 'idstamphandling',col_precision = '' where tablename = 'paymentview' AND field = 'idstamphandling'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentview','N','','4','idstamphandling','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'idtreasurer')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '4',field = 'idtreasurer',col_precision = '' where tablename = 'paymentview' AND field = 'idtreasurer'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentview','N','','4','idtreasurer','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'kind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '1',field = 'kind',col_precision = '' where tablename = 'paymentview' AND field = 'kind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','paymentview','N','','1','kind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentview',denynull = 'S',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'paymentview' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentview','S','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'kpaymenttransmission')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '4',field = 'kpaymenttransmission',col_precision = '' where tablename = 'paymentview' AND field = 'kpaymenttransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentview','N','','4','kpaymenttransmission','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'paymentview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','paymentview','N','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'paymentview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'paymentview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','paymentview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'paymentview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','paymentview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'notperformed')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '17',field = 'notperformed',col_precision = '38' where tablename = 'paymentview' AND field = 'notperformed'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(38,2)','N','paymentview','N','','17','notperformed','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentview',denynull = 'S',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'paymentview' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentview','S','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'npaymenttransmission')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '4',field = 'npaymenttransmission',col_precision = '' where tablename = 'paymentview' AND field = 'npaymenttransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentview','N','','4','npaymenttransmission','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'performed')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'paymentview',denynull = 'S',format = '',col_len = '17',field = 'performed',col_precision = '38' where tablename = 'paymentview' AND field = 'performed'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','N','System.Decimal','decimal(38,2)','N','paymentview','S','','17','performed','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'printdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '4',field = 'printdate',col_precision = '' where tablename = 'paymentview' AND field = 'printdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentview','N','','4','printdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'paymentview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','paymentview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'stamphandling')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '50',field = 'stamphandling',col_precision = '' where tablename = 'paymentview' AND field = 'stamphandling'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','paymentview','N','','50','stamphandling','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'total')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '17',field = 'total',col_precision = '38' where tablename = 'paymentview' AND field = 'total'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(38,2)','N','paymentview','N','','17','total','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'transmissiondate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '4',field = 'transmissiondate',col_precision = '' where tablename = 'paymentview' AND field = 'transmissiondate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentview','N','','4','transmissiondate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentview',denynull = 'S',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'paymentview' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','paymentview','S','','2','ypay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentview' AND field = 'ypaymenttransmission')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentview',denynull = 'N',format = '',col_len = '2',field = 'ypaymenttransmission',col_precision = '' where tablename = 'paymentview' AND field = 'ypaymenttransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','paymentview','N','','2','ypaymenttransmission','')
GO

-- VERIFICA DI paymentview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'paymentview')
UPDATE customobject set isreal = 'N' where objectname = 'paymentview'
ELSE
INSERT INTO customobject (objectname, isreal) values('paymentview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA proceedsview
IF EXISTS(select * from sysobjects where id = object_id(N'[proceedsview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [proceedsview]
GO


CREATE  VIEW [proceedsview]
	(
	kpro,
	ypro,
	npro,
	idtreasurer,
	codetreasurer,
	flag,
	kind,
	accountkind,
	idreg,
	registry,
	idfin,
	codefin,
	finance,
	idman,
	manager,
	kproceedstransmission,
	yproceedstransmission,
	nproceedstransmission,
	transmissiondate,
	adate,
	printdate,
	annulmentdate,
	cu,
	ct,
	lu,
	lt,	
	total,
	performed,
	notperformed
	)
	AS SELECT
	proceeds.kpro,
	proceeds.ypro,
	proceeds.npro,
	proceeds.idtreasurer,
	treasurer.codetreasurer,
	proceeds.flag,
	CASE
		WHEN ((proceeds.flag&1) <>0) THEN 'C'
		WHEN ((proceeds.flag&2) <>0) THEN 'R'
		WHEN ((proceeds.flag&4) <>0) THEN 'M'
	END, 
	CASE
		WHEN ((proceeds.flag&8)=0)  THEN 'I'
		WHEN ((proceeds.flag&8)<>0) THEN 'F'
	END, 
	proceeds.idreg,
	registry.title,
	proceeds.idfin,
	fin.codefin,
	fin.title,
	proceeds.idman,
	manager.title,
	proceedstransmission.kproceedstransmission,
	proceedstransmission.yproceedstransmission,
	proceedstransmission.nproceedstransmission,
	proceedstransmission.transmissiondate,
	proceeds.adate,
	proceeds.printdate,
	proceeds.annulmentdate,
	proceeds.cu,
	proceeds.ct,
	proceeds.lu,
	proceeds.lt,
	(SELECT SUM(curramount) 
	from incometotal I 
	join income S 
		on I.idinc=S.idinc
	join incomelast ST
		on S.idinc = ST.idinc
	WHERE ST.kpro=proceeds.kpro
			AND I.ayear = proceeds.ypro
	),
	ISNULL( (SELECT SUM(amount) from banktransaction P where
					P.kpro=proceeds.kpro),0),
	(SELECT SUM(curramount) 
	from incometotal I 
	join income S 
		on I.idinc=S.idinc 
	join incomelast ST
		on S.idinc = ST.idinc
	WHERE ST.kpro=proceeds.kpro AND I.ayear = proceeds.ypro)
	-
	 ISNULL( (SELECT SUM(amount) from banktransaction P where
					P.kpro=proceeds.kpro),0)                             
	FROM proceeds 
	LEFT OUTER JOIN registry 
		ON registry.idreg = proceeds.idreg
	LEFT OUTER JOIN fin 
		ON fin.idfin = proceeds.idfin
	LEFT OUTER JOIN manager 
		ON manager.idman = proceeds.idman
	LEFT OUTER JOIN proceedstransmission 
		ON proceedstransmission.kproceedstransmission = proceeds.kproceedstransmission
 	LEFT OUTER JOIN treasurer (NOLOCK)
		ON treasurer.idtreasurer = proceeds.idtreasurer



GO

-- VERIFICA DI proceedsview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'proceedsview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'accountkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '1',field = 'accountkind',col_precision = '' where tablename = 'proceedsview' AND field = 'accountkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','proceedsview','N','','1','accountkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedsview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'proceedsview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','proceedsview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'annulmentdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '8',field = 'annulmentdate',col_precision = '' where tablename = 'proceedsview' AND field = 'annulmentdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','proceedsview','N','','8','annulmentdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'proceedsview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','proceedsview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'codetreasurer')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '20',field = 'codetreasurer',col_precision = '' where tablename = 'proceedsview' AND field = 'codetreasurer'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','proceedsview','N','','20','codetreasurer','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'proceedsview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','proceedsview','N','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'proceedsview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'proceedsview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','proceedsview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'proceedsview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','proceedsview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'proceedsview',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'proceedsview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','proceedsview','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'proceedsview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'proceedsview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'proceedsview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'idtreasurer')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '4',field = 'idtreasurer',col_precision = '' where tablename = 'proceedsview' AND field = 'idtreasurer'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsview','N','','4','idtreasurer','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'kind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '1',field = 'kind',col_precision = '' where tablename = 'proceedsview' AND field = 'kind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','proceedsview','N','','1','kind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'kpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsview',denynull = 'S',format = '',col_len = '4',field = 'kpro',col_precision = '' where tablename = 'proceedsview' AND field = 'kpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedsview','S','','4','kpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'kproceedstransmission')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '4',field = 'kproceedstransmission',col_precision = '' where tablename = 'proceedsview' AND field = 'kproceedstransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsview','N','','4','kproceedstransmission','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'proceedsview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'proceedsview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','proceedsview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'proceedsview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'proceedsview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','proceedsview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'proceedsview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','proceedsview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'notperformed')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '17',field = 'notperformed',col_precision = '38' where tablename = 'proceedsview' AND field = 'notperformed'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(38,2)','N','proceedsview','N','','17','notperformed','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'npro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsview',denynull = 'S',format = '',col_len = '4',field = 'npro',col_precision = '' where tablename = 'proceedsview' AND field = 'npro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedsview','S','','4','npro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'nproceedstransmission')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '4',field = 'nproceedstransmission',col_precision = '' where tablename = 'proceedsview' AND field = 'nproceedstransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsview','N','','4','nproceedstransmission','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'performed')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'proceedsview',denynull = 'S',format = '',col_len = '17',field = 'performed',col_precision = '38' where tablename = 'proceedsview' AND field = 'performed'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','N','System.Decimal','decimal(38,2)','N','proceedsview','S','','17','performed','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'printdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '4',field = 'printdate',col_precision = '' where tablename = 'proceedsview' AND field = 'printdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedsview','N','','4','printdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'proceedsview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','proceedsview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'total')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '17',field = 'total',col_precision = '38' where tablename = 'proceedsview' AND field = 'total'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(38,2)','N','proceedsview','N','','17','total','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'transmissiondate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '4',field = 'transmissiondate',col_precision = '' where tablename = 'proceedsview' AND field = 'transmissiondate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedsview','N','','4','transmissiondate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'ypro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedsview',denynull = 'S',format = '',col_len = '2',field = 'ypro',col_precision = '' where tablename = 'proceedsview' AND field = 'ypro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','proceedsview','S','','2','ypro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsview' AND field = 'yproceedstransmission')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedsview',denynull = 'N',format = '',col_len = '2',field = 'yproceedstransmission',col_precision = '' where tablename = 'proceedsview' AND field = 'yproceedstransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','proceedsview','N','','2','yproceedstransmission','')
GO

-- VERIFICA DI proceedsview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'proceedsview')
UPDATE customobject set isreal = 'N' where objectname = 'proceedsview'
ELSE
INSERT INTO customobject (objectname, isreal) values('proceedsview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA banktransactionview
IF EXISTS(select * from sysobjects where id = object_id(N'[banktransactionview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [banktransactionview]
GO



CREATE  VIEW banktransactionview 
(
	yban,
	nban,
	kind,
	bankreference,
	transactiondate,
	valuedate,
	amount,
	kpay,
	ypay,
	npay,
	kpro,
	ypro,
	npro,
	income,
	expense,
	idexp,
	yexp,
	nexp,
	idinc,
	yinc,
	ninc,
	idpay,
	idpro,
	cu,
	ct,
	lu,
	lt
)
AS SELECT
	banktransaction.yban,
	banktransaction.nban,
	banktransaction.kind,
	banktransaction.bankreference,
	banktransaction.transactiondate,
	banktransaction.valuedate,
	banktransaction.amount,
	banktransaction.kpay,
	payment.ypay,
	payment.npay,
	banktransaction.kpro,
	proceeds.ypro,
	proceeds.npro,
	CASE
		WHEN banktransaction.kind = 'C'
		THEN banktransaction.amount
		ELSE NULL
	END,
	CASE
		WHEN banktransaction.kind = 'D'
		THEN banktransaction.amount
		ELSE NULL		
	END,
	banktransaction.idexp,
	expense.ymov,
	expense.nmov,
	banktransaction.idinc,
	income.ymov,
	income.nmov,
	banktransaction.idpay,
	banktransaction.idpro,
	banktransaction.cu,
	banktransaction.ct,
	banktransaction.lu,
	banktransaction.lt
FROM banktransaction
LEFT OUTER JOIN payment
	ON payment.kpay = banktransaction.kpay
LEFT OUTER JOIN proceeds
	ON proceeds.kpro = banktransaction.kpro
LEFT OUTER JOIN expense
	ON expense.idexp = banktransaction.idexp
LEFT OUTER JOIN income
	ON income.idinc = banktransaction.idinc

GO

-- VERIFICA DI banktransactionview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'banktransactionview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'banktransactionview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','banktransactionview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'bankreference')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '50',field = 'bankreference',col_precision = '' where tablename = 'banktransactionview' AND field = 'bankreference'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','banktransactionview','N','','50','bankreference','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'banktransactionview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'banktransactionview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','banktransactionview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'banktransactionview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'banktransactionview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','banktransactionview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'expense')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '9',field = 'expense',col_precision = '19' where tablename = 'banktransactionview' AND field = 'expense'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','banktransactionview','N','','9','expense','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'banktransactionview' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','banktransactionview','N','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'idinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '4',field = 'idinc',col_precision = '' where tablename = 'banktransactionview' AND field = 'idinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','banktransactionview','N','','4','idinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'idpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '4',field = 'idpay',col_precision = '' where tablename = 'banktransactionview' AND field = 'idpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','banktransactionview','N','','4','idpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'idpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '4',field = 'idpro',col_precision = '' where tablename = 'banktransactionview' AND field = 'idpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','banktransactionview','N','','4','idpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'income')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '9',field = 'income',col_precision = '19' where tablename = 'banktransactionview' AND field = 'income'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','banktransactionview','N','','9','income','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'kind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'banktransactionview',denynull = 'S',format = '',col_len = '1',field = 'kind',col_precision = '' where tablename = 'banktransactionview' AND field = 'kind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','N','System.String','char(1)','N','banktransactionview','S','','1','kind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'banktransactionview' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','banktransactionview','N','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'kpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '4',field = 'kpro',col_precision = '' where tablename = 'banktransactionview' AND field = 'kpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','banktransactionview','N','','4','kpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'banktransactionview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'banktransactionview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','banktransactionview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'banktransactionview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'banktransactionview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','banktransactionview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'nban')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'banktransactionview',denynull = 'S',format = '',col_len = '4',field = 'nban',col_precision = '' where tablename = 'banktransactionview' AND field = 'nban'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','banktransactionview','S','','4','nban','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'nexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '4',field = 'nexp',col_precision = '' where tablename = 'banktransactionview' AND field = 'nexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','banktransactionview','N','','4','nexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'ninc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '4',field = 'ninc',col_precision = '' where tablename = 'banktransactionview' AND field = 'ninc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','banktransactionview','N','','4','ninc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'banktransactionview' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','banktransactionview','N','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'npro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '4',field = 'npro',col_precision = '' where tablename = 'banktransactionview' AND field = 'npro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','banktransactionview','N','','4','npro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'transactiondate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '4',field = 'transactiondate',col_precision = '' where tablename = 'banktransactionview' AND field = 'transactiondate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','banktransactionview','N','','4','transactiondate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'valuedate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '4',field = 'valuedate',col_precision = '' where tablename = 'banktransactionview' AND field = 'valuedate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','banktransactionview','N','','4','valuedate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'yban')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'banktransactionview',denynull = 'S',format = '',col_len = '2',field = 'yban',col_precision = '' where tablename = 'banktransactionview' AND field = 'yban'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','banktransactionview','S','','2','yban','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'yexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '2',field = 'yexp',col_precision = '' where tablename = 'banktransactionview' AND field = 'yexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','banktransactionview','N','','2','yexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'yinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '2',field = 'yinc',col_precision = '' where tablename = 'banktransactionview' AND field = 'yinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','banktransactionview','N','','2','yinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'banktransactionview' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','banktransactionview','N','','2','ypay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'banktransactionview' AND field = 'ypro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'banktransactionview',denynull = 'N',format = '',col_len = '2',field = 'ypro',col_precision = '' where tablename = 'banktransactionview' AND field = 'ypro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','banktransactionview','N','','2','ypro','')
GO

-- VERIFICA DI banktransactionview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'banktransactionview')
UPDATE customobject set isreal = 'N' where objectname = 'banktransactionview'
ELSE
INSERT INTO customobject (objectname, isreal) values('banktransactionview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA casualcontracttaxbracketview
IF EXISTS(select * from sysobjects where id = object_id(N'[casualcontracttaxbracketview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [casualcontracttaxbracketview]
GO



CREATE  VIEW [casualcontracttaxbracketview]
(
	taxcode,
	description,
	taxref,
	ycon,
	ncon,
	nbracket,
	adminrate,
	employrate,
	taxablegross,
	deduction,
	totaltaxablenet,
	taxablenet,
	admindenominator,
	employdenominator,
	taxabledenominator,
	adminnumerator,
	employnumerator,
	taxablenumerator,
	totaladmintax,
	totalemploytax,
	admintax,
	employtax,
	employtaxgross,
	taxkind,
	lu,
	lt
)
AS SELECT
	CCT.taxcode,
	TR.description,
	TR.taxref,
	CCT.ycon,
	CCT.ncon,
	CCTB.nbracket,
	CCTB.adminrate,
	CCTB.employrate,
	CCT.taxablegross,
	CCT.deduction,
	CCT.taxablenet,
	CCTB.taxable,
	CCT.admindenominator,
	CCT.employdenominator,
	CCT.taxabledenominator,
	CCT.adminnumerator,
	CCT.employnumerator,
	CCT.taxablenumerator,
	CCT.admintax,
	CCT.employtax,
	CCTB.admintax,
	CCTB.employtax,
	CCT.employtaxgross,
	TR.taxkind,
	CCTB.lu,
	CCTB.lt
FROM casualcontracttaxbracket CCTB
JOIN casualcontracttax CCT
	ON CCTB.taxcode = CCT.taxcode
	AND CCTB.ycon = CCT.ycon
	AND CCTB.ncon = CCT.ncon
JOIN tax TR
	ON CCT.taxcode = TR.taxcode




GO

-- VERIFICA DI casualcontracttaxbracketview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'casualcontracttaxbracketview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'admindenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'N',format = '',col_len = '9',field = 'admindenominator',col_precision = '19' where tablename = 'casualcontracttaxbracketview' AND field = 'admindenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','casualcontracttaxbracketview','N','','9','admindenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'adminnumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'N',format = '',col_len = '9',field = 'adminnumerator',col_precision = '19' where tablename = 'casualcontracttaxbracketview' AND field = 'adminnumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','casualcontracttaxbracketview','N','','9','adminnumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'adminrate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'N',format = '',col_len = '9',field = 'adminrate',col_precision = '19' where tablename = 'casualcontracttaxbracketview' AND field = 'adminrate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','casualcontracttaxbracketview','N','','9','adminrate','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'admintax')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'N',format = '',col_len = '9',field = 'admintax',col_precision = '19' where tablename = 'casualcontracttaxbracketview' AND field = 'admintax'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','casualcontracttaxbracketview','N','','9','admintax','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'deduction')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'N',format = '',col_len = '9',field = 'deduction',col_precision = '19' where tablename = 'casualcontracttaxbracketview' AND field = 'deduction'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','casualcontracttaxbracketview','N','','9','deduction','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'S',format = '',col_len = '50',field = 'description',col_precision = '' where tablename = 'casualcontracttaxbracketview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','casualcontracttaxbracketview','S','','50','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'employdenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'N',format = '',col_len = '9',field = 'employdenominator',col_precision = '19' where tablename = 'casualcontracttaxbracketview' AND field = 'employdenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','casualcontracttaxbracketview','N','','9','employdenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'employnumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'N',format = '',col_len = '9',field = 'employnumerator',col_precision = '19' where tablename = 'casualcontracttaxbracketview' AND field = 'employnumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','casualcontracttaxbracketview','N','','9','employnumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'employrate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'N',format = '',col_len = '9',field = 'employrate',col_precision = '19' where tablename = 'casualcontracttaxbracketview' AND field = 'employrate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','casualcontracttaxbracketview','N','','9','employrate','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'employtax')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'N',format = '',col_len = '9',field = 'employtax',col_precision = '19' where tablename = 'casualcontracttaxbracketview' AND field = 'employtax'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','casualcontracttaxbracketview','N','','9','employtax','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'employtaxgross')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'N',format = '',col_len = '9',field = 'employtaxgross',col_precision = '19' where tablename = 'casualcontracttaxbracketview' AND field = 'employtaxgross'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','casualcontracttaxbracketview','N','','9','employtaxgross','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'casualcontracttaxbracketview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','casualcontracttaxbracketview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'casualcontracttaxbracketview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','casualcontracttaxbracketview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'nbracket')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'S',format = '',col_len = '4',field = 'nbracket',col_precision = '' where tablename = 'casualcontracttaxbracketview' AND field = 'nbracket'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','casualcontracttaxbracketview','S','','4','nbracket','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'ncon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'S',format = '',col_len = '4',field = 'ncon',col_precision = '' where tablename = 'casualcontracttaxbracketview' AND field = 'ncon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','casualcontracttaxbracketview','S','','4','ncon','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'taxabledenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'N',format = '',col_len = '9',field = 'taxabledenominator',col_precision = '19' where tablename = 'casualcontracttaxbracketview' AND field = 'taxabledenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','casualcontracttaxbracketview','N','','9','taxabledenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'taxablegross')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'N',format = '',col_len = '9',field = 'taxablegross',col_precision = '19' where tablename = 'casualcontracttaxbracketview' AND field = 'taxablegross'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','casualcontracttaxbracketview','N','','9','taxablegross','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'taxablenet')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'N',format = '',col_len = '9',field = 'taxablenet',col_precision = '19' where tablename = 'casualcontracttaxbracketview' AND field = 'taxablenet'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','casualcontracttaxbracketview','N','','9','taxablenet','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'taxablenumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'N',format = '',col_len = '9',field = 'taxablenumerator',col_precision = '19' where tablename = 'casualcontracttaxbracketview' AND field = 'taxablenumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','casualcontracttaxbracketview','N','','9','taxablenumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'taxcode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'S',format = '',col_len = '4',field = 'taxcode',col_precision = '' where tablename = 'casualcontracttaxbracketview' AND field = 'taxcode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','casualcontracttaxbracketview','S','','4','taxcode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'taxkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'S',format = '',col_len = '2',field = 'taxkind',col_precision = '' where tablename = 'casualcontracttaxbracketview' AND field = 'taxkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','casualcontracttaxbracketview','S','','2','taxkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'taxref')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'S',format = '',col_len = '20',field = 'taxref',col_precision = '' where tablename = 'casualcontracttaxbracketview' AND field = 'taxref'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','casualcontracttaxbracketview','S','','20','taxref','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'totaladmintax')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'N',format = '',col_len = '9',field = 'totaladmintax',col_precision = '19' where tablename = 'casualcontracttaxbracketview' AND field = 'totaladmintax'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','casualcontracttaxbracketview','N','','9','totaladmintax','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'totalemploytax')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'N',format = '',col_len = '9',field = 'totalemploytax',col_precision = '19' where tablename = 'casualcontracttaxbracketview' AND field = 'totalemploytax'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','casualcontracttaxbracketview','N','','9','totalemploytax','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'totaltaxablenet')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'N',format = '',col_len = '9',field = 'totaltaxablenet',col_precision = '19' where tablename = 'casualcontracttaxbracketview' AND field = 'totaltaxablenet'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','casualcontracttaxbracketview','N','','9','totaltaxablenet','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxbracketview' AND field = 'ycon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'casualcontracttaxbracketview',denynull = 'S',format = '',col_len = '4',field = 'ycon',col_precision = '' where tablename = 'casualcontracttaxbracketview' AND field = 'ycon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','casualcontracttaxbracketview','S','','4','ycon','')
GO

-- VERIFICA DI casualcontracttaxbracketview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'casualcontracttaxbracketview')
UPDATE customobject set isreal = 'N' where objectname = 'casualcontracttaxbracketview'
ELSE
INSERT INTO customobject (objectname, isreal) values('casualcontracttaxbracketview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA casualcontracttaxview
IF EXISTS(select * from sysobjects where id = object_id(N'[casualcontracttaxview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [casualcontracttaxview]
GO





CREATE VIEW [casualcontracttaxview]
(
	taxcode,
	description,
	taxref,
	ycon,
	ncon,
	adminrate,
	employrate,
	taxablegross,
	taxablenet,
	admindenominator,
	employdenominator,
	taxabledenominator,
	adminnumerator,
	employnumerator,
	taxablenumerator,
	admintax,
	employtax,
	employtaxgross,
	taxkind
)
AS SELECT
	COPR.taxcode,
	TR.description,
	TR.taxref,
	COPR.ycon,
	COPR.ncon,
	COPR.adminrate,
	COPR.employrate,
	COPR.taxablegross,
	COPR.taxablenet,
	COPR.admindenominator,
	COPR.employdenominator,
	COPR.taxabledenominator,
	COPR.adminnumerator,
	COPR.employnumerator,
	COPR.taxablenumerator,
	COPR.admintax,
	COPR.employtax,
	COPR.employtaxgross,
	TR.taxkind
FROM casualcontracttax COPR
JOIN tax TR
	ON COPR.taxcode = TR.taxcode







GO

-- VERIFICA DI casualcontracttaxview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'casualcontracttaxview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxview' AND field = 'admindenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'casualcontracttaxview',denynull = 'N',format = '',col_len = '9',field = 'admindenominator',col_precision = '19' where tablename = 'casualcontracttaxview' AND field = 'admindenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','casualcontracttaxview','N','','9','admindenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxview' AND field = 'adminnumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'casualcontracttaxview',denynull = 'N',format = '',col_len = '9',field = 'adminnumerator',col_precision = '19' where tablename = 'casualcontracttaxview' AND field = 'adminnumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','casualcontracttaxview','N','','9','adminnumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxview' AND field = 'adminrate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'casualcontracttaxview',denynull = 'N',format = '',col_len = '9',field = 'adminrate',col_precision = '19' where tablename = 'casualcontracttaxview' AND field = 'adminrate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','casualcontracttaxview','N','','9','adminrate','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxview' AND field = 'admintax')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'casualcontracttaxview',denynull = 'N',format = '',col_len = '9',field = 'admintax',col_precision = '19' where tablename = 'casualcontracttaxview' AND field = 'admintax'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','casualcontracttaxview','N','','9','admintax','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'casualcontracttaxview',denynull = 'S',format = '',col_len = '50',field = 'description',col_precision = '' where tablename = 'casualcontracttaxview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','casualcontracttaxview','S','','50','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxview' AND field = 'employdenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'casualcontracttaxview',denynull = 'N',format = '',col_len = '9',field = 'employdenominator',col_precision = '19' where tablename = 'casualcontracttaxview' AND field = 'employdenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','casualcontracttaxview','N','','9','employdenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxview' AND field = 'employnumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'casualcontracttaxview',denynull = 'N',format = '',col_len = '9',field = 'employnumerator',col_precision = '19' where tablename = 'casualcontracttaxview' AND field = 'employnumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','casualcontracttaxview','N','','9','employnumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxview' AND field = 'employrate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'casualcontracttaxview',denynull = 'N',format = '',col_len = '9',field = 'employrate',col_precision = '19' where tablename = 'casualcontracttaxview' AND field = 'employrate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','casualcontracttaxview','N','','9','employrate','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxview' AND field = 'employtax')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'casualcontracttaxview',denynull = 'N',format = '',col_len = '9',field = 'employtax',col_precision = '19' where tablename = 'casualcontracttaxview' AND field = 'employtax'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','casualcontracttaxview','N','','9','employtax','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxview' AND field = 'employtaxgross')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'casualcontracttaxview',denynull = 'N',format = '',col_len = '9',field = 'employtaxgross',col_precision = '19' where tablename = 'casualcontracttaxview' AND field = 'employtaxgross'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','casualcontracttaxview','N','','9','employtaxgross','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxview' AND field = 'ncon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'casualcontracttaxview',denynull = 'S',format = '',col_len = '4',field = 'ncon',col_precision = '' where tablename = 'casualcontracttaxview' AND field = 'ncon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','casualcontracttaxview','S','','4','ncon','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxview' AND field = 'taxabledenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'casualcontracttaxview',denynull = 'N',format = '',col_len = '9',field = 'taxabledenominator',col_precision = '19' where tablename = 'casualcontracttaxview' AND field = 'taxabledenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','casualcontracttaxview','N','','9','taxabledenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxview' AND field = 'taxablegross')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'casualcontracttaxview',denynull = 'N',format = '',col_len = '9',field = 'taxablegross',col_precision = '19' where tablename = 'casualcontracttaxview' AND field = 'taxablegross'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','casualcontracttaxview','N','','9','taxablegross','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxview' AND field = 'taxablenet')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'casualcontracttaxview',denynull = 'N',format = '',col_len = '9',field = 'taxablenet',col_precision = '19' where tablename = 'casualcontracttaxview' AND field = 'taxablenet'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','casualcontracttaxview','N','','9','taxablenet','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxview' AND field = 'taxablenumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'casualcontracttaxview',denynull = 'N',format = '',col_len = '9',field = 'taxablenumerator',col_precision = '19' where tablename = 'casualcontracttaxview' AND field = 'taxablenumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','casualcontracttaxview','N','','9','taxablenumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxview' AND field = 'taxcode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'casualcontracttaxview',denynull = 'S',format = '',col_len = '4',field = 'taxcode',col_precision = '' where tablename = 'casualcontracttaxview' AND field = 'taxcode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','casualcontracttaxview','S','','4','taxcode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxview' AND field = 'taxkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'casualcontracttaxview',denynull = 'S',format = '',col_len = '2',field = 'taxkind',col_precision = '' where tablename = 'casualcontracttaxview' AND field = 'taxkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','casualcontracttaxview','S','','2','taxkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxview' AND field = 'taxref')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'casualcontracttaxview',denynull = 'S',format = '',col_len = '20',field = 'taxref',col_precision = '' where tablename = 'casualcontracttaxview' AND field = 'taxref'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','casualcontracttaxview','S','','20','taxref','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'casualcontracttaxview' AND field = 'ycon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'casualcontracttaxview',denynull = 'S',format = '',col_len = '4',field = 'ycon',col_precision = '' where tablename = 'casualcontracttaxview' AND field = 'ycon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','casualcontracttaxview','S','','4','ycon','')
GO

-- VERIFICA DI casualcontracttaxview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'casualcontracttaxview')
UPDATE customobject set isreal = 'N' where objectname = 'casualcontracttaxview'
ELSE
INSERT INTO customobject (objectname, isreal) values('casualcontracttaxview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA estimateresidual
IF EXISTS(select * from sysobjects where id = object_id(N'[estimateresidual]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [estimateresidual]
GO




--select * from estimateresidual
CREATE     VIEW [estimateresidual]
	(
	idestimkind,	
	yestim,
	nestim,
	estimkind,
	description,
	idreg,
	idupb,
	registry,
	taxabletotal,
	ivatotal,
	residual,
	linkedimpon,
	linkedimpos,
	linkedestim,
	active,
	upb
	)
	AS SELECT
	estimatedetail.idestimkind,
	estimatedetail.yestim,
	estimatedetail.nestim,
	estimatekind.description,
	estimate.description,
	isnull(estimate.idreg,estimatedetail.idreg),
	estimatedetail.idupb,
	CASE
	WHEN estimate.idreg is not null THEN (select title from
					registry 
					where idreg= estimate.idreg)
	WHEN estimatedetail.idreg is not null THEN (select title from
					registry 
					where idreg= estimatedetail.idreg)
	ELSE null
	END,
	CONVERT(DECIMAL(19,2),
		ISNULL(SUM(
	   	     ROUND(estimatedetail.taxable * estimatedetail.number * 
	     	     CONVERT(decimal(19,6),estimate.exchangerate) * 
	     	     (1 - CONVERT(decimal(19,6),ISNULL(estimatedetail.discount, 0.0))),2)
	   ),0)
	),
	CONVERT(DECIMAL(19,2),
		ISNULL(SUM(
	   	     ROUND(estimatedetail.tax * CONVERT(decimal(19,6), estimate.exchangerate),2)
	   ),0)
	),
	--residuo :somma dei dett. ordine non contabilizzati
	CONVERT(DECIMAL(19,2),
		ISNULL(SUM(
		    CASE 
			WHEN (estimatedetail.idinc_taxable IS  NULL) AND (estimatedetail.idinc_iva IS  NOT NULL)
			THEN
			     ROUND(estimatedetail.taxable * estimatedetail.number * 
		     	     CONVERT(decimal(19,6),estimate.exchangerate) * 
		     	     (1 - CONVERT(decimal(19,6),ISNULL(estimatedetail.discount, 0.0))),2)

			WHEN ( estimatedetail.idinc_iva IS NULL) AND (estimatedetail.idinc_taxable IS  NOT NULL)
			THEN
			      ROUND(estimatedetail.tax * CONVERT(decimal(19,6), estimate.exchangerate),2)

			WHEN ( estimatedetail.idinc_iva IS  NULL) AND (estimatedetail.idinc_taxable IS  NULL)
			THEN
			     ROUND(estimatedetail.taxable * estimatedetail.number * 
		     	     CONVERT(decimal(19,6),estimate.exchangerate) * 
		     	     (1 - CONVERT(decimal(19,6),ISNULL(estimatedetail.discount, 0.0))),2)
			     +
			     ROUND(estimatedetail.tax * CONVERT(decimal(19,6), estimate.exchangerate),2)
			ELSE   0

		    END
		   ),0)
		),

-- (mov.movkind = '3' )
	CONVERT(DECIMAL(19,2),
		ISNULL(SUM(
		    CASE 
			WHEN (estimatedetail.idinc_taxable IS NOT NULL 
				AND (estimatedetail.idinc_iva IS NULL OR estimatedetail.idinc_taxable<>estimatedetail.idinc_iva)) 
			THEN
			     ROUND(estimatedetail.taxable * estimatedetail.number * 
		     	     CONVERT(decimal(19,6),estimate.exchangerate) * 
		     	     (1 - CONVERT(decimal(19,6),ISNULL(estimatedetail.discount, 0.0))),2)
			ELSE   0
		    END
			
		   ),0)
		),

-- (mov.movkind = '2')
	CONVERT(DECIMAL(19,2),
		ISNULL(SUM(
		    CASE 
			WHEN (estimatedetail.idinc_iva IS NOT NULL 
			      AND (estimatedetail.idinc_taxable IS NULL OR estimatedetail.idinc_taxable<>estimatedetail.idinc_iva)) 
			THEN
			       ROUND(estimatedetail.tax * CONVERT(decimal(19,6), estimate.exchangerate),2)
			ELSE   0
		    END
			
		   ),0)
		),

--  (mov.movkind = '1' )
	CONVERT(DECIMAL(19,2),
		ISNULL(SUM(
		    CASE 
			WHEN (estimatedetail.idinc_taxable IS NOT NULL AND estimatedetail.idinc_iva= estimatedetail.idinc_taxable)
			THEN
			     ROUND(estimatedetail.taxable * estimatedetail.number * 
		     	     CONVERT(decimal(19,6),estimate.exchangerate) * 
		     	     (1 - CONVERT(decimal(19,6),ISNULL(estimatedetail.discount, 0.0))),2)
			     +
			     ROUND(estimatedetail.tax * CONVERT(decimal(19,6), estimate.exchangerate),2)
			ELSE   0
		    END
			
		   ),0)
		),
	estimate.active,
	upb.title
FROM estimatedetail (NOLOCK)
JOIN estimate (NOLOCK)
  	ON estimatedetail.idestimkind = estimate.idestimkind
	AND estimatedetail.yestim = estimate.yestim
  	AND estimatedetail.nestim = estimate.nestim
JOIN estimatekind
	ON estimatekind.idestimkind = estimate.idestimkind
LEFT OUTER JOIN upb
	ON upb.idupb=estimatedetail.idupb
GROUP BY estimatedetail.idestimkind, estimatedetail.yestim, estimatedetail.nestim,
	estimate.idreg,estimatedetail.idreg,estimatedetail.idupb,
	estimatekind.description,estimate.description,
	estimate.active,upb.title



GO

-- VERIFICA DI estimateresidual IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'estimateresidual'
IF exists(SELECT * FROM columntypes WHERE tablename = 'estimateresidual' AND field = 'active')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'estimateresidual',denynull = 'N',format = '',col_len = '1',field = 'active',col_precision = '' where tablename = 'estimateresidual' AND field = 'active'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','estimateresidual','N','','1','active','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'estimateresidual' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'estimateresidual',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'estimateresidual' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','estimateresidual','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'estimateresidual' AND field = 'estimkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'estimateresidual',denynull = 'S',format = '',col_len = '150',field = 'estimkind',col_precision = '' where tablename = 'estimateresidual' AND field = 'estimkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','estimateresidual','S','','150','estimkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'estimateresidual' AND field = 'idestimkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'estimateresidual',denynull = 'S',format = '',col_len = '20',field = 'idestimkind',col_precision = '' where tablename = 'estimateresidual' AND field = 'idestimkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','estimateresidual','S','','20','idestimkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'estimateresidual' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'estimateresidual',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'estimateresidual' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','estimateresidual','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'estimateresidual' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'estimateresidual',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'estimateresidual' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','estimateresidual','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'estimateresidual' AND field = 'ivatotal')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'estimateresidual',denynull = 'N',format = '',col_len = '9',field = 'ivatotal',col_precision = '19' where tablename = 'estimateresidual' AND field = 'ivatotal'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','estimateresidual','N','','9','ivatotal','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'estimateresidual' AND field = 'linkedestim')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'estimateresidual',denynull = 'N',format = '',col_len = '9',field = 'linkedestim',col_precision = '19' where tablename = 'estimateresidual' AND field = 'linkedestim'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','estimateresidual','N','','9','linkedestim','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'estimateresidual' AND field = 'linkedimpon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'estimateresidual',denynull = 'N',format = '',col_len = '9',field = 'linkedimpon',col_precision = '19' where tablename = 'estimateresidual' AND field = 'linkedimpon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','estimateresidual','N','','9','linkedimpon','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'estimateresidual' AND field = 'linkedimpos')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'estimateresidual',denynull = 'N',format = '',col_len = '9',field = 'linkedimpos',col_precision = '19' where tablename = 'estimateresidual' AND field = 'linkedimpos'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','estimateresidual','N','','9','linkedimpos','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'estimateresidual' AND field = 'nestim')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'estimateresidual',denynull = 'S',format = '',col_len = '4',field = 'nestim',col_precision = '' where tablename = 'estimateresidual' AND field = 'nestim'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','estimateresidual','S','','4','nestim','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'estimateresidual' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'estimateresidual',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'estimateresidual' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','estimateresidual','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'estimateresidual' AND field = 'residual')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'estimateresidual',denynull = 'N',format = '',col_len = '9',field = 'residual',col_precision = '19' where tablename = 'estimateresidual' AND field = 'residual'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','estimateresidual','N','','9','residual','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'estimateresidual' AND field = 'taxabletotal')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'estimateresidual',denynull = 'N',format = '',col_len = '9',field = 'taxabletotal',col_precision = '19' where tablename = 'estimateresidual' AND field = 'taxabletotal'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','estimateresidual','N','','9','taxabletotal','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'estimateresidual' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'estimateresidual',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'estimateresidual' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','estimateresidual','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'estimateresidual' AND field = 'yestim')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'estimateresidual',denynull = 'S',format = '',col_len = '2',field = 'yestim',col_precision = '' where tablename = 'estimateresidual' AND field = 'yestim'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','estimateresidual','S','','2','yestim','')
GO

-- VERIFICA DI estimateresidual IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'estimateresidual')
UPDATE customobject set isreal = 'N' where objectname = 'estimateresidual'
ELSE
INSERT INTO customobject (objectname, isreal) values('estimateresidual', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA expenditurearrears
IF EXISTS(select * from sysobjects where id = object_id(N'[expenditurearrears]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [expenditurearrears]
GO







CREATE  VIEW [expenditurearrears]
(
	ayear,
	idexp,
	ymov,
	nmov,
	adate,
	residualamount,
	totflag,
	flagarrear
)
AS
SELECT 
i1.ayear,s1.idexp,s1.ymov,s1.nmov,s1.adate,
ISNULL(i2.curramount,0.0) - ISNULL((SELECT SUM(ISNULL(i3.curramount,0.0)) FROM expense s3
	 JOIN expensetotal i3
	 ON s3.idexp = i3.idexp
	 JOIN expenselast l1
	 ON l1.idexp = s3.idexp
	 JOIN expenselink el
	 ON el.idparent = s1.idexp
	 AND el.idchild = s3.idexp
	 JOIN payment d1
	 ON d1.kpay = l1.kpay
	 JOIN paymenttransmission t1
	 ON t1.kpaymenttransmission = d1.kpaymenttransmission
	 WHERE i3.ayear = i1.ayear),0.0),
	i2.flag,
CASE
	WHEN ((i2.flag&1)=0) THEN 'C'
	WHEN ((i2.flag&1)=1) THEN 'R'
END
FROM expense s1
INNER JOIN expenseyear i1 
ON s1.idexp = i1.idexp 
INNER JOIN expensetotal i2
ON i1.idexp = i2.idexp
AND i1.ayear = i2.ayear
INNER JOIN config p1
ON p1.appropriationphasecode = s1.nphase
AND p1.ayear = i1.ayear
WHERE i2.curramount >
	ISNULL((SELECT SUM(ISNULL(i3.curramount,0.0)) FROM expense s3
	 JOIN expensetotal i3
	 ON s3.idexp = i3.idexp
	 JOIN expenselast l1
	 ON l1.idexp = s3.idexp
	 JOIN expenselink el
	 ON el.idparent = s1.idexp
	 AND el.idchild = s3.idexp
	 JOIN payment d1
	 ON d1.kpay = l1.kpay
	 JOIN paymenttransmission t1
	 ON t1.kpaymenttransmission = d1.kpaymenttransmission
	 WHERE i3.ayear = i1.ayear),0.0)


GO

-- VERIFICA DI expenditurearrears IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'expenditurearrears'
IF exists(SELECT * FROM columntypes WHERE tablename = 'expenditurearrears' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expenditurearrears',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'expenditurearrears' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','expenditurearrears','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenditurearrears' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenditurearrears',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'expenditurearrears' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expenditurearrears','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenditurearrears' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'expenditurearrears',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'expenditurearrears' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','expenditurearrears','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenditurearrears' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenditurearrears',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'expenditurearrears' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expenditurearrears','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenditurearrears' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenditurearrears',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'expenditurearrears' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expenditurearrears','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenditurearrears' AND field = 'residualamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'expenditurearrears',denynull = 'N',format = '',col_len = '17',field = 'residualamount',col_precision = '38' where tablename = 'expenditurearrears' AND field = 'residualamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(38,2)','N','expenditurearrears','N','','17','residualamount','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenditurearrears' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenditurearrears',denynull = 'N',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'expenditurearrears' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expenditurearrears','N','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenditurearrears' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenditurearrears',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'expenditurearrears' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expenditurearrears','S','','2','ymov','')
GO

-- VERIFICA DI expenditurearrears IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'expenditurearrears')
UPDATE customobject set isreal = 'N' where objectname = 'expenditurearrears'
ELSE
INSERT INTO customobject (objectname, isreal) values('expenditurearrears', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA expensecasualcontractview
IF EXISTS(select * from sysobjects where id = object_id(N'[expensecasualcontractview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [expensecasualcontractview]
GO


CREATE   VIEW [expensecasualcontractview]
(
	ycon,
	ncon,
	idexp,
	nphase,
	phase,
	ymov,
	nmov,
	parentidexp,
	parentymov,
	parentnmov,
	ayear,
	idfin,
	codefin,
	finance,
	idupb,
	codeupb,
	upb,
	idreg,
	registry,
	idman,
	manager,
	kpay,
	ypay,
	npay,
	doc,
	docdate,
	description,
	amount,
	ayearstartamount,
	curramount,
	available,
	idpaymethod,
	iban,
	cin,
	idbank,
	idcab,
	cc,
	paymentdescr,
	idser,
	service,
	codeser,
	servicestart,
	servicestop,
	ivaamount,
	flag,
	autokind,
	idpayment,
	totflag, 
	flagarrear,
	expiration,
	adate,
	cu, ct, lu, lt
)
AS SELECT
	expensecasualcontract.ycon,
	expensecasualcontract.ncon,
	expense.idexp,
	expense.nphase,
	expensephase.description,
	expense.ymov,
	expense.nmov,
	expense.parentidexp,
	parentexpense.ymov,
	parentexpense.nmov,
	expenseyear.ayear,
	expenseyear.idfin,
	fin.codefin,
	fin.title,
	upb.idupb,
	upb.codeupb,
	upb.title,
	expense.idreg,
	registry.title,
	expense.idman,
	manager.title,
	expenselast.kpay,
	payment.ypay,
	payment.npay,
	expense.doc,
	expense.docdate,
	expense.description,
	expenseyear_starting.amount, 
	expenseyear.amount,
	expensetotal.curramount,
	expensetotal.available,
	expenselast.idpaymethod,
	expenselast.iban,
	expenselast.cin,
	expenselast.idbank,
	expenselast.idcab,
	expenselast.cc,
	expenselast.paymentdescr,
	expenselast.idser,
	service.description,
	service.codeser,
	expenselast.servicestart,
	expenselast.servicestop,
	expenselast.ivaamount,
	expenselast.flag,
	expense.autokind,
	expense.idpayment,
	expensetotal.flag,
	CASE
		WHEN ((expensetotal.flag&1)=0) THEN 'C'
		WHEN ((expensetotal.flag&1)=1) THEN 'R'
	END, 
	expense.expiration,
	expense.adate,
	expensecasualcontract.cu,
	expensecasualcontract.ct,
	expensecasualcontract.lu,
	expensecasualcontract.lt
FROM expensecasualcontract
JOIN casualcontract
	ON expensecasualcontract.ycon = casualcontract.ycon
	AND expensecasualcontract.ncon = casualcontract.ncon
JOIN config
	ON config.ayear=expensecasualcontract.ycon 
JOIN expense
	ON expense.idexp = expensecasualcontract.idexp
JOIN expensephase
	ON expensephase.nphase = expense.nphase
JOIN expenseyear
	ON expenseyear.idexp = expense.idexp
JOIN expensetotal
	ON expensetotal.idexp = expenseyear.idexp
	AND expensetotal.ayear = expenseyear.ayear
LEFT OUTER JOIN expense parentexpense
	ON parentexpense.idexp = expense.parentidexp
LEFT OUTER JOIN expensetotal expensetotal_firstyear
	ON expensetotal_firstyear.idexp = expense.idexp
	AND ((expensetotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN expenseyear expenseyear_starting
	ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
	AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
LEFT OUTER JOIN expenselast
	ON expenselast.idexp = expense.idexp
LEFT OUTER JOIN fin
	ON fin.idfin = expenseyear.idfin
LEFT OUTER JOIN upb
	on upb.idupb = expenseyear.idupb
LEFT OUTER JOIN registry
	ON registry.idreg = expense.idreg
LEFT OUTER JOIN manager
	ON manager.idman = expense.idman
LEFT OUTER JOIN service
	ON service.idser = expenselast.idser
LEFT OUTER JOIN payment 
	ON payment.kpay = expenselast.kpay

GO

-- VERIFICA DI expensecasualcontractview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'expensecasualcontractview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','expensecasualcontractview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'expensecasualcontractview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensecasualcontractview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expensecasualcontractview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'expensecasualcontractview' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensecasualcontractview','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expensecasualcontractview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'ayearstartamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '9',field = 'ayearstartamount',col_precision = '19' where tablename = 'expensecasualcontractview' AND field = 'ayearstartamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensecasualcontractview','N','','9','ayearstartamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'cc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(30)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '30',field = 'cc',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'cc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(30)','N','expensecasualcontractview','N','','30','cc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'cin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(2)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '2',field = 'cin',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'cin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(2)','N','expensecasualcontractview','N','','2','cin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expensecasualcontractview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'codeser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '20',field = 'codeser',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'codeser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expensecasualcontractview','N','','20','codeser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expensecasualcontractview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expensecasualcontractview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expensecasualcontractview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'expensecasualcontractview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensecasualcontractview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','expensecasualcontractview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','expensecasualcontractview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expensecasualcontractview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expensecasualcontractview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expensecasualcontractview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expensecasualcontractview','N','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','expensecasualcontractview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'iban')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '50',field = 'iban',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'iban'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expensecasualcontractview','N','','50','iban','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'idbank')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '20',field = 'idbank',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'idbank'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expensecasualcontractview','N','','20','idbank','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'idcab')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '20',field = 'idcab',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'idcab'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expensecasualcontractview','N','','20','idcab','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensecasualcontractview','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensecasualcontractview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensecasualcontractview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensecasualcontractview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'idpaymethod')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '4',field = 'idpaymethod',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'idpaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensecasualcontractview','N','','4','idpaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensecasualcontractview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensecasualcontractview','N','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','expensecasualcontractview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'ivaamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '9',field = 'ivaamount',col_precision = '19' where tablename = 'expensecasualcontractview' AND field = 'ivaamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensecasualcontractview','N','','9','ivaamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensecasualcontractview','N','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expensecasualcontractview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expensecasualcontractview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expensecasualcontractview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'ncon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'S',format = '',col_len = '4',field = 'ncon',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'ncon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensecasualcontractview','S','','4','ncon','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensecasualcontractview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensecasualcontractview','N','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','expensecasualcontractview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'parentidexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '4',field = 'parentidexp',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'parentidexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensecasualcontractview','N','','4','parentidexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensecasualcontractview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expensecasualcontractview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'paymentdescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '150',field = 'paymentdescr',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'paymentdescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expensecasualcontractview','N','','150','paymentdescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','expensecasualcontractview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','expensecasualcontractview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expensecasualcontractview','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'servicestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '8',field = 'servicestart',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expensecasualcontractview','N','','8','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'servicestop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '8',field = 'servicestop',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expensecasualcontractview','N','','8','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expensecasualcontractview','N','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expensecasualcontractview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'ycon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'S',format = '',col_len = '4',field = 'ycon',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'ycon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensecasualcontractview','S','','4','ycon','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expensecasualcontractview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensecasualcontractview' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensecasualcontractview',denynull = 'N',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'expensecasualcontractview' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expensecasualcontractview','N','','2','ypay','')
GO

-- VERIFICA DI expensecasualcontractview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'expensecasualcontractview')
UPDATE customobject set isreal = 'N' where objectname = 'expensecasualcontractview'
ELSE
INSERT INTO customobject (objectname, isreal) values('expensecasualcontractview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA expenseinvoiceview
IF EXISTS(select * from sysobjects where id = object_id(N'[expenseinvoiceview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [expenseinvoiceview]
GO



CREATE  VIEW expenseinvoiceview 
(
	idinvkind,
	codeinvkind,
	invoicekind,
	yinv,
	ninv,
	movkind,
	idexp,
	nphase,
	phase,
	ymov,
	nmov,
	parentidexp,
	parentymov,
	parentnmov,
	ayear,
	idfin,
	codefin,
	finance,
	idupb,
	codeupb,
	upb,
	idreg,
	registry,
	idman,
	manager,
	kpay,
	ypay,
	npay,
	doc,
	docdate,
	description,
	amount,
	ayearstartamount,
	curramount,
	available,
	idpaymethod,
	iban,
	cin,
	idbank,
	idcab,
	cc,
	paymentdescr,
	idser,
	service,
	servicestart,
	servicestop,
	ivaamount,
	flag,
	totflag, 
	flagarrear,
	autokind,
	idpayment,
	expiration,
	adate,
	cu,
	ct,
	lu,
	lt
)
	AS SELECT
	expenseinvoice.idinvkind,
	invoicekind.codeinvkind,
	invoicekind.description,
	expenseinvoice.yinv,
	expenseinvoice.ninv,
	expenseinvoice.movkind,
	expenseinvoice.idexp,
	expense.nphase,
	expensephase.description,
	expense.ymov,
	expense.nmov,
	expense.parentidexp,
	parentexpense.ymov,
	parentexpense.nmov,
	expenseyear.ayear,
	expenseyear.idfin,
	fin.codefin,
	fin.title,
	upb.idupb,	
	upb.codeupb,	
	upb.title,	
	expense.idreg,
	registry.title,
	expense.idman,
	manager.title,
	expenselast.kpay,
	payment.ypay,
	payment.npay,
	expense.doc,
	expense.docdate,
	expense.description,
	expenseyear_starting.amount,
	expenseyear.amount,
	expensetotal.curramount,
	expensetotal.available,
	expenselast.idpaymethod,
	expenselast.iban,
	expenselast.cin,
	expenselast.idbank,
	expenselast.idcab,
	expenselast.cc,
	expenselast.paymentdescr,
	expenselast.idser,
	service.description,
	expenselast.servicestart,
	expenselast.servicestop,
	expenselast.ivaamount,
	expenselast.flag,
	expensetotal.flag,
	CASE
		WHEN ((expensetotal.flag&1)=0) THEN 'C'
		WHEN ((expensetotal.flag&1)=1) THEN 'R'
	END, 
	expense.autokind,
	expense.idpayment,
	expense.expiration,
	expense.adate,
	expenseinvoice.cu,
	expenseinvoice.ct,
	expenseinvoice.lu,
	expenseinvoice.lt
	FROM expenseinvoice 
	JOIN invoicekind 
		ON invoicekind.idinvkind = expenseinvoice.idinvkind
	JOIN expense  
		ON expense.idexp = expenseinvoice.idexp
	JOIN expensephase 
		ON expensephase.nphase = expense.nphase
	JOIN expenseyear 
		ON expenseyear.idexp = expense.idexp
	JOIN expensetotal 
		ON expensetotal.idexp = expenseyear.idexp
		AND expensetotal.ayear = expenseyear.ayear
	LEFT OUTER JOIN expense parentexpense  
		ON expense.parentidexp = parentexpense.idexp
	LEFT OUTER JOIN expensetotal expensetotal_firstyear
		ON expensetotal_firstyear.idexp = expense.idexp
		AND ((expensetotal_firstyear.flag & 2) <> 0 )
	LEFT OUTER JOIN expenseyear expenseyear_starting 
		ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
		AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
	LEFT OUTER JOIN expenselast  
		ON expense.idexp = expenselast.idexp
	LEFT OUTER JOIN fin 
		ON fin.idfin = expenseyear.idfin
	LEFT OUTER JOIN upb
		on upb.idupb = expenseyear.idupb
	LEFT OUTER JOIN registry 
		ON registry.idreg = expense.idreg
	LEFT OUTER JOIN manager 
		ON manager.idman = expense.idman
	LEFT OUTER JOIN service 
		ON service.idser = expenselast.idser
	LEFT OUTER JOIN payment 
		ON payment.kpay = expenselast.kpay


GO

-- VERIFICA DI expenseinvoiceview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'expenseinvoiceview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','expenseinvoiceview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'expenseinvoiceview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseinvoiceview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expenseinvoiceview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'expenseinvoiceview' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseinvoiceview','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expenseinvoiceview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'ayearstartamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '9',field = 'ayearstartamount',col_precision = '19' where tablename = 'expenseinvoiceview' AND field = 'ayearstartamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseinvoiceview','N','','9','ayearstartamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'cc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(30)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '30',field = 'cc',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'cc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(30)','N','expenseinvoiceview','N','','30','cc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'cin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(2)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '2',field = 'cin',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'cin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(2)','N','expenseinvoiceview','N','','2','cin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenseinvoiceview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'codeinvkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'S',format = '',col_len = '20',field = 'codeinvkind',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'codeinvkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','expenseinvoiceview','S','','20','codeinvkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenseinvoiceview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expenseinvoiceview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expenseinvoiceview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'expenseinvoiceview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseinvoiceview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','expenseinvoiceview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','expenseinvoiceview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expenseinvoiceview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expenseinvoiceview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenseinvoiceview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expenseinvoiceview','N','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','expenseinvoiceview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'iban')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '50',field = 'iban',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'iban'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenseinvoiceview','N','','50','iban','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'idbank')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '20',field = 'idbank',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'idbank'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expenseinvoiceview','N','','20','idbank','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'idcab')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '20',field = 'idcab',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'idcab'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expenseinvoiceview','N','','20','idcab','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expenseinvoiceview','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseinvoiceview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'idinvkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'S',format = '',col_len = '4',field = 'idinvkind',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'idinvkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expenseinvoiceview','S','','4','idinvkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseinvoiceview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseinvoiceview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'idpaymethod')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'idpaymethod',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'idpaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseinvoiceview','N','','4','idpaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseinvoiceview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseinvoiceview','N','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','expenseinvoiceview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'invoicekind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'S',format = '',col_len = '50',field = 'invoicekind',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'invoicekind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','expenseinvoiceview','S','','50','invoicekind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'ivaamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '9',field = 'ivaamount',col_precision = '19' where tablename = 'expenseinvoiceview' AND field = 'ivaamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseinvoiceview','N','','9','ivaamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseinvoiceview','N','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expenseinvoiceview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expenseinvoiceview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenseinvoiceview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'movkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'S',format = '',col_len = '2',field = 'movkind',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'movkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expenseinvoiceview','S','','2','movkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'ninv')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'S',format = '',col_len = '4',field = 'ninv',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'ninv'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expenseinvoiceview','S','','4','ninv','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expenseinvoiceview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseinvoiceview','N','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','expenseinvoiceview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'parentidexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'parentidexp',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'parentidexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseinvoiceview','N','','4','parentidexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseinvoiceview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expenseinvoiceview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'paymentdescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '150',field = 'paymentdescr',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'paymentdescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenseinvoiceview','N','','150','paymentdescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','expenseinvoiceview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','expenseinvoiceview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenseinvoiceview','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'servicestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '8',field = 'servicestart',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expenseinvoiceview','N','','8','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'servicestop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '8',field = 'servicestop',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expenseinvoiceview','N','','8','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expenseinvoiceview','N','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenseinvoiceview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'yinv')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'S',format = '',col_len = '2',field = 'yinv',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'yinv'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expenseinvoiceview','S','','2','yinv','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expenseinvoiceview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseinvoiceview' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseinvoiceview',denynull = 'N',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'expenseinvoiceview' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expenseinvoiceview','N','','2','ypay','')
GO

-- VERIFICA DI expenseinvoiceview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'expenseinvoiceview')
UPDATE customobject set isreal = 'N' where objectname = 'expenseinvoiceview'
ELSE
INSERT INTO customobject (objectname, isreal) values('expenseinvoiceview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA expenseitinerationview
IF EXISTS(select * from sysobjects where id = object_id(N'[expenseitinerationview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [expenseitinerationview]
GO



CREATE   VIEW [expenseitinerationview]
(
	iditineration,
	yitineration,
	nitineration,
	movkind,
	idexp,
	nphase,
	phase,
	ymov,
	nmov,
	parentidexp,
	parentymov,
	parentnmov,
	ayear,
	idfin,
	codefin,
	finance,
	idupb,
	codeupb,
	upb,
	idreg,
	registry,
	idman,
	manager,
	kpay,
	ypay,
	npay,
	doc,
	docdate,
	description,
	amount,
	ayearstartamount,
	curramount,
	available,
	idpaymethod,
	iban,
	cin,
	idbank,
	idcab,
	cc,
	paymentdescr,
	idser,
	service,
	codeser,
	servicestart,
	servicestop,
	ivaamount,
	flag,
	autokind,
	idpayment,
	totflag,
	flagarrear,
	expiration,
	adate,
	cu, ct, lu, lt
)
AS SELECT
	expenseitineration.iditineration,
	itineration.yitineration,
	itineration.nitineration,
	expenseitineration.movkind,
	expense.idexp,
	expense.nphase,
	expensephase.description,
	expense.ymov,
	expense.nmov,
	expense.parentidexp,
	parentexpense.ymov,
	parentexpense.nmov,
	expenseyear.ayear,
	expenseyear.idfin,
	fin.codefin,
	fin.title,
	upb.idupb,	
	upb.codeupb,	
	upb.title,	
	expense.idreg,
	registry.title,
	expense.idman,
	manager.title,
	expenselast.kpay,
	payment.ypay,
	payment.npay,
	expense.doc,
	expense.docdate,
	expense.description,
	expenseyear_starting.amount,
	expenseyear.amount,
	expensetotal.curramount,
	expensetotal.available,
	expenselast.idpaymethod,
	expenselast.iban,
	expenselast.cin,
	expenselast.idbank,
	expenselast.idcab,
	expenselast.cc,
	expenselast.paymentdescr,
	expenselast.idser,
	service.description,
	service.codeser,
	expenselast.servicestart,
	expenselast.servicestop,
	expenselast.ivaamount,
	expenselast.flag,
	expense.autokind,
	expense.idpayment,
	expensetotal.flag,
	CASE
		WHEN ((expensetotal.flag&1)=0) THEN 'C'
		WHEN ((expensetotal.flag&1)=1) THEN 'R'
	END, 
	expense.expiration,
	expense.adate,
	expenseitineration.cu,
	expenseitineration.ct,
	expenseitineration.lu,
	expenseitineration.lt
FROM expenseitineration
JOIN itineration 
	ON itineration.iditineration = expenseitineration.iditineration
JOIN config
	ON config.ayear=itineration.yitineration 
JOIN expense
	ON expense.idexp = expenseitineration.idexp
JOIN expensephase
	ON expensephase.nphase = expense.nphase
JOIN expenseyear
	ON expenseyear.idexp = expense.idexp
JOIN expensetotal
	ON expensetotal.idexp = expenseyear.idexp
	AND expensetotal.ayear = expenseyear.ayear
LEFT OUTER JOIN expense parentexpense 
	ON expense.parentidexp = parentexpense.idexp
LEFT OUTER JOIN expensetotal expensetotal_firstyear
	ON expensetotal_firstyear.idexp = expense.idexp
	AND ((expensetotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN expenseyear expenseyear_starting
	ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
	AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
LEFT OUTER JOIN expenselast
	ON expense.idexp = expenselast.idexp
LEFT OUTER JOIN fin
	ON fin.idfin = expenseyear.idfin
LEFT OUTER JOIN upb
	on upb.idupb = expenseyear.idupb
LEFT OUTER JOIN registry
	ON registry.idreg = expense.idreg
LEFT OUTER JOIN manager
	ON manager.idman = expense.idman
LEFT OUTER JOIN service
	ON service.idser = expenselast.idser
LEFT OUTER JOIN payment 
	ON payment.kpay = expenselast.kpay


GO

-- VERIFICA DI expenseitinerationview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'expenseitinerationview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','expenseitinerationview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'expenseitinerationview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseitinerationview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expenseitinerationview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'expenseitinerationview' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseitinerationview','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expenseitinerationview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'ayearstartamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '9',field = 'ayearstartamount',col_precision = '19' where tablename = 'expenseitinerationview' AND field = 'ayearstartamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseitinerationview','N','','9','ayearstartamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'cc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(30)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '30',field = 'cc',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'cc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(30)','N','expenseitinerationview','N','','30','cc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'cin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(2)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '2',field = 'cin',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'cin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(2)','N','expenseitinerationview','N','','2','cin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenseitinerationview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'codeser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '20',field = 'codeser',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'codeser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expenseitinerationview','N','','20','codeser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenseitinerationview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expenseitinerationview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expenseitinerationview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'expenseitinerationview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseitinerationview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','expenseitinerationview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','expenseitinerationview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expenseitinerationview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expenseitinerationview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenseitinerationview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expenseitinerationview','N','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','expenseitinerationview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'iban')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '50',field = 'iban',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'iban'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenseitinerationview','N','','50','iban','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'idbank')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '20',field = 'idbank',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'idbank'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expenseitinerationview','N','','20','idbank','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'idcab')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '20',field = 'idcab',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'idcab'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expenseitinerationview','N','','20','idcab','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expenseitinerationview','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseitinerationview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'iditineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'S',format = '',col_len = '4',field = 'iditineration',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'iditineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expenseitinerationview','S','','4','iditineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseitinerationview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseitinerationview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'idpaymethod')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '4',field = 'idpaymethod',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'idpaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseitinerationview','N','','4','idpaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseitinerationview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseitinerationview','N','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','expenseitinerationview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'ivaamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '9',field = 'ivaamount',col_precision = '19' where tablename = 'expenseitinerationview' AND field = 'ivaamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseitinerationview','N','','9','ivaamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseitinerationview','N','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expenseitinerationview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expenseitinerationview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenseitinerationview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'movkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'S',format = '',col_len = '2',field = 'movkind',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'movkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expenseitinerationview','S','','2','movkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'nitineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'S',format = '',col_len = '4',field = 'nitineration',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'nitineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expenseitinerationview','S','','4','nitineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expenseitinerationview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseitinerationview','N','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','expenseitinerationview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'parentidexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '4',field = 'parentidexp',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'parentidexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseitinerationview','N','','4','parentidexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseitinerationview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expenseitinerationview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'paymentdescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '150',field = 'paymentdescr',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'paymentdescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenseitinerationview','N','','150','paymentdescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','expenseitinerationview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','expenseitinerationview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenseitinerationview','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'servicestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '8',field = 'servicestart',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expenseitinerationview','N','','8','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'servicestop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '8',field = 'servicestop',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expenseitinerationview','N','','8','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expenseitinerationview','N','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenseitinerationview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'yitineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'S',format = '',col_len = '2',field = 'yitineration',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'yitineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expenseitinerationview','S','','2','yitineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expenseitinerationview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseitinerationview' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseitinerationview',denynull = 'N',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'expenseitinerationview' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expenseitinerationview','N','','2','ypay','')
GO

-- VERIFICA DI expenseitinerationview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'expenseitinerationview')
UPDATE customobject set isreal = 'N' where objectname = 'expenseitinerationview'
ELSE
INSERT INTO customobject (objectname, isreal) values('expenseitinerationview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA expenselastview
IF EXISTS(select * from sysobjects where id = object_id(N'[expenselastview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [expenselastview]
GO



CREATE     VIEW expenselastview
(
	idexp,
	nphase,
	phase,
	ymov,
	nmov,
	parentidexp,
	parentymov,
	parentnmov,
	idformerexpense,
	ayear,
	idfin,
	codefin,
	finance,
	idupb,
	codeupb,
	upb,
	idreg,
	registry,
	idman,
	manager,
	kpay,
	ypay,
	npay,
	paymentadate,
	doc,
	docdate,
	description,
	amount,
	ayearstartamount,
	curramount,
	available,
	idregistrypaymethod,
	idpaymethod,
	iban,
	cin,
	idbank,
	idcab,
	cc,
	iddeputy,
	deputy,
	refexternaldoc,
	paymentdescr,
	idser,
	service,
	codeser,
	servicestart,
	servicestop,
	ivaamount,
	flag,
	totflag,
	flagarrear,
	autokind,
	idpayment,
	expiration,
	adate,
	autocode,
	idclawback,
	clawback,
	clawbackref,
	nbill,
	idpay,
	txt,
	cu,
	ct,
	lu,
	lt
)
AS SELECT
	expense.idexp,
	expense.nphase,
	expensephase.description,
	expense.ymov,
	expense.nmov,
	expense.parentidexp,
	parentexpense.ymov,
	parentexpense.nmov,
	expense.idformerexpense,
	expenseyear.ayear,
	expenseyear.idfin,
	fin.codefin,
	fin.title,
	upb.idupb,
	upb.codeupb,
	upb.title,
	expense.idreg,
	registry.title,
	expense.idman,
	manager.title,
	expenselast.kpay,
	payment.ypay,
	payment.npay,
	payment.adate,
	expense.doc,
	expense.docdate,
	expense.description,
	expenseyear_starting.amount,
	expenseyear.amount,
	expensetotal.curramount,
	expensetotal.available,
	expenselast.idregistrypaymethod,
	expenselast.idpaymethod,
	expenselast.iban,
	expenselast.cin,
	expenselast.idbank,
	expenselast.idcab,
	expenselast.cc,
	expenselast.iddeputy,  
	deputy.title,
	expenselast.refexternaldoc,
	expenselast.paymentdescr,
	expenselast.idser,
	service.description,
	service.codeser,
	expenselast.servicestart,
	expenselast.servicestop,
	expenselast.ivaamount,
	expenselast.flag,
	expensetotal.flag,
	CASE
		WHEN ((expensetotal.flag&1)=0) THEN 'C'
		WHEN ((expensetotal.flag&1)=1) THEN 'R'
	END, 
	expense.autokind,
	expense.idpayment,
	expense.expiration,
	expense.adate,
	expense.autocode,
	expense.idclawback,
	clawback.description,
	clawback.clawbackref,
	expenselast.nbill,
	expenselast.idpay,
	expense.txt,
	expenselast.cu,
	expenselast.ct,
	expenselast.lu,
	expenselast.lt
FROM expense
JOIN expensephase
	ON expensephase.nphase = expense.nphase
JOIN expenseyear
	ON expenseyear.idexp = expense.idexp
JOIN expensetotal
	ON expensetotal.idexp = expense.idexp
	AND expensetotal.ayear = expenseyear.ayear
LEFT OUTER JOIN expense parentexpense
	ON parentexpense.idexp = expense.parentidexp
JOIN expenselast 
	ON expenselast.idexp = expense.idexp
LEFT OUTER JOIN fin
	ON fin.idfin = expenseyear.idfin
LEFT OUTER JOIN upb
	ON upb.idupb = expenseyear.idupb
LEFT OUTER JOIN registry
	ON registry.idreg = expense.idreg
LEFT OUTER JOIN manager
	ON manager.idman = expense.idman
LEFT OUTER JOIN service
	ON service.idser = expenselast.idser
LEFT OUTER JOIN payment
	ON payment.kpay = expenselast.kpay
LEFT OUTER JOIN registry deputy
	ON deputy.idreg = expenselast.iddeputy
LEFT OUTER JOIN clawback
	ON clawback.idclawback = expense.idclawback
LEFT OUTER JOIN expensetotal expensetotal_firstyear
  	ON expensetotal_firstyear.idexp = expense.idexp
  	AND ((expensetotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN expenseyear expenseyear_starting
	ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
  	AND expenseyear_starting.ayear = expensetotal_firstyear.ayear


GO

-- VERIFICA DI expenselastview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'expenselastview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expenselastview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'expenselastview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','expenselastview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'expenselastview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenselastview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'autocode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'autocode',col_precision = '' where tablename = 'expenselastview' AND field = 'autocode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenselastview','N','','4','autocode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'expenselastview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expenselastview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'expenselastview' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenselastview','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenselastview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'expenselastview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expenselastview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'ayearstartamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '9',field = 'ayearstartamount',col_precision = '19' where tablename = 'expenselastview' AND field = 'ayearstartamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenselastview','N','','9','ayearstartamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'cc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(30)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '30',field = 'cc',col_precision = '' where tablename = 'expenselastview' AND field = 'cc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(30)','N','expenselastview','N','','30','cc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'cin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(2)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '2',field = 'cin',col_precision = '' where tablename = 'expenselastview' AND field = 'cin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(2)','N','expenselastview','N','','2','cin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'clawback')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '50',field = 'clawback',col_precision = '' where tablename = 'expenselastview' AND field = 'clawback'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenselastview','N','','50','clawback','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'clawbackref')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '20',field = 'clawbackref',col_precision = '' where tablename = 'expenselastview' AND field = 'clawbackref'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expenselastview','N','','20','clawbackref','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'expenselastview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenselastview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'codeser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '20',field = 'codeser',col_precision = '' where tablename = 'expenselastview' AND field = 'codeser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expenselastview','N','','20','codeser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'expenselastview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenselastview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenselastview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'expenselastview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expenselastview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expenselastview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'expenselastview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expenselastview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'expenselastview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenselastview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'deputy')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '100',field = 'deputy',col_precision = '' where tablename = 'expenselastview' AND field = 'deputy'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','expenselastview','N','','100','deputy','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenselastview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'expenselastview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','expenselastview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'expenselastview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','expenselastview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'expenselastview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expenselastview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'expenselastview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expenselastview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'expenselastview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenselastview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenselastview',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'expenselastview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','expenselastview','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'expenselastview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','expenselastview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'iban')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '50',field = 'iban',col_precision = '' where tablename = 'expenselastview' AND field = 'iban'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenselastview','N','','50','iban','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'idbank')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '20',field = 'idbank',col_precision = '' where tablename = 'expenselastview' AND field = 'idbank'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expenselastview','N','','20','idbank','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'idcab')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '20',field = 'idcab',col_precision = '' where tablename = 'expenselastview' AND field = 'idcab'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expenselastview','N','','20','idcab','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'idclawback')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'idclawback',col_precision = '' where tablename = 'expenselastview' AND field = 'idclawback'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenselastview','N','','4','idclawback','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'iddeputy')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'iddeputy',col_precision = '' where tablename = 'expenselastview' AND field = 'iddeputy'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenselastview','N','','4','iddeputy','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenselastview',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'expenselastview' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expenselastview','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'expenselastview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenselastview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'idformerexpense')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'idformerexpense',col_precision = '' where tablename = 'expenselastview' AND field = 'idformerexpense'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenselastview','N','','4','idformerexpense','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'expenselastview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenselastview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'idpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'idpay',col_precision = '' where tablename = 'expenselastview' AND field = 'idpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenselastview','N','','4','idpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'expenselastview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenselastview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'idpaymethod')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'idpaymethod',col_precision = '' where tablename = 'expenselastview' AND field = 'idpaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenselastview','N','','4','idpaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'expenselastview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenselastview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'idregistrypaymethod')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'idregistrypaymethod',col_precision = '' where tablename = 'expenselastview' AND field = 'idregistrypaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenselastview','N','','4','idregistrypaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'expenselastview' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenselastview','N','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'expenselastview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','expenselastview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'ivaamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '9',field = 'ivaamount',col_precision = '19' where tablename = 'expenselastview' AND field = 'ivaamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenselastview','N','','9','ivaamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'expenselastview' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenselastview','N','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenselastview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'expenselastview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expenselastview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expenselastview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'expenselastview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expenselastview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'expenselastview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenselastview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'nbill')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'nbill',col_precision = '' where tablename = 'expenselastview' AND field = 'nbill'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenselastview','N','','4','nbill','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenselastview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'expenselastview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expenselastview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'expenselastview' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenselastview','N','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenselastview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'expenselastview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','expenselastview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'parentidexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'parentidexp',col_precision = '' where tablename = 'expenselastview' AND field = 'parentidexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenselastview','N','','4','parentidexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'expenselastview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenselastview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'expenselastview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expenselastview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'paymentadate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '4',field = 'paymentadate',col_precision = '' where tablename = 'expenselastview' AND field = 'paymentadate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expenselastview','N','','4','paymentadate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'paymentdescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '150',field = 'paymentdescr',col_precision = '' where tablename = 'expenselastview' AND field = 'paymentdescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenselastview','N','','150','paymentdescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenselastview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'expenselastview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','expenselastview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'refexternaldoc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(5)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '5',field = 'refexternaldoc',col_precision = '' where tablename = 'expenselastview' AND field = 'refexternaldoc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(5)','N','expenselastview','N','','5','refexternaldoc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'expenselastview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','expenselastview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'expenselastview' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenselastview','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'servicestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '8',field = 'servicestart',col_precision = '' where tablename = 'expenselastview' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expenselastview','N','','8','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'servicestop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '8',field = 'servicestop',col_precision = '' where tablename = 'expenselastview' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expenselastview','N','','8','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'expenselastview' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expenselastview','N','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'txt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'text',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'text',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '16',field = 'txt',col_precision = '' where tablename = 'expenselastview' AND field = 'txt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','text','','S','System.String','text','N','expenselastview','N','','16','txt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'expenselastview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenselastview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenselastview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'expenselastview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expenselastview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenselastview' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenselastview',denynull = 'N',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'expenselastview' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expenselastview','N','','2','ypay','')
GO

-- VERIFICA DI expenselastview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'expenselastview')
UPDATE customobject set isreal = 'N' where objectname = 'expenselastview'
ELSE
INSERT INTO customobject (objectname, isreal) values('expenselastview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA expensemandateview
IF EXISTS(select * from sysobjects where id = object_id(N'[expensemandateview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [expensemandateview]
GO


--select * from expensemandateview
CREATE  VIEW expensemandateview 
(
	idmankind,
	yman,
	nman,
	movkind,
	idexp,
	mankind,
	nphase,
	phase,
	ymov,
	nmov,
	--ycreation,
	parentidexp,
	parentymov,
	parentnmov,
	ayear,
	idfin,
	codefin,
	finance,
	idupb,
	codeupb,
	upb,
	idreg,
	registry,
	idman,
	manager,
	kpay,
	ypay,
	npay,
	doc,
	docdate,
	description,
	amount,
	ayearstartamount,
	curramount,
	available,
	totdetail,
	deltavalue, 
	deltapercent, 
	limitvalue,
	limitpercent,
	idpaymethod,
	iban,
	cin,
	idbank,
	idcab,
	cc,
	paymentdescr,
	idser,
	service,
	servicestart,
	servicestop,
	ivaamount,
	flag,
	totflag,
	flagarrear,
	autokind,
	idpayment,
	expiration,
	adate,
	cu,
	ct,
	lu,
	lt
)
	AS SELECT
	expensemandate.idmankind,
	expensemandate.yman,
	expensemandate.nman,
	expensemandate.movkind,
	expensemandate.idexp,
	mandatekind.description,
	expense.nphase,
	expensephase.description,
	expense.ymov,
	expense.nmov,
	expense.parentidexp,
	parentexpense.ymov,
	parentexpense.nmov,
	expenseyear.ayear,
	expenseyear.idfin,
	fin.codefin,
	fin.title,
	expenseyear.idupb,
	upb.codeupb,
	upb.title,
	expense.idreg,
	registry.title,
	expense.idman,
	manager.title,
	payment.kpay,
	payment.ypay,
	payment.npay,
	expense.doc,
	expense.docdate,
	expense.description,
	expenseyear_starting.amount,
	expenseyear.amount,
	expensetotal.curramount,
	expensetotal.available,
	isnull((select sum(taxable_euro)
	from mandatedetailview
	where idexp_taxable = expensemandate.idexp),0) 
	+
	isnull((select sum(iva_euro)
	from mandatedetailview
	where idexp_iva = expensemandate.idexp),0),
	isnull(expensetotal.curramount,0) 
	-
	(isnull((select sum(taxable_euro)
	from mandatedetailview
	where idexp_taxable = expensemandate.idexp),0) 
	+
	isnull((select sum(iva_euro)
	from mandatedetailview
	where idexp_iva = expensemandate.idexp),0)),
	case
	when  
	      (
		isnull(expensetotal.curramount,0) = 0 and 
		(isnull((select sum(taxable_euro)
		from mandatedetailview
		where idexp_taxable = expensemandate.idexp),0) 
		+
		isnull((select sum(iva_euro)
		from mandatedetailview
		where idexp_iva = expensemandate.idexp),0)) = 0
	      )
	then  0
	when   (isnull(expensetotal.curramount,0) <> 0 and 
		(isnull((select sum(taxable_euro)
		from mandatedetailview
		where idexp_taxable = expensemandate.idexp),0) 
		+
		isnull((select sum(iva_euro)
		from mandatedetailview
		where idexp_iva = expensemandate.idexp),0)) = 0
	      )
	then  1000
	when   (isnull(expensetotal.curramount,0) <> 0 and 
		(isnull((select sum(taxable_euro)
		from mandatedetailview
		where idexp_taxable = expensemandate.idexp),0) 
		+
		isnull((select sum(iva_euro)
		from mandatedetailview
		where idexp_iva = expensemandate.idexp),0)) <> 0
	      )
	then
	((isnull(expensetotal.curramount,0) 
	-
	(isnull((select sum(taxable_euro)
		from mandatedetailview
		where idexp_taxable = expensemandate.idexp),0) 
	+
	isnull((select sum(iva_euro)
		from mandatedetailview
		where idexp_iva = expensemandate.idexp),0)))
	/
	(isnull((select sum(taxable_euro)
		from mandatedetailview
		where idexp_taxable = expensemandate.idexp),0) 
	+
	isnull((select sum(iva_euro)
		from mandatedetailview
		where idexp_iva = expensemandate.idexp),0)))
	end,
	mandatekind.deltaamount,
	mandatekind.deltapercentage,
	expenselast.idpaymethod,
	expenselast.iban,
	expenselast.cin,
	expenselast.idbank,
	expenselast.idcab,
	expenselast.cc,
	expenselast.paymentdescr,
	expenselast.idser,
	service.description,
	expenselast.servicestart,
	expenselast.servicestop,
	expenselast.ivaamount,
	expenselast.flag,
	expensetotal.flag,
	CASE
		WHEN ((expensetotal.flag&1)=0) THEN 'C'
		WHEN ((expensetotal.flag&1)=1) THEN 'R'
	END, 
	expense.autokind,
	expense.idpayment,
	expense.expiration,
	expense.adate,
	expensemandate.cu,
	expensemandate.ct,
	expensemandate.lu,
	expensemandate.lt
	FROM expensemandate
	JOIN expense
		ON expense.idexp = expensemandate.idexp
	JOIN expensephase
		ON expensephase.nphase = expense.nphase
	JOIN expenseyear
		ON expenseyear.idexp = expense.idexp
	JOIN expensetotal
		ON expensetotal.idexp = expenseyear.idexp
		AND expensetotal.ayear = expenseyear.ayear
	JOIN mandatekind
		ON mandatekind.idmankind = expensemandate.idmankind
	LEFT OUTER JOIN expense parentexpense
		ON expense.parentidexp = parentexpense.idexp
	LEFT OUTER JOIN expensetotal expensetotal_firstyear
		ON expensetotal_firstyear.idexp = expense.idexp
		AND ((expensetotal_firstyear.flag & 2) <> 0 )
	LEFT OUTER JOIN expenseyear expenseyear_starting
		ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
		AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
	LEFT OUTER JOIN expenselast
		ON expenselast.idexp = expense.idexp
	LEFT OUTER JOIN service
		ON service.idser = expenselast.idser
	LEFT OUTER JOIN fin
		ON fin.idfin = expenseyear.idfin
	LEFT OUTER JOIN upb
		ON upb.idupb = expenseyear.idupb
	LEFT OUTER JOIN registry
		ON registry.idreg = expense.idreg
	LEFT OUTER JOIN manager
		ON manager.idman = expense.idman
	LEFT OUTER JOIN payment
		ON payment.kpay = expenselast.kpay

GO

-- VERIFICA DI expensemandateview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'expensemandateview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expensemandateview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'expensemandateview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','expensemandateview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'expensemandateview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensemandateview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'expensemandateview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expensemandateview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'expensemandateview' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensemandateview','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensemandateview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'expensemandateview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expensemandateview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'ayearstartamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '9',field = 'ayearstartamount',col_precision = '19' where tablename = 'expensemandateview' AND field = 'ayearstartamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensemandateview','N','','9','ayearstartamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'cc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(30)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '30',field = 'cc',col_precision = '' where tablename = 'expensemandateview' AND field = 'cc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(30)','N','expensemandateview','N','','30','cc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'cin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(2)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '2',field = 'cin',col_precision = '' where tablename = 'expensemandateview' AND field = 'cin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(2)','N','expensemandateview','N','','2','cin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'expensemandateview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expensemandateview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'expensemandateview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expensemandateview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensemandateview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'expensemandateview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expensemandateview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expensemandateview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'expensemandateview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expensemandateview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'expensemandateview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensemandateview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'deltapercent')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,6)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '17',field = 'deltapercent',col_precision = '38' where tablename = 'expensemandateview' AND field = 'deltapercent'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(38,6)','N','expensemandateview','N','','17','deltapercent','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'deltavalue')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,6)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '17',field = 'deltavalue',col_precision = '38' where tablename = 'expensemandateview' AND field = 'deltavalue'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(38,6)','N','expensemandateview','N','','17','deltavalue','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensemandateview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'expensemandateview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','expensemandateview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'expensemandateview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','expensemandateview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'expensemandateview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expensemandateview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'expensemandateview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expensemandateview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'expensemandateview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expensemandateview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'expensemandateview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expensemandateview','N','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'expensemandateview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','expensemandateview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'iban')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '50',field = 'iban',col_precision = '' where tablename = 'expensemandateview' AND field = 'iban'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expensemandateview','N','','50','iban','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'idbank')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '20',field = 'idbank',col_precision = '' where tablename = 'expensemandateview' AND field = 'idbank'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expensemandateview','N','','20','idbank','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'idcab')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '20',field = 'idcab',col_precision = '' where tablename = 'expensemandateview' AND field = 'idcab'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expensemandateview','N','','20','idcab','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensemandateview',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'expensemandateview' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensemandateview','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'expensemandateview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensemandateview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'expensemandateview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensemandateview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'idmankind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expensemandateview',denynull = 'S',format = '',col_len = '20',field = 'idmankind',col_precision = '' where tablename = 'expensemandateview' AND field = 'idmankind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','expensemandateview','S','','20','idmankind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'expensemandateview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensemandateview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'idpaymethod')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '4',field = 'idpaymethod',col_precision = '' where tablename = 'expensemandateview' AND field = 'idpaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensemandateview','N','','4','idpaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'expensemandateview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensemandateview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'expensemandateview' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensemandateview','N','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'expensemandateview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','expensemandateview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'ivaamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '9',field = 'ivaamount',col_precision = '19' where tablename = 'expensemandateview' AND field = 'ivaamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensemandateview','N','','9','ivaamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'expensemandateview' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensemandateview','N','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'limitpercent')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '9',field = 'limitpercent',col_precision = '19' where tablename = 'expensemandateview' AND field = 'limitpercent'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensemandateview','N','','9','limitpercent','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'limitvalue')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '9',field = 'limitvalue',col_precision = '19' where tablename = 'expensemandateview' AND field = 'limitvalue'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensemandateview','N','','9','limitvalue','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensemandateview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'expensemandateview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expensemandateview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expensemandateview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'expensemandateview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expensemandateview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'expensemandateview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expensemandateview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'mankind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensemandateview',denynull = 'S',format = '',col_len = '150',field = 'mankind',col_precision = '' where tablename = 'expensemandateview' AND field = 'mankind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','expensemandateview','S','','150','mankind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'movkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensemandateview',denynull = 'S',format = '',col_len = '2',field = 'movkind',col_precision = '' where tablename = 'expensemandateview' AND field = 'movkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expensemandateview','S','','2','movkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'nman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensemandateview',denynull = 'S',format = '',col_len = '4',field = 'nman',col_precision = '' where tablename = 'expensemandateview' AND field = 'nman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensemandateview','S','','4','nman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensemandateview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'expensemandateview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensemandateview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'expensemandateview' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensemandateview','N','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expensemandateview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'expensemandateview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','expensemandateview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'parentidexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '4',field = 'parentidexp',col_precision = '' where tablename = 'expensemandateview' AND field = 'parentidexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensemandateview','N','','4','parentidexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'expensemandateview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensemandateview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'expensemandateview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expensemandateview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'paymentdescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '150',field = 'paymentdescr',col_precision = '' where tablename = 'expensemandateview' AND field = 'paymentdescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expensemandateview','N','','150','paymentdescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensemandateview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'expensemandateview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','expensemandateview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'expensemandateview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','expensemandateview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'expensemandateview' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expensemandateview','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'servicestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '8',field = 'servicestart',col_precision = '' where tablename = 'expensemandateview' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expensemandateview','N','','8','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'servicestop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '8',field = 'servicestop',col_precision = '' where tablename = 'expensemandateview' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expensemandateview','N','','8','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'totdetail')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,6)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '17',field = 'totdetail',col_precision = '38' where tablename = 'expensemandateview' AND field = 'totdetail'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(38,6)','N','expensemandateview','N','','17','totdetail','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'expensemandateview' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expensemandateview','N','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'expensemandateview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expensemandateview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'yman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensemandateview',denynull = 'S',format = '',col_len = '2',field = 'yman',col_precision = '' where tablename = 'expensemandateview' AND field = 'yman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expensemandateview','S','','2','yman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensemandateview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'expensemandateview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expensemandateview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensemandateview' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensemandateview',denynull = 'N',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'expensemandateview' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expensemandateview','N','','2','ypay','')
GO

-- VERIFICA DI expensemandateview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'expensemandateview')
UPDATE customobject set isreal = 'N' where objectname = 'expensemandateview'
ELSE
INSERT INTO customobject (objectname, isreal) values('expensemandateview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA expensepayrollview
IF EXISTS(select * from sysobjects where id = object_id(N'[expensepayrollview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [expensepayrollview]
GO



CREATE   VIEW [expensepayrollview]
(
	idpayroll, idexp, fiscalyear, npayroll, 
	nphase, phase, ymov, nmov, 
	parentidexp, parentymov,parentnmov, ayear, idfin, 
	codefin, finance, 
	idupb,	codeupb,upb,
	idreg,registry,
	idman, manager,kpay, ypay,npay, 
	doc, docdate, description, 
	amount,
	ayearstartamount, 
	curramount, available, 
	idpaymethod, iban, cin, 
	idbank, idcab,cc, 
	paymentdescr, idser, 
	service, codeser, servicestart, 
	servicestop, ivaamount, 
	flag,
	autokind,
	idpayment, 
	totflag,
	flagarrear, 
	expiration, adate, cu, 
	ct, lu, lt, 
	idcon
)
AS
SELECT
	expensepayroll.idpayroll, expense.idexp, payroll.fiscalyear, 
	payroll.npayroll, 
	expense.nphase, expensephase.description , expense.ymov, expense.nmov, 
	expense.parentidexp, parentexpense.ymov, parentexpense.nmov,
	expenseyear.ayear, expenseyear.idfin, 
	fin.codefin, fin.title,
	upb.idupb,
	upb.codeupb,
	upb.title,
	expense.idreg, registry.title,
	expense.idman, manager.title , payment.kpay, payment.ypay, payment.npay, 
	expense.doc, expense.docdate, expense.description, 
	expenseyear_starting.amount,
	expenseyear.amount,
	expensetotal.curramount, expensetotal.available, 
	expenselast.idpaymethod, expenselast.iban, expenselast.cin, 
	expenselast.idbank, expenselast.idcab, expenselast.cc, 
	expenselast.paymentdescr, expenselast.idser, 
	service.description, service.codeser, expenselast.servicestart, 
	expenselast.servicestop, expenselast.ivaamount, 
	expenselast.flag,
	expense.autokind, 
	expense.idpayment, 
	expensetotal.flag,
	CASE
		WHEN ((expensetotal.flag&1)=0) THEN 'C'
		WHEN ((expensetotal.flag&1)=1) THEN 'R'
	END, 
	expense.expiration, expense.adate, expensepayroll.cu, 
	expensepayroll.ct, expensepayroll.lu, expensepayroll.lt, 
	payroll.idcon
FROM expensepayroll
JOIN payroll 
	ON payroll.idpayroll = expensepayroll.idpayroll 
JOIN config
	ON config.ayear = payroll.fiscalyear 
JOIN expense
	ON expense.idexp=expensepayroll.idexp 
JOIN expensephase
	ON expensephase.nphase = expense.nphase 
JOIN expenseyear
	ON expenseyear.idexp = expense.idexp 
JOIN expensetotal
	ON expensetotal.idexp = expenseyear.idexp 
	AND expensetotal.ayear = expenseyear.ayear 
LEFT OUTER JOIN expense parentexpense
	ON expense.parentidexp = parentexpense.idexp 
LEFT OUTER JOIN expensetotal expensetotal_firstyear
	ON expensetotal_firstyear.idexp = expense.idexp
	AND ((expensetotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN expenseyear expenseyear_starting
	ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
	AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
LEFT OUTER JOIN expenselast
	ON expenselast.idexp = expense.idexp 
LEFT OUTER JOIN fin
	ON fin.idfin = expenseyear.idfin 
LEFT OUTER JOIN upb
	ON  upb.idupb = expenseyear.idupb 
LEFT OUTER JOIN registry
	ON registry.idreg = expense.idreg 
LEFT OUTER JOIN manager
	ON manager.idman = expense.idman 
LEFT OUTER JOIN service
	ON service.idser = expenselast.idser
LEFT OUTER JOIN payment
	ON payment.kpay = expenselast.kpay





GO

-- VERIFICA DI expensepayrollview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'expensepayrollview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expensepayrollview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'expensepayrollview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','expensepayrollview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'expensepayrollview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensepayrollview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'expensepayrollview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expensepayrollview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'expensepayrollview' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensepayrollview','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensepayrollview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'expensepayrollview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expensepayrollview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'ayearstartamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '9',field = 'ayearstartamount',col_precision = '19' where tablename = 'expensepayrollview' AND field = 'ayearstartamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensepayrollview','N','','9','ayearstartamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'cc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(30)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '30',field = 'cc',col_precision = '' where tablename = 'expensepayrollview' AND field = 'cc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(30)','N','expensepayrollview','N','','30','cc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'cin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(2)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '2',field = 'cin',col_precision = '' where tablename = 'expensepayrollview' AND field = 'cin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(2)','N','expensepayrollview','N','','2','cin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'expensepayrollview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expensepayrollview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'codeser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '20',field = 'codeser',col_precision = '' where tablename = 'expensepayrollview' AND field = 'codeser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expensepayrollview','N','','20','codeser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'expensepayrollview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expensepayrollview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'expensepayrollview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expensepayrollview','N','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'expensepayrollview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(64)','N','expensepayrollview','N','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'expensepayrollview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensepayrollview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'expensepayrollview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','expensepayrollview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'expensepayrollview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','expensepayrollview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'expensepayrollview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expensepayrollview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'expensepayrollview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expensepayrollview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'expensepayrollview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expensepayrollview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'fiscalyear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensepayrollview',denynull = 'S',format = '',col_len = '4',field = 'fiscalyear',col_precision = '' where tablename = 'expensepayrollview' AND field = 'fiscalyear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensepayrollview','S','','4','fiscalyear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'expensepayrollview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expensepayrollview','N','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'expensepayrollview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','expensepayrollview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'iban')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '50',field = 'iban',col_precision = '' where tablename = 'expensepayrollview' AND field = 'iban'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expensepayrollview','N','','50','iban','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'idbank')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '20',field = 'idbank',col_precision = '' where tablename = 'expensepayrollview' AND field = 'idbank'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expensepayrollview','N','','20','idbank','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'idcab')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '20',field = 'idcab',col_precision = '' where tablename = 'expensepayrollview' AND field = 'idcab'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expensepayrollview','N','','20','idcab','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'idcon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(8)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'S',format = '',col_len = '8',field = 'idcon',col_precision = '' where tablename = 'expensepayrollview' AND field = 'idcon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(8)','N','expensepayrollview','S','','8','idcon','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensepayrollview',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'expensepayrollview' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensepayrollview','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'expensepayrollview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensepayrollview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'expensepayrollview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensepayrollview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'expensepayrollview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensepayrollview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'idpaymethod')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '4',field = 'idpaymethod',col_precision = '' where tablename = 'expensepayrollview' AND field = 'idpaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensepayrollview','N','','4','idpaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'idpayroll')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensepayrollview',denynull = 'S',format = '',col_len = '4',field = 'idpayroll',col_precision = '' where tablename = 'expensepayrollview' AND field = 'idpayroll'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensepayrollview','S','','4','idpayroll','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'expensepayrollview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensepayrollview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'expensepayrollview' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensepayrollview','N','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'expensepayrollview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','expensepayrollview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'ivaamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '9',field = 'ivaamount',col_precision = '19' where tablename = 'expensepayrollview' AND field = 'ivaamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensepayrollview','N','','9','ivaamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'expensepayrollview' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensepayrollview','N','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'expensepayrollview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expensepayrollview','N','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'expensepayrollview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(64)','N','expensepayrollview','N','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'expensepayrollview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expensepayrollview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensepayrollview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'expensepayrollview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensepayrollview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'expensepayrollview' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensepayrollview','N','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'npayroll')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensepayrollview',denynull = 'S',format = '',col_len = '4',field = 'npayroll',col_precision = '' where tablename = 'expensepayrollview' AND field = 'npayroll'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensepayrollview','S','','4','npayroll','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expensepayrollview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'expensepayrollview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','expensepayrollview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'parentidexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '4',field = 'parentidexp',col_precision = '' where tablename = 'expensepayrollview' AND field = 'parentidexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensepayrollview','N','','4','parentidexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'expensepayrollview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensepayrollview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'expensepayrollview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expensepayrollview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'paymentdescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '150',field = 'paymentdescr',col_precision = '' where tablename = 'expensepayrollview' AND field = 'paymentdescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expensepayrollview','N','','150','paymentdescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'expensepayrollview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','expensepayrollview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'expensepayrollview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','expensepayrollview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'expensepayrollview' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expensepayrollview','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'servicestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '8',field = 'servicestart',col_precision = '' where tablename = 'expensepayrollview' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expensepayrollview','N','','8','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'servicestop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '8',field = 'servicestop',col_precision = '' where tablename = 'expensepayrollview' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expensepayrollview','N','','8','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'expensepayrollview' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expensepayrollview','N','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'expensepayrollview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expensepayrollview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensepayrollview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'expensepayrollview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expensepayrollview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensepayrollview' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensepayrollview',denynull = 'N',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'expensepayrollview' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expensepayrollview','N','','2','ypay','')
GO

-- VERIFICA DI expensepayrollview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'expensepayrollview')
UPDATE customobject set isreal = 'N' where objectname = 'expensepayrollview'
ELSE
INSERT INTO customobject (objectname, isreal) values('expensepayrollview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA expenseprofserviceview
IF EXISTS(select * from sysobjects where id = object_id(N'[expenseprofserviceview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [expenseprofserviceview]
GO


CREATE   VIEW [expenseprofserviceview]
(
	ycon,
	ncon,
	movkind,
	idexp,
	nphase,
	phase,
	ymov,
	nmov,
	parentidexp,
	parentymov,
	parentnmov,
	ayear,
	idfin,
	codefin,
	finance,
	idupb,	
	codeupb,
	upb,
	idreg,
	registry,
	idman,
	manager,
	kpay,
	ypay,
	npay,
	doc,
	docdate,
	description,
	amount,
	ayearstartamount,
	curramount,
	available,
	idpaymethod,
	iban,
	cin,
	idbank,
	idcab,
	cc,
	paymentdescr,
	idser,
	service,
	codeser,
	servicestart,
	servicestop,
	ivaamount,
	flag,
	autokind,
	idpayment,
	totflag,
	flagarrear,
	expiration,
	adate,
	cu,
	ct,
	lu,
	lt
)
AS SELECT
	expenseprofservice.ycon,
	expenseprofservice.ncon,
	expenseprofservice.movkind,
	expense.idexp,
	expense.nphase,
	expensephase.description,
	expense.ymov,
	expense.nmov,
	expense.parentidexp,
	parentexpense.ymov,
	parentexpense.nmov,
	expenseyear.ayear,
	expenseyear.idfin,
	fin.codefin,
	fin.title,
	upb.idupb,	
	upb.codeupb,	
	upb.title,	
	expense.idreg,
	registry.title,
	expense.idman,
	manager.title,
	payment.kpay,
	payment.ypay,
	payment.npay,
	expense.doc,
	expense.docdate,
	expense.description,	
	expenseyear_starting.amount, 
	expenseyear.amount,
	expensetotal.curramount,
	expensetotal.available,
	expenselast.idpaymethod,
	expenselast.iban,
	expenselast.cin,
	expenselast.idbank,
	expenselast.idcab,
	expenselast.cc,
	expenselast.paymentdescr,
	expenselast.idser,
	service.description,
	service.codeser,
	expenselast.servicestart,
	expenselast.servicestop,
	expenselast.ivaamount,
	expenselast.flag,
	expense.autokind,
	expense.idpayment,
	expensetotal.flag,
	CASE
		WHEN ((expensetotal.flag&1)=0) THEN 'C'
		WHEN ((expensetotal.flag&1)=1) THEN 'R'
	END, 
	expense.expiration,
	expense.adate,
	expenseprofservice.cu,
	expenseprofservice.ct,
	expenseprofservice.lu,
	expenseprofservice.lt
FROM expenseprofservice
JOIN profservice
	ON expenseprofservice.ycon = profservice.ycon
	AND expenseprofservice.ncon = profservice.ncon
JOIN config
	ON config.ayear=expenseprofservice.ycon 
JOIN expense
	ON expense.idexp = expenseprofservice.idexp
JOIN expensephase
	ON expensephase.nphase = expense.nphase
JOIN expenseyear
	ON expenseyear.idexp = expense.idexp
JOIN expensetotal
	ON expensetotal.idexp = expenseyear.idexp
	AND expensetotal.ayear = expenseyear.ayear
LEFT OUTER JOIN expensetotal expensetotal_firstyear
	ON expensetotal_firstyear.idexp = expense.idexp
	AND ((expensetotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN expenseyear expenseyear_starting
	ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
	AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
LEFT OUTER JOIN expense parentexpense
	ON expense.parentidexp = parentexpense.idexp
LEFT OUTER JOIN expenselast
	ON expenselast.idexp = expense.idexp
LEFT OUTER JOIN fin
	ON fin.idfin = expenseyear.idfin
LEFT OUTER JOIN upb
	on upb.idupb = expenseyear.idupb
LEFT OUTER JOIN registry
	ON registry.idreg = expense.idreg
LEFT OUTER JOIN manager
	ON manager.idman = expense.idman
LEFT OUTER JOIN service
	ON service.idser = expenselast.idser
LEFT OUTER JOIN payment
	ON payment.kpay = expenselast.kpay


GO

-- VERIFICA DI expenseprofserviceview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'expenseprofserviceview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','expenseprofserviceview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'expenseprofserviceview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseprofserviceview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expenseprofserviceview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'expenseprofserviceview' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseprofserviceview','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expenseprofserviceview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'ayearstartamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '9',field = 'ayearstartamount',col_precision = '19' where tablename = 'expenseprofserviceview' AND field = 'ayearstartamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseprofserviceview','N','','9','ayearstartamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'cc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(30)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '30',field = 'cc',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'cc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(30)','N','expenseprofserviceview','N','','30','cc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'cin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(2)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '2',field = 'cin',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'cin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(2)','N','expenseprofserviceview','N','','2','cin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenseprofserviceview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'codeser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '20',field = 'codeser',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'codeser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expenseprofserviceview','N','','20','codeser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenseprofserviceview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expenseprofserviceview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expenseprofserviceview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'expenseprofserviceview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseprofserviceview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','expenseprofserviceview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','expenseprofserviceview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expenseprofserviceview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expenseprofserviceview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenseprofserviceview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expenseprofserviceview','N','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','expenseprofserviceview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'iban')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '50',field = 'iban',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'iban'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenseprofserviceview','N','','50','iban','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'idbank')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '20',field = 'idbank',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'idbank'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expenseprofserviceview','N','','20','idbank','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'idcab')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '20',field = 'idcab',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'idcab'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expenseprofserviceview','N','','20','idcab','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expenseprofserviceview','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseprofserviceview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseprofserviceview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseprofserviceview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'idpaymethod')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '4',field = 'idpaymethod',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'idpaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseprofserviceview','N','','4','idpaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseprofserviceview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseprofserviceview','N','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','expenseprofserviceview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'ivaamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '9',field = 'ivaamount',col_precision = '19' where tablename = 'expenseprofserviceview' AND field = 'ivaamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseprofserviceview','N','','9','ivaamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseprofserviceview','N','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expenseprofserviceview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expenseprofserviceview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenseprofserviceview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'movkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'S',format = '',col_len = '2',field = 'movkind',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'movkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expenseprofserviceview','S','','2','movkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'ncon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'S',format = '',col_len = '4',field = 'ncon',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'ncon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expenseprofserviceview','S','','4','ncon','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expenseprofserviceview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseprofserviceview','N','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','expenseprofserviceview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'parentidexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '4',field = 'parentidexp',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'parentidexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseprofserviceview','N','','4','parentidexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseprofserviceview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expenseprofserviceview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'paymentdescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '150',field = 'paymentdescr',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'paymentdescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenseprofserviceview','N','','150','paymentdescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','expenseprofserviceview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','expenseprofserviceview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenseprofserviceview','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'servicestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '8',field = 'servicestart',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expenseprofserviceview','N','','8','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'servicestop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '8',field = 'servicestop',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expenseprofserviceview','N','','8','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expenseprofserviceview','N','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenseprofserviceview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'ycon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'S',format = '',col_len = '4',field = 'ycon',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'ycon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expenseprofserviceview','S','','4','ycon','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expenseprofserviceview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseprofserviceview' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseprofserviceview',denynull = 'N',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'expenseprofserviceview' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expenseprofserviceview','N','','2','ypay','')
GO

-- VERIFICA DI expenseprofserviceview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'expenseprofserviceview')
UPDATE customobject set isreal = 'N' where objectname = 'expenseprofserviceview'
ELSE
INSERT INTO customobject (objectname, isreal) values('expenseprofserviceview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA expensetaxview
IF EXISTS(select * from sysobjects where id = object_id(N'[expensetaxview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [expensetaxview]
GO



CREATE       VIEW [expensetaxview]
(
	idexp,
	taxcode,
	nbracket,
	description,
	taxkind,
	taxablegross,
	taxablenet,
	taxableoriginal,
	taxref,
	exemptionquota,
	abatements,
	taxablenumerator,
	taxabledenominator,
	employrate,
	employnumerator,
	employdenominator,
	employtax,
	adminrate,
	adminnumerator,
	admindenominator,
	admintax,
	competencydate,
	datetaxpay,
	ytaxpay,
	ntaxpay,
	idaccmotive_debit,
	idaccmotive_pay,
	cu,
	ct,
	lu,
	lt
)
AS SELECT
	expensetax.idexp,
	expensetax.taxcode,
	expensetax.nbracket,
	tax.description,
	tax.taxkind,
	expensetax.taxablegross,
	expensetax.taxablenet,
	expensetax.taxablegross,-- A cosa serve questo campo???
	tax.taxref,
	expensetax.exemptionquota,
	expensetax.abatements,
	expensetax.taxablenumerator,
	expensetax.taxabledenominator,
	expensetax.employrate,
	expensetax.employnumerator,
	expensetax.employdenominator,
	expensetax.employtax,
	expensetax.adminrate,
	expensetax.adminnumerator,
	expensetax.admindenominator,
	expensetax.admintax,
	expensetax.competencydate,
	CASE config.taxvaliditykind 
		-- data ultima fase di spesa
		WHEN '2' THEN expense.adate 
		WHEN '3' THEN payment.adate 
		WHEN '4' THEN payment.printdate
		WHEN '5' THEN  paymenttransmission.transmissiondate
		WHEN '6' THEN (SELECT MIN(banktransaction.transactiondate)
			FROM banktransaction 
			WHERE banktransaction.kpay=expenselast.kpay)
		ELSE expensetax.competencydate
	END,
	expensetax.ytaxpay,
	expensetax.ntaxpay,
	tax.idaccmotive_debit,
	tax.idaccmotive_pay,
	expensetax.cu,
	expensetax.ct,
	expensetax.lu,
	expensetax.lt
	FROM expensetax (NOLOCK)
	JOIN tax (NOLOCK)
	ON tax.taxcode = expensetax.taxcode
	JOIN expense (NOLOCK)
	ON expensetax.idexp = expense.idexp
	JOIN expenselast(NOLOCK) ON expense.idexp = expenselast.idexp 
	JOIN config (NOLOCK) ON expense.ymov = config.ayear
	LEFT OUTER JOIN payment(NOLOCK) ON payment.kpay = expenselast.kpay  
	LEFT OUTER JOIN paymenttransmission(NOLOCK) ON paymenttransmission.kpaymenttransmission =  payment.kpaymenttransmission 














GO

-- VERIFICA DI expensetaxview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'expensetaxview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'abatements')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '9',field = 'abatements',col_precision = '19' where tablename = 'expensetaxview' AND field = 'abatements'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensetaxview','N','','9','abatements','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'admindenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '9',field = 'admindenominator',col_precision = '19' where tablename = 'expensetaxview' AND field = 'admindenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','expensetaxview','N','','9','admindenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'adminnumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '9',field = 'adminnumerator',col_precision = '19' where tablename = 'expensetaxview' AND field = 'adminnumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','expensetaxview','N','','9','adminnumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'adminrate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '9',field = 'adminrate',col_precision = '19' where tablename = 'expensetaxview' AND field = 'adminrate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','expensetaxview','N','','9','adminrate','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'admintax')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '9',field = 'admintax',col_precision = '19' where tablename = 'expensetaxview' AND field = 'admintax'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensetaxview','N','','9','admintax','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'competencydate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '4',field = 'competencydate',col_precision = '' where tablename = 'expensetaxview' AND field = 'competencydate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expensetaxview','N','','4','competencydate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensetaxview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'expensetaxview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expensetaxview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expensetaxview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'expensetaxview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expensetaxview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'datetaxpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '4',field = 'datetaxpay',col_precision = '' where tablename = 'expensetaxview' AND field = 'datetaxpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expensetaxview','N','','4','datetaxpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensetaxview',denynull = 'S',format = '',col_len = '50',field = 'description',col_precision = '' where tablename = 'expensetaxview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','expensetaxview','S','','50','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'employdenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '9',field = 'employdenominator',col_precision = '19' where tablename = 'expensetaxview' AND field = 'employdenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','expensetaxview','N','','9','employdenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'employnumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '9',field = 'employnumerator',col_precision = '19' where tablename = 'expensetaxview' AND field = 'employnumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','expensetaxview','N','','9','employnumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'employrate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '9',field = 'employrate',col_precision = '19' where tablename = 'expensetaxview' AND field = 'employrate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','expensetaxview','N','','9','employrate','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'employtax')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '9',field = 'employtax',col_precision = '19' where tablename = 'expensetaxview' AND field = 'employtax'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensetaxview','N','','9','employtax','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'exemptionquota')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '9',field = 'exemptionquota',col_precision = '19' where tablename = 'expensetaxview' AND field = 'exemptionquota'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensetaxview','N','','9','exemptionquota','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'idaccmotive_debit')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '36',field = 'idaccmotive_debit',col_precision = '' where tablename = 'expensetaxview' AND field = 'idaccmotive_debit'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','expensetaxview','N','','36','idaccmotive_debit','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'idaccmotive_pay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '36',field = 'idaccmotive_pay',col_precision = '' where tablename = 'expensetaxview' AND field = 'idaccmotive_pay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','expensetaxview','N','','36','idaccmotive_pay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensetaxview',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'expensetaxview' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensetaxview','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensetaxview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'expensetaxview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expensetaxview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expensetaxview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'expensetaxview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expensetaxview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'nbracket')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensetaxview',denynull = 'S',format = '',col_len = '4',field = 'nbracket',col_precision = '' where tablename = 'expensetaxview' AND field = 'nbracket'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensetaxview','S','','4','nbracket','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'ntaxpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '4',field = 'ntaxpay',col_precision = '' where tablename = 'expensetaxview' AND field = 'ntaxpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensetaxview','N','','4','ntaxpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'taxabledenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '9',field = 'taxabledenominator',col_precision = '19' where tablename = 'expensetaxview' AND field = 'taxabledenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','expensetaxview','N','','9','taxabledenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'taxablegross')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '9',field = 'taxablegross',col_precision = '19' where tablename = 'expensetaxview' AND field = 'taxablegross'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensetaxview','N','','9','taxablegross','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'taxablenet')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '9',field = 'taxablenet',col_precision = '19' where tablename = 'expensetaxview' AND field = 'taxablenet'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensetaxview','N','','9','taxablenet','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'taxablenumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '9',field = 'taxablenumerator',col_precision = '19' where tablename = 'expensetaxview' AND field = 'taxablenumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','expensetaxview','N','','9','taxablenumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'taxableoriginal')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '9',field = 'taxableoriginal',col_precision = '19' where tablename = 'expensetaxview' AND field = 'taxableoriginal'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensetaxview','N','','9','taxableoriginal','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'taxcode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensetaxview',denynull = 'S',format = '',col_len = '4',field = 'taxcode',col_precision = '' where tablename = 'expensetaxview' AND field = 'taxcode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensetaxview','S','','4','taxcode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'taxkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensetaxview',denynull = 'S',format = '',col_len = '2',field = 'taxkind',col_precision = '' where tablename = 'expensetaxview' AND field = 'taxkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expensetaxview','S','','2','taxkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'taxref')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expensetaxview',denynull = 'S',format = '',col_len = '20',field = 'taxref',col_precision = '' where tablename = 'expensetaxview' AND field = 'taxref'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','expensetaxview','S','','20','taxref','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensetaxview' AND field = 'ytaxpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensetaxview',denynull = 'N',format = '',col_len = '2',field = 'ytaxpay',col_precision = '' where tablename = 'expensetaxview' AND field = 'ytaxpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expensetaxview','N','','2','ytaxpay','')
GO

-- VERIFICA DI expensetaxview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'expensetaxview')
UPDATE customobject set isreal = 'N' where objectname = 'expensetaxview'
ELSE
INSERT INTO customobject (objectname, isreal) values('expensetaxview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA expensevarview
IF EXISTS(select * from sysobjects where id = object_id(N'[expensevarview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [expensevarview]
GO




CREATE  VIEW [expensevarview]
(
	idexp,
	nvar,
	yvar,
	nphase,
	phase,
	ymov,
	nmov,
	description,
	amount,
	doc,
	docdate,
	autokind,
	idpayment,
	adate,
	transferkind,
	cu,
	ct,
	lu,
	lt,
	codefin,
	finance,
	idinvkind,
	codeinvkind,
	invoicekind,
	yinv,
	ninv,
	movkind
)
AS SELECT
	expensevar.idexp,
	expensevar.nvar,
	expensevar.yvar,
	expense.nphase,
	expensephase.description,
	expense.ymov,
	expense.nmov,
	expensevar.description,
	expensevar.amount,
	expensevar.doc,
	expensevar.docdate,
	expensevar.autokind,
	expensevar.idpayment,
	expensevar.adate,
	expensevar.transferkind,
	expensevar.cu,
	expensevar.ct,
	expensevar.lu,
	expensevar.lt,
	fin.codefin,
	fin.title,
	expensevar.idinvkind,
	invoicekind.codeinvkind,
	invoicekind.description,
	expensevar.yinv,
	expensevar.ninv,
	expensevar.movkind
FROM expensevar (NOLOCK)
JOIN expense (NOLOCK)
	ON expense.idexp = expensevar.idexp
JOIN expensephase (NOLOCK)
	ON expensephase.nphase = expense.nphase
JOIN expenseyear (NOLOCK)
	ON expenseyear.idexp= expense.idexp
     AND expenseyear.ayear= expensevar.yvar
LEFT OUTER JOIN fin (NOLOCK)
	ON fin.idfin= expenseyear.idfin
LEFT OUTER JOIN invoicekind
	ON expensevar.idinvkind = invoicekind.idinvkind
	


GO

-- VERIFICA DI expensevarview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'expensevarview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expensevarview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'expensevarview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','expensevarview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensevarview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'expensevarview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensevarview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expensevarview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'expensevarview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expensevarview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensevarview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'expensevarview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expensevarview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'codeinvkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expensevarview',denynull = 'N',format = '',col_len = '20',field = 'codeinvkind',col_precision = '' where tablename = 'expensevarview' AND field = 'codeinvkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expensevarview','N','','20','codeinvkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensevarview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'expensevarview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expensevarview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expensevarview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'expensevarview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expensevarview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensevarview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'expensevarview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','expensevarview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'expensevarview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'expensevarview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','expensevarview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expensevarview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'expensevarview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expensevarview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensevarview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'expensevarview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expensevarview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensevarview',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'expensevarview' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensevarview','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'idinvkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensevarview',denynull = 'N',format = '',col_len = '4',field = 'idinvkind',col_precision = '' where tablename = 'expensevarview' AND field = 'idinvkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensevarview','N','','4','idinvkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensevarview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'expensevarview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensevarview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'invoicekind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensevarview',denynull = 'N',format = '',col_len = '50',field = 'invoicekind',col_precision = '' where tablename = 'expensevarview' AND field = 'invoicekind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expensevarview','N','','50','invoicekind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensevarview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'expensevarview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expensevarview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expensevarview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'expensevarview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expensevarview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'movkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensevarview',denynull = 'N',format = '',col_len = '2',field = 'movkind',col_precision = '' where tablename = 'expensevarview' AND field = 'movkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expensevarview','N','','2','movkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'ninv')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensevarview',denynull = 'N',format = '',col_len = '4',field = 'ninv',col_precision = '' where tablename = 'expensevarview' AND field = 'ninv'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensevarview','N','','4','ninv','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensevarview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'expensevarview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensevarview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expensevarview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'expensevarview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','expensevarview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'nvar')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensevarview',denynull = 'S',format = '',col_len = '4',field = 'nvar',col_precision = '' where tablename = 'expensevarview' AND field = 'nvar'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensevarview','S','','4','nvar','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensevarview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'expensevarview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','expensevarview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'transferkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'expensevarview',denynull = 'N',format = '',col_len = '1',field = 'transferkind',col_precision = '' where tablename = 'expensevarview' AND field = 'transferkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','expensevarview','N','','1','transferkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'yinv')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensevarview',denynull = 'N',format = '',col_len = '2',field = 'yinv',col_precision = '' where tablename = 'expensevarview' AND field = 'yinv'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expensevarview','N','','2','yinv','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensevarview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'expensevarview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expensevarview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensevarview' AND field = 'yvar')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensevarview',denynull = 'S',format = '',col_len = '2',field = 'yvar',col_precision = '' where tablename = 'expensevarview' AND field = 'yvar'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expensevarview','S','','2','yvar','')
GO

-- VERIFICA DI expensevarview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'expensevarview')
UPDATE customobject set isreal = 'N' where objectname = 'expensevarview'
ELSE
INSERT INTO customobject (objectname, isreal) values('expensevarview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA expenseview
IF EXISTS(select * from sysobjects where id = object_id(N'[expenseview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [expenseview]
GO




CREATE      VIEW expenseview
(
	idexp,
	nphase,
	phase,
	ymov,
	nmov,
	parentidexp,
	parentymov,
	parentnmov,
	idformerexpense,
	ayear,
	idfin,
	codefin,
	finance,
	idupb,
	codeupb,
	upb,
	idreg,
	registry,
	idman,
	manager,
	kpay,
	ypay,
	npay,
	paymentadate,
	doc,
	docdate,
	description,
	amount,
	ayearstartamount,
	curramount,
	available,
	idregistrypaymethod,
	idpaymethod,
	iban,
	cin,
	idbank,
	idcab,
	cc,
	iddeputy,
	deputy,
	refexternaldoc,
	paymentdescr,
	idser,
	service,
	codeser,
	servicestart,
	servicestop,
	ivaamount,
	flag,
	totflag,
	flagarrear,
	autokind,
	idpayment,
	expiration,
	adate,
	autocode,
	idclawback,
	clawback,
	clawbackref,
	nbill,
	idpay,
	txt,
	cu,
	ct,
	lu,
	lt
)
AS SELECT
	expense.idexp,
	expense.nphase,
	expensephase.description,
	expense.ymov,
	expense.nmov,
	expense.parentidexp,
	parentexpense.ymov,
	parentexpense.nmov,
	expense.idformerexpense,
	expenseyear.ayear,
	expenseyear.idfin,
	fin.codefin,
	fin.title,
	upb.idupb,
	upb.codeupb,
	upb.title,
	expense.idreg,
	registry.title,
	expense.idman,
	manager.title,
	payment.kpay,
	payment.ypay,
	payment.npay,
	payment.adate,
	expense.doc,
	expense.docdate,
	expense.description,
	expenseyear_starting.amount,
	expenseyear.amount,
	expensetotal.curramount,
	expensetotal.available,
	expenselast.idregistrypaymethod,
	expenselast.idpaymethod,
	expenselast.iban,
	expenselast.cin,
	expenselast.idbank,
	expenselast.idcab,
	expenselast.cc,
	expenselast.iddeputy,  
	deputy.title,
	expenselast.refexternaldoc,
	expenselast.paymentdescr,
	expenselast.idser,
	service.description,
	service.codeser,
	expenselast.servicestart,
	expenselast.servicestop,
	expenselast.ivaamount,
	expenselast.flag,
	expensetotal.flag,
	CASE
		WHEN ((expensetotal.flag&1)=0) THEN 'C'
		WHEN ((expensetotal.flag&1)=1) THEN 'R'
	END, 
	expense.autokind,
	expense.idpayment,
	expense.expiration,
	expense.adate,
	expense.autocode,
	expense.idclawback,
	clawback.description,
	clawback.clawbackref,
	expenselast.nbill,
	expenselast.idpay,
	expense.txt,
	expense.cu,
	expense.ct,
	expense.lu,
	expense.lt
FROM expense
JOIN expensephase
	ON expensephase.nphase = expense.nphase
JOIN expenseyear
	ON expenseyear.idexp = expense.idexp
JOIN expensetotal
	ON expensetotal.idexp = expense.idexp
	AND expensetotal.ayear = expenseyear.ayear
LEFT OUTER JOIN expense parentexpense
	ON parentexpense.idexp = expense.parentidexp
LEFT OUTER JOIN expenselast 
	ON expenselast.idexp = expense.idexp
LEFT OUTER JOIN fin
	ON fin.idfin = expenseyear.idfin
LEFT OUTER JOIN upb
	on upb.idupb = expenseyear.idupb
LEFT OUTER JOIN registry
	ON registry.idreg = expense.idreg
LEFT OUTER JOIN manager
	ON manager.idman = expense.idman
LEFT OUTER JOIN service
	ON service.idser = expenselast.idser
LEFT OUTER JOIN payment
	ON payment.kpay = expenselast.kpay
LEFT OUTER JOIN registry deputy
	ON deputy.idreg = expenselast.iddeputy
LEFT OUTER JOIN clawback
	ON clawback.idclawback = expense.idclawback
LEFT OUTER JOIN expensetotal expensetotal_firstyear
  	ON expensetotal_firstyear.idexp = expense.idexp
  	AND ((expensetotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN expenseyear expenseyear_starting
	ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
  	AND expenseyear_starting.ayear = expensetotal_firstyear.ayear










GO

-- VERIFICA DI expenseview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'expenseview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expenseview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'expenseview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','expenseview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'expenseview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'autocode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'autocode',col_precision = '' where tablename = 'expenseview' AND field = 'autocode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseview','N','','4','autocode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'expenseview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expenseview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'expenseview' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseview','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'expenseview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expenseview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'ayearstartamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '9',field = 'ayearstartamount',col_precision = '19' where tablename = 'expenseview' AND field = 'ayearstartamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseview','N','','9','ayearstartamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'cc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(30)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '30',field = 'cc',col_precision = '' where tablename = 'expenseview' AND field = 'cc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(30)','N','expenseview','N','','30','cc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'cin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(2)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '2',field = 'cin',col_precision = '' where tablename = 'expenseview' AND field = 'cin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(2)','N','expenseview','N','','2','cin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'clawback')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '50',field = 'clawback',col_precision = '' where tablename = 'expenseview' AND field = 'clawback'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenseview','N','','50','clawback','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'clawbackref')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '20',field = 'clawbackref',col_precision = '' where tablename = 'expenseview' AND field = 'clawbackref'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expenseview','N','','20','clawbackref','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'expenseview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenseview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'codeser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '20',field = 'codeser',col_precision = '' where tablename = 'expenseview' AND field = 'codeser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expenseview','N','','20','codeser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'expenseview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenseview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenseview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'expenseview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expenseview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expenseview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'expenseview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expenseview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'expenseview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'deputy')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '100',field = 'deputy',col_precision = '' where tablename = 'expenseview' AND field = 'deputy'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','expenseview','N','','100','deputy','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'expenseview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','expenseview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'expenseview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','expenseview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'expenseview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expenseview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'expenseview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expenseview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'expenseview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenseview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'expenseview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expenseview','N','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'expenseview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','expenseview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'iban')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '50',field = 'iban',col_precision = '' where tablename = 'expenseview' AND field = 'iban'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenseview','N','','50','iban','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'idbank')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '20',field = 'idbank',col_precision = '' where tablename = 'expenseview' AND field = 'idbank'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expenseview','N','','20','idbank','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'idcab')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '20',field = 'idcab',col_precision = '' where tablename = 'expenseview' AND field = 'idcab'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expenseview','N','','20','idcab','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'idclawback')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'idclawback',col_precision = '' where tablename = 'expenseview' AND field = 'idclawback'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseview','N','','4','idclawback','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'iddeputy')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'iddeputy',col_precision = '' where tablename = 'expenseview' AND field = 'iddeputy'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseview','N','','4','iddeputy','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseview',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'expenseview' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expenseview','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'expenseview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'idformerexpense')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'idformerexpense',col_precision = '' where tablename = 'expenseview' AND field = 'idformerexpense'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseview','N','','4','idformerexpense','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'expenseview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'idpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'idpay',col_precision = '' where tablename = 'expenseview' AND field = 'idpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseview','N','','4','idpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'expenseview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'idpaymethod')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'idpaymethod',col_precision = '' where tablename = 'expenseview' AND field = 'idpaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseview','N','','4','idpaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'expenseview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'idregistrypaymethod')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'idregistrypaymethod',col_precision = '' where tablename = 'expenseview' AND field = 'idregistrypaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseview','N','','4','idregistrypaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'expenseview' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseview','N','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'expenseview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','expenseview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'ivaamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '9',field = 'ivaamount',col_precision = '19' where tablename = 'expenseview' AND field = 'ivaamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expenseview','N','','9','ivaamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'expenseview' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseview','N','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenseview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'expenseview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expenseview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expenseview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'expenseview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expenseview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'expenseview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenseview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'nbill')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'nbill',col_precision = '' where tablename = 'expenseview' AND field = 'nbill'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseview','N','','4','nbill','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'expenseview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expenseview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'expenseview' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseview','N','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenseview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'expenseview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','expenseview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'parentidexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'parentidexp',col_precision = '' where tablename = 'expenseview' AND field = 'parentidexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseview','N','','4','parentidexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'expenseview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expenseview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'expenseview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expenseview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'paymentadate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '4',field = 'paymentadate',col_precision = '' where tablename = 'expenseview' AND field = 'paymentadate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expenseview','N','','4','paymentadate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'paymentdescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '150',field = 'paymentdescr',col_precision = '' where tablename = 'expenseview' AND field = 'paymentdescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenseview','N','','150','paymentdescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'expenseview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','expenseview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'refexternaldoc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(5)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '5',field = 'refexternaldoc',col_precision = '' where tablename = 'expenseview' AND field = 'refexternaldoc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(5)','N','expenseview','N','','5','refexternaldoc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'expenseview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','expenseview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'expenseview' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expenseview','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'servicestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '8',field = 'servicestart',col_precision = '' where tablename = 'expenseview' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expenseview','N','','8','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'servicestop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '8',field = 'servicestop',col_precision = '' where tablename = 'expenseview' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expenseview','N','','8','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'expenseview' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expenseview','N','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'txt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'text',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'text',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '16',field = 'txt',col_precision = '' where tablename = 'expenseview' AND field = 'txt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','text','','S','System.String','text','N','expenseview','N','','16','txt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'expenseview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expenseview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'expenseview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expenseview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expenseview' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expenseview',denynull = 'N',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'expenseview' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expenseview','N','','2','ypay','')
GO

-- VERIFICA DI expenseview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'expenseview')
UPDATE customobject set isreal = 'N' where objectname = 'expenseview'
ELSE
INSERT INTO customobject (objectname, isreal) values('expenseview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA expensewageadditionview
IF EXISTS(select * from sysobjects where id = object_id(N'[expensewageadditionview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [expensewageadditionview]
GO


CREATE   VIEW [expensewageadditionview]
(
	ycon,
	ncon,
	idexp,
	nphase,
	phase,
	ymov,
	nmov,
	parentidexp,
	parentymov,
	parentnmov,
	ayear,
	idfin,
	codefin,
	finance,
	idupb,
	codeupb,
	upb,
	idreg,
	registry,
	idman,
	manager,
	kpay,
	ypay,
	npay,
	doc,
	docdate,
	description,
	amount,
	ayearstartamount,
	curramount,
	available,
	idpaymethod,
	iban,
	cin,
	idbank,
	idcab,
	cc,
	paymentdescr,
	idser,
	service,
	codeser,
	servicestart,
	servicestop,
	ivaamount,
	flag,
	idpayment,
	totflag, 
	flagarrear,
	expiration,
	adate,
	cu,
	ct,
	lu,
	lt
)
AS SELECT
	expensewageaddition.ycon,
	expensewageaddition.ncon,
	expense.idexp,
	expense.nphase,
	expensephase.description,
	expense.ymov,
	expense.nmov,
	expense.parentidexp,
	parentexpense.ymov,
	parentexpense.nmov,
	expenseyear.ayear,
	expenseyear.idfin,
	fin.codefin,
	fin.title,
	upb.idupb,	
	upb.codeupb,	
	upb.title,	
	expense.idreg,
	registry.title,
	expense.idman,
	manager.title,
	payment.kpay,
	payment.ypay,
	payment.npay,
	expense.doc,
	expense.docdate,
	expense.description,
	expenseyear_starting.amount,
	expenseyear.amount,
	expensetotal.curramount,
	expensetotal.available,
	expenselast.idpaymethod,
	expenselast.iban,
	expenselast.cin,
	expenselast.idbank,
	expenselast.idcab,
	expenselast.cc,
	expenselast.paymentdescr,
	expenselast.idser,
	service.description,
	service.codeser,
	expenselast.servicestart,
	expenselast.servicestop,
	expenselast.ivaamount,
	expenselast.flag,
	expense.idpayment,
	expensetotal.flag,
	CASE
		WHEN ((expensetotal.flag&1)=0) THEN 'C'
		WHEN ((expensetotal.flag&1)=1) THEN 'R'
	END, 
	expense.expiration,
	expense.adate,
	expensewageaddition.cu,
	expensewageaddition.ct,
	expensewageaddition.lu,
	expensewageaddition.lt
FROM expensewageaddition
JOIN wageaddition
	ON expensewageaddition.ycon = wageaddition.ycon
	AND expensewageaddition.ncon = wageaddition.ncon
JOIN config
	ON config.ayear=expensewageaddition.ycon 
JOIN expense
	ON expense.idexp = expensewageaddition.idexp
JOIN expensephase
	ON expensephase.nphase = expense.nphase
JOIN expenseyear
	ON expenseyear.idexp = expense.idexp
JOIN expensetotal
	ON expensetotal.idexp = expenseyear.idexp
	AND expensetotal.ayear = expenseyear.ayear
LEFT OUTER JOIN expense parentexpense
	ON parentexpense.idexp = expense.parentidexp
LEFT OUTER JOIN expensetotal expensetotal_firstyear
	ON expensetotal_firstyear.idexp = expense.idexp
	AND ((expensetotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN expenseyear expenseyear_starting
	ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
	AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
LEFT OUTER JOIN expenselast
	ON expenselast.idexp = expense.idexp
LEFT OUTER JOIN payment
	ON payment.kpay = payment.kpay
LEFT OUTER JOIN fin
	ON fin.idfin = expenseyear.idfin
LEFT OUTER JOIN upb
	ON upb.idupb = expenseyear.idupb
LEFT OUTER JOIN registry
	ON registry.idreg = expense.idreg
LEFT OUTER JOIN manager
	ON manager.idman = expense.idman
LEFT OUTER JOIN service
	ON service.idser = expenselast.idser





GO

-- VERIFICA DI expensewageadditionview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'expensewageadditionview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','expensewageadditionview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'expensewageadditionview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensewageadditionview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'expensewageadditionview' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensewageadditionview','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expensewageadditionview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'ayearstartamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '9',field = 'ayearstartamount',col_precision = '19' where tablename = 'expensewageadditionview' AND field = 'ayearstartamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensewageadditionview','N','','9','ayearstartamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'cc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(30)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '30',field = 'cc',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'cc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(30)','N','expensewageadditionview','N','','30','cc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'cin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(2)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '2',field = 'cin',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'cin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(2)','N','expensewageadditionview','N','','2','cin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expensewageadditionview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'codeser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '20',field = 'codeser',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'codeser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expensewageadditionview','N','','20','codeser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expensewageadditionview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expensewageadditionview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expensewageadditionview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'expensewageadditionview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensewageadditionview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','expensewageadditionview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','expensewageadditionview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expensewageadditionview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','expensewageadditionview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expensewageadditionview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expensewageadditionview','N','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','expensewageadditionview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'iban')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '50',field = 'iban',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'iban'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expensewageadditionview','N','','50','iban','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'idbank')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '20',field = 'idbank',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'idbank'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expensewageadditionview','N','','20','idbank','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'idcab')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '20',field = 'idcab',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'idcab'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','expensewageadditionview','N','','20','idcab','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensewageadditionview','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensewageadditionview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensewageadditionview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensewageadditionview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'idpaymethod')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '4',field = 'idpaymethod',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'idpaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensewageadditionview','N','','4','idpaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensewageadditionview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensewageadditionview','N','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','expensewageadditionview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'ivaamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '9',field = 'ivaamount',col_precision = '19' where tablename = 'expensewageadditionview' AND field = 'ivaamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','expensewageadditionview','N','','9','ivaamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensewageadditionview','N','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','expensewageadditionview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','expensewageadditionview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expensewageadditionview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'ncon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'S',format = '',col_len = '4',field = 'ncon',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'ncon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensewageadditionview','S','','4','ncon','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensewageadditionview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensewageadditionview','N','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','expensewageadditionview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'parentidexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '4',field = 'parentidexp',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'parentidexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensewageadditionview','N','','4','parentidexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','expensewageadditionview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expensewageadditionview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'paymentdescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '150',field = 'paymentdescr',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'paymentdescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expensewageadditionview','N','','150','paymentdescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','expensewageadditionview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','expensewageadditionview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','expensewageadditionview','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'servicestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '8',field = 'servicestart',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expensewageadditionview','N','','8','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'servicestop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '8',field = 'servicestop',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','expensewageadditionview','N','','8','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','expensewageadditionview','N','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','expensewageadditionview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'ycon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'S',format = '',col_len = '4',field = 'ycon',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'ycon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','expensewageadditionview','S','','4','ycon','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','expensewageadditionview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'expensewageadditionview' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'expensewageadditionview',denynull = 'N',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'expensewageadditionview' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','expensewageadditionview','N','','2','ypay','')
GO

-- VERIFICA DI expensewageadditionview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'expensewageadditionview')
UPDATE customobject set isreal = 'N' where objectname = 'expensewageadditionview'
ELSE
INSERT INTO customobject (objectname, isreal) values('expensewageadditionview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --


-- CREAZIONE VISTA finsurplusview
IF EXISTS(select * from sysobjects where id = object_id(N'[finsurplusview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [finsurplusview]
GO




CREATE      VIEW [finsurplusview]
(
ayear,
creditsurplus,
floatfund
)
AS 
SELECT --DISTINCT
p.ayear,
-- Algoritmo applicato per campo avanzoamministrazione
-- Controllo Previsione Principale:
-- SE 'C' ALLORA Calcola Avanzo di Amministrazione
-- SE 'S' ALLORA Controlla la Previsione Secondaria:
-- SE 'C' ALLORA Calcola Avanzo di Amministrazione
(SELECT 
	CASE  
	WHEN  (p.fin_kind = 1) THEN 
		ISNULL(
			ISNULL(
				(
				SELECT(SUM(upbtotal.currentprev) + SUM(upbtotal.previsionvariation))
		 		FROM fin b 
				JOIN upbtotal ON b.idfin = upbtotal.idfin
				WHERE  b.ayear = p.ayear AND p.idfinincomesurplus = b.idfin
				),
				(SELECT 
				((ISNULL(s.startfloatfund,0.0) +
		  		ISNULL(s.competencyproceeds,0.0) +
				ISNULL(s.residualproceeds,0.0)-
		  		(ISNULL(s.competencypayments,0.0) + ISNULL(s.residualpayments,0.0))) +
		  		(ISNULL(s.previousrevenue,0.0) + ISNULL(s.currentrevenue,0.0)) -
		  		(ISNULL(s.previousexpenditure,0.0) + ISNULL(s.currentexpenditure,0.0)))
		 		FROM surplus s WHERE s.ayear = (p.ayear-1))
			)
		,0.0)
	WHEN  (p.fin_kind = 2) THEN
	(
		
			ISNULL(
				ISNULL(
					(
					SELECT(SUM(upbtotal.currentprev) + SUM(upbtotal.previsionvariation))
			 		FROM fin b 
			 		JOIN upbtotal ON b.idfin = upbtotal.idfin
					WHERE  b.ayear = p.ayear AND p.idfinincomesurplus = b.idfin
					),
					(SELECT 
						(ISNULL(s.startfloatfund,0.0) +
				  		ISNULL(s.competencyproceeds,0.0) +
						ISNULL(s.residualproceeds,0.0)-
				  		(ISNULL(s.competencypayments,0.0) + ISNULL(s.residualpayments,0.0))
						)
			 		FROM surplus s WHERE s.ayear = (p.ayear-1)
					)
				)
			,0.0)
		)
	END
	)
	,
-- Algoritmo applicato per campo fondocassa
-- Controllo Previsione Principale:
-- SE 'S' ALLORA Calcola Fondo di Cassa
-- SE 'C' ALLORA Controlla la Previsione Secondaria:
-- SE 'S' ALLORA Calcola Fondo di Cassa
(SELECT 
	CASE  
	WHEN (p.fin_kind = 2) THEN
		ISNULL( 
			ISNULL(
				(
				 SELECT(SUM(upbtotal.currentprev) + SUM(upbtotal.previsionvariation))
				 FROM fin b 
				 JOIN upbtotal ON b.idfin = upbtotal.idfin
		 		 WHERE  b.ayear = p.ayear AND p.idfinincomesurplus = b.idfin
				),
				(SELECT 
				 (ISNULL(s.startfloatfund,0.0) +
				  ISNULL(s.competencyproceeds,0.0) +
				  ISNULL(s.residualproceeds,0.0) - 
				  (ISNULL(s.competencypayments,0) + ISNULL(s.residualpayments,0.0)))
				 FROM surplus s WHERE s.ayear = (p.ayear-1))
			)
		,0.0)
	WHEN p.fin_kind IN (1,3) THEN
		(
		CASE p.fin_kind
			WHEN 3 THEN
				ISNULL(
					ISNULL(
						(
						 SELECT(SUM(upbtotal.currentsecondaryprev) + SUM(upbtotal.secondaryvariation))
						 FROM fin b
						 JOIN upbtotal ON b.idfin = upbtotal.idfin
						 WHERE  b.ayear = p.ayear AND p.idfinincomesurplus = b.idfin
						),
						(SELECT 
							(ISNULL(s.startfloatfund,0.0) +
							  ISNULL(s.competencyproceeds,0.0) +
							  ISNULL(s.residualproceeds,0.0) - 
							  (ISNULL(s.competencypayments,0) + ISNULL(s.residualpayments,0.0))
							)
							FROM surplus s WHERE s.ayear = (p.ayear-1)
						)
					)
				,0.0)
			ELSE
				ISNULL(
					ISNULL(
						(SELECT 
				 			(ISNULL(s.startfloatfund,0.0) +
							  ISNULL(s.competencyproceeds,0.0) +
				  			  ISNULL(s.residualproceeds,0.0) - 
				  			  (ISNULL(s.competencypayments,0) + ISNULL(s.residualpayments,0.0))
							)
						 	FROM surplus s WHERE s.ayear = (p.ayear-1)
						)
					,0.0)
				,0.0)
			END
		)
		END 
)
FROM config p


GO

-- VERIFICA DI finsurplusview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'finsurplusview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'finsurplusview' AND field = 'ayear')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'finsurplusview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'finsurplusview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','smallint','','N','System.Int16','smallint','N','finsurplusview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finsurplusview' AND field = 'creditsurplus')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'finsurplusview',denynull = 'N',format = '',col_len = '17',field = 'creditsurplus',col_precision = '38' where tablename = 'finsurplusview' AND field = 'creditsurplus'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(38,2)','N','finsurplusview','N','','17','creditsurplus','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finsurplusview' AND field = 'floatfund')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'finsurplusview',denynull = 'N',format = '',col_len = '17',field = 'floatfund',col_precision = '38' where tablename = 'finsurplusview' AND field = 'floatfund'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(38,2)','N','finsurplusview','N','','17','floatfund','38')
GO

-- VERIFICA DI finsurplusview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'finsurplusview')
UPDATE customobject set isreal = 'N' where objectname = 'finsurplusview'
ELSE
INSERT INTO customobject (objectname, isreal) values('finsurplusview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --



-- CREAZIONE VISTA historypaymentview
IF EXISTS(select * from sysobjects where id = object_id(N'[historypaymentview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [historypaymentview]
GO



CREATE     VIEW [historypaymentview]
(
	idexp,
	ymov,
	nmov,
	adate,
	idreg,
	idman,
	doc,
	docdate,
	description,
	competencydate,
	amount,
	curramount,
	--employtaxamount,
	--admintaxamount,
	--clawbackamount,
	totflag,
	flagarrear,
	kpay,
	ypay,
	npay,
	idfin,idupb
)
AS
SELECT  expense.idexp, 
	config.ayear, 
	expense.nmov, 
	expense.adate,
	expense.idreg, 
	expense.idman, 
	expense.doc, 
	expense.docdate, 
	expense.description, 
	payment.adate, 
	expenseyear.amount, 
	expensetotal.curramount, --expense.employtaxamount, expense.admintaxamount, expense.clawbackamount,
	expensetotal.flag, 
	CASE
		WHEN ((expensetotal.flag&1)=0) THEN 'C'
		WHEN ((expensetotal.flag&1)=1) THEN 'R'
	END, 
	payment.kpay,
	payment.ypay, 
	payment.npay, 
	expenseyear.idfin,
	expenseyear.idupb   
FROM config
JOIN expense
	ON expense.ymov = config.ayear
JOIN expenselast
	ON expense.idexp = expenselast.idexp
JOIN payment
	ON payment.kpay = expenselast.kpay 
JOIN expenseyear 
	ON expense.idexp = expenseyear.idexp
	AND config.ayear = expenseyear.ayear
JOIN expensetotal
	ON expensetotal.idexp = expenseyear.idexp
	AND expensetotal.ayear = config.ayear
WHERE  config.cashvaliditykind = 1  --EMITTED

UNION ALL

SELECT 
	expense.idexp, 
	config.ayear, 
	expense.nmov, 
	expense.adate,
	expense.idreg, 
	expense.idman, 
	expense.doc, 
	expense.docdate, 
	expense.description, 
	payment.printdate, 
	expenseyear.amount, 
	expensetotal.curramount, --expense.employtaxamount, expense.admintaxamount, expense.clawbackamount,
	expensetotal.flag,
	CASE
		WHEN ((expensetotal.flag&1)=0) THEN 'C'
		WHEN ((expensetotal.flag&1)=1) THEN 'R'
	END, 
	--expenseyear.flagarrear, 
	payment.kpay,
	payment.ypay, 
	payment.npay,  
	expenseyear.idfin,
	expenseyear.idupb
FROM  config
JOIN expense
	ON expense.ymov = config.ayear
JOIN expenselast
	ON expense.idexp = expenselast.idexp
JOIN payment
	ON payment.kpay = expenselast.kpay 
JOIN expenseyear
	ON expenseyear.idexp = expense.idexp 
	AND expenseyear.ayear = config.ayear
JOIN expensetotal
	ON expensetotal.idexp = expenseyear.idexp
	AND expensetotal.ayear = config.ayear
WHERE config.cashvaliditykind = 2   --PAYMENT PRINTED

UNION  ALL
SELECT  expense.idexp, 
	config.ayear ,--P.ymov, 
	expense.nmov,
	expense.adate, 
	expense.idreg, 
	expense.idman, 
	expense.doc, 
	expense.docdate, 
	expense.description, 
	paymenttransmission.transmissiondate, 
	expenseyear.amount,
	expensetotal.curramount, --expense.employtaxamount, expense.admintaxamount, expense.clawbackamount,
	expensetotal.flag,
	CASE
		WHEN ((expensetotal.flag&1)=0) THEN 'C'
		WHEN ((expensetotal.flag&1)=1) THEN 'R'
	END, 
	--expenseyear.flagarrear, 
	payment.kpay,
	payment.ypay, 
	payment.npay, 
	expenseyear.idfin,
	expenseyear.idupb
FROM config
JOIN expense
	ON expense.ymov = config.ayear
JOIN expenselast
	ON expense.idexp = expenselast.idexp
JOIN payment
	ON payment.kpay = expenselast.kpay 
JOIN paymenttransmission 
	ON paymenttransmission.kpaymenttransmission = payment.kpaymenttransmission
JOIN expenseyear
	ON expense.idexp = expenseyear.idexp
	AND config.ayear = expenseyear.ayear
JOIN expensetotal
	ON expensetotal.idexp = expenseyear.idexp
	AND expensetotal.ayear = config.ayear

WHERE config.cashvaliditykind = 3 -- PAYMENT COMMUNICATED

UNION ALL
SELECT 
	expense.idexp, 
	config.ayear, 
	expense.nmov, 
	expense.adate,
	expense.idreg, 
	expense.idman, 
	expense.doc, 
	expense.docdate, 
	expense.description, 
	banktransaction.transactiondate, 
	banktransaction.amount, 
	banktransaction.amount, --expense.employtaxamount, expense.admintaxamount, expense.clawbackamount,
	expensetotal.flag,
	CASE
		WHEN ((expensetotal.flag&1)=0) THEN 'C'
		WHEN ((expensetotal.flag&1)=1) THEN 'R'
	END, 
	--expenseyear.flagarrear, 
	payment.kpay,
	payment.ypay, 
	payment.npay, 
	expenseyear.idfin,
	expenseyear.idupb
FROM  config 
JOIN expense
	ON expense.ymov = config.ayear
JOIN expenselast
	ON expense.idexp = expenselast.idexp
JOIN payment
	ON payment.kpay = expenselast.kpay 
JOIN expenseyear
	ON expense.idexp = expenseyear.idexp
	AND config.ayear = expenseyear.ayear
JOIN expensetotal
	ON expensetotal.idexp = expenseyear.idexp
	AND expensetotal.ayear = config.ayear
JOIN banktransaction
	ON banktransaction.idexp = expense.idexp
	AND banktransaction.yban = config.ayear        
WHERE  config.cashvaliditykind = 4  --PERFORMED



GO

-- VERIFICA DI historypaymentview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'historypaymentview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'historypaymentview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'historypaymentview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'historypaymentview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','historypaymentview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historypaymentview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'historypaymentview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'historypaymentview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','historypaymentview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historypaymentview' AND field = 'competencydate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'historypaymentview',denynull = 'N',format = '',col_len = '4',field = 'competencydate',col_precision = '' where tablename = 'historypaymentview' AND field = 'competencydate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','historypaymentview','N','','4','competencydate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historypaymentview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'historypaymentview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'historypaymentview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','historypaymentview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historypaymentview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'historypaymentview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'historypaymentview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','historypaymentview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historypaymentview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'historypaymentview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'historypaymentview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','historypaymentview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historypaymentview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'historypaymentview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'historypaymentview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','historypaymentview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historypaymentview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'historypaymentview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'historypaymentview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','historypaymentview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historypaymentview' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'historypaymentview',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'historypaymentview' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','historypaymentview','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historypaymentview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'historypaymentview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'historypaymentview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','historypaymentview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historypaymentview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'historypaymentview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'historypaymentview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','historypaymentview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historypaymentview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'historypaymentview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'historypaymentview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','historypaymentview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historypaymentview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'historypaymentview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'historypaymentview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','historypaymentview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historypaymentview' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'historypaymentview',denynull = 'S',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'historypaymentview' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','historypaymentview','S','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historypaymentview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'historypaymentview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'historypaymentview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','historypaymentview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historypaymentview' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'historypaymentview',denynull = 'S',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'historypaymentview' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','historypaymentview','S','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historypaymentview' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'historypaymentview',denynull = 'N',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'historypaymentview' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','historypaymentview','N','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historypaymentview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'historypaymentview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'historypaymentview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','historypaymentview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historypaymentview' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'historypaymentview',denynull = 'S',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'historypaymentview' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','historypaymentview','S','','2','ypay','')
GO

-- VERIFICA DI historypaymentview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'historypaymentview')
UPDATE customobject set isreal = 'N' where objectname = 'historypaymentview'
ELSE
INSERT INTO customobject (objectname, isreal) values('historypaymentview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA historyproceedsview
IF EXISTS(select * from sysobjects where id = object_id(N'[historyproceedsview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [historyproceedsview]
GO


CREATE    VIEW historyproceedsview
(
	idinc,
	ymov,
	nmov,
	adate,
	idreg,
	idman,
	doc,
	docdate,
	description,
	competencydate,
	amount,
	curramount,
	totflag,
	flagarrear,
	kpro,
	ypro,
	npro,
	idfin,idupb
)
AS
SELECT 
	income.idinc, 
	config.ayear, 
	income.nmov, 
	income.adate,
	income.idreg, 
	income.idman, 
	income.doc, 
	income.docdate, 
	income.description, 
	proceeds.adate, 
	--income.amount, 
	incomeyear.amount,
	incometotal.curramount, 
	incometotal.flag,
	CASE
		WHEN ((incometotal.flag&1)=0) THEN 'C'
		WHEN ((incometotal.flag&1)=1) THEN 'R'
	END, 
	--incomeyear.flagarrear, 
	proceeds.kpro,
	proceeds.ypro, 
	proceeds.npro, 
	incomeyear.idfin,
	incomeyear.idupb
FROM config	
JOIN income
	ON income.ymov = config.ayear
JOIN incomelast
	ON income.idinc = incomelast.idinc
JOIN proceeds
	ON proceeds.kpro = incomelast.kpro 
JOIN incomeyear
	ON income.idinc = incomeyear.idinc
	AND config.ayear= incomeyear.ayear
JOIN incometotal
	ON incometotal.idinc = incomeyear.idinc
	AND incometotal.ayear = config.ayear
WHERE  config.cashvaliditykind = 1 --emitted

UNION ALL

SELECT 
	income.idinc, 
	config.ayear, 
	income.nmov, 
	income.adate,
	income.idreg,
	income.idman, 
	income.doc, 
	income.docdate, 
	income.description, 
	proceeds.printdate, 
	incomeyear.amount,
	--income.amount, 
	incometotal.curramount, 
	incometotal.flag,
	CASE
		WHEN ((incometotal.flag&1)=0) THEN 'C'
		WHEN ((incometotal.flag&1)=1) THEN 'R'
	END, 
	--incomeyear.flagarrear, 
	proceeds.kpro,
	proceeds.ypro, 
	proceeds.npro, 
	incomeyear.idfin,
	incomeyear.idupb
FROM config	
JOIN income
	ON income.ymov = config.ayear
JOIN incomelast
	ON income.idinc = incomelast.idinc
JOIN proceeds
	ON proceeds.kpro = incomelast.kpro 
JOIN incomeyear
	ON income.idinc = incomeyear.idinc
	AND config.ayear = incomeyear.ayear
JOIN incometotal
	ON incometotal.idinc = incomeyear.idinc
	AND incometotal.ayear = config.ayear
WHERE  config.cashvaliditykind = 2 --printed

UNION ALL


SELECT 
	income.idinc, 
	config.ayear, 
	income.nmov, 
	income.adate,
	income.idreg, 
	income.idman, 
	income.doc, 
	income.docdate, 
	income.description, 
	proceedstransmission.transmissiondate, 
	incomeyear.amount,
	--income.amount, 
	incometotal.curramount, 
	incometotal.flag,
	CASE
		WHEN ((incometotal.flag&1)=0) THEN 'C'
		WHEN ((incometotal.flag&1)=1) THEN 'R'
	END, 
	--incomeyear.flagarrear, 	
	proceeds.kpro,
	proceeds.ypro, 
	proceeds.npro, 
	incomeyear.idfin,
	incomeyear.idupb
FROM config	
JOIN income
	ON income.ymov = config.ayear
JOIN incomelast
	ON income.idinc = incomelast.idinc
JOIN proceeds
	ON proceeds.kpro = incomelast.kpro 
JOIN proceedstransmission 
	ON proceedstransmission.kproceedstransmission = proceeds.kproceedstransmission
JOIN incomeyear
	ON income.idinc = incomeyear.idinc
	AND config.ayear = incomeyear.ayear
JOIN incometotal
	ON incometotal.idinc = incomeyear.idinc
	AND incometotal.ayear = config.ayear

WHERE  config.cashvaliditykind = 3 --comm


UNION ALL
SELECT 
	income.idinc, 
	config.ayear, 
	income.nmov, 
	income.adate,
	income.idreg, 
	income.idman, 
	income.doc, 
	income.docdate, 
	income.description, 
	banktransaction.transactiondate, 
	banktransaction.amount, 
	banktransaction.amount,
	incometotal.flag,
	CASE
		WHEN ((incometotal.flag&1)=0) THEN 'C'
		WHEN ((incometotal.flag&1)=1) THEN 'R'
	END, 
	--incomeyear.flagarrear, 
	proceeds.kpro,
	proceeds.ypro, 
	proceeds.npro, 
	incomeyear.idfin,
	incomeyear.idupb
FROM config
JOIN income
	ON income.ymov = config.ayear 
JOIN incomelast
	ON income.idinc = incomelast.idinc 
JOIN proceeds
	ON proceeds.kpro = incomelast.kpro 
JOIN proceedstransmission 
	ON proceedstransmission.kproceedstransmission = proceeds.kproceedstransmission
JOIN incomeyear
	ON income.idinc = incomeyear.idinc
	AND config.ayear = incomeyear.ayear
JOIN incometotal
	ON incometotal.idinc = incomeyear.idinc
	AND incometotal.ayear = config.ayear
JOIN banktransaction
	ON banktransaction.idinc = income.idinc
WHERE  config.cashvaliditykind = 4 -- bankt

GO

-- VERIFICA DI historyproceedsview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'historyproceedsview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'historyproceedsview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'historyproceedsview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'historyproceedsview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','historyproceedsview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historyproceedsview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'historyproceedsview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'historyproceedsview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','historyproceedsview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historyproceedsview' AND field = 'competencydate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'historyproceedsview',denynull = 'N',format = '',col_len = '4',field = 'competencydate',col_precision = '' where tablename = 'historyproceedsview' AND field = 'competencydate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','historyproceedsview','N','','4','competencydate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historyproceedsview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'historyproceedsview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'historyproceedsview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','historyproceedsview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historyproceedsview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'historyproceedsview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'historyproceedsview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','historyproceedsview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historyproceedsview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'historyproceedsview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'historyproceedsview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','historyproceedsview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historyproceedsview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'historyproceedsview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'historyproceedsview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','historyproceedsview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historyproceedsview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'historyproceedsview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'historyproceedsview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','historyproceedsview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historyproceedsview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'historyproceedsview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'historyproceedsview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','historyproceedsview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historyproceedsview' AND field = 'idinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'historyproceedsview',denynull = 'S',format = '',col_len = '4',field = 'idinc',col_precision = '' where tablename = 'historyproceedsview' AND field = 'idinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','historyproceedsview','S','','4','idinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historyproceedsview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'historyproceedsview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'historyproceedsview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','historyproceedsview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historyproceedsview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'historyproceedsview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'historyproceedsview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','historyproceedsview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historyproceedsview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'historyproceedsview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'historyproceedsview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','historyproceedsview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historyproceedsview' AND field = 'kpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'historyproceedsview',denynull = 'S',format = '',col_len = '4',field = 'kpro',col_precision = '' where tablename = 'historyproceedsview' AND field = 'kpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','historyproceedsview','S','','4','kpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historyproceedsview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'historyproceedsview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'historyproceedsview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','historyproceedsview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historyproceedsview' AND field = 'npro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'historyproceedsview',denynull = 'S',format = '',col_len = '4',field = 'npro',col_precision = '' where tablename = 'historyproceedsview' AND field = 'npro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','historyproceedsview','S','','4','npro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historyproceedsview' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'historyproceedsview',denynull = 'S',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'historyproceedsview' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','historyproceedsview','S','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historyproceedsview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'historyproceedsview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'historyproceedsview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','historyproceedsview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'historyproceedsview' AND field = 'ypro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'historyproceedsview',denynull = 'S',format = '',col_len = '2',field = 'ypro',col_precision = '' where tablename = 'historyproceedsview' AND field = 'ypro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','historyproceedsview','S','','2','ypro','')
GO

-- VERIFICA DI historyproceedsview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'historyproceedsview')
UPDATE customobject set isreal = 'N' where objectname = 'historyproceedsview'
ELSE
INSERT INTO customobject (objectname, isreal) values('historyproceedsview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA incomeestimateview
IF EXISTS(select * from sysobjects where id = object_id(N'[incomeestimateview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [incomeestimateview]
GO






CREATE   VIEW incomeestimateview 
(
	idestimkind,
	yestim,
	nestim,
	movkind,
	idinc,
	estimkind,
	nphase,
	phase,
	ymov,
	nmov,
	--ycreation,
	parentidinc,
	parentymov,
	parentnmov,
	ayear,
	idfin,
	codefin,
	finance,
	idupb,
	codeupb,
	upb,
	idreg,
	registry,
	idman,
	manager,
	kpro,
	ypro,
	npro,
	doc,
	docdate,
	description,
	amount,
	ayearstartamount,
	--totalamount,
	curramount,
	available,
	totdetail,
	deltavalue, 
	deltapercent, 
	limitvalue,
	limitpercent,
	--fulfilled,
	incomelastflag,
	flag, 
	flagarrear,
	autokind,
	--idproceeds,
	idpayment,
	expiration,
	adate,
	cu,
	ct,
	lu,
	lt
)
	AS SELECT
	incomeestimate.idestimkind,
	incomeestimate.yestim,
	incomeestimate.nestim,
	incomeestimate.movkind,
	incomeestimate.idinc,
	estimatekind.description,
	income.nphase,
	incomephase.description,
	income.ymov,
	income.nmov,
	--income.ycreation,
	income.parentidinc,
	parentincome.ymov,
	parentincome.nmov,
	incomeyear.ayear,
	incomeyear.idfin,
	fin.codefin,
	fin.title,
	incomeyear.idupb,
	upb.codeupb,
	upb.title,
	income.idreg,
	registry.title,
	income.idman,
	manager.title,
	proceeds.kpro,
	proceeds.ypro,
	proceeds.npro,
	income.doc,
	income.docdate,
	income.description,
	incomeyear_starting.amount,--income.amount,
	incomeyear.amount,
	--incometotal.amount, è il total amount
	incometotal.curramount,
	incometotal.available,
	isnull((select sum(taxable_euro)
	from estimatedetailview
	where idinc_taxable = incomeestimate.idinc),0) 
	+
	isnull((select sum(iva_euro)
	from estimatedetailview
	where idinc_iva = incomeestimate.idinc),0),
	(isnull(incometotal.curramount,0) 
	-
	(isnull((select sum(taxable_euro)
	from estimatedetailview
	where idinc_taxable = incomeestimate.idinc),0) 
	+
	isnull((select sum(iva_euro)
	from estimatedetailview
	where idinc_iva = incomeestimate.idinc),0))),
	case
	when  
	      (
		isnull(incometotal.curramount,0) = 0 and 
		(isnull((select sum(taxable_euro)
		from estimatedetailview
		where idinc_taxable = incomeestimate.idinc),0) 
		+
		isnull((select sum(iva_euro)
		from estimatedetailview
		where idinc_iva = incomeestimate.idinc),0)) = 0
	      )
	then  0
	when   (isnull(incometotal.curramount,0) <> 0 and 
		(isnull((select sum(taxable_euro)
			from estimatedetailview
			where idinc_taxable = incomeestimate.idinc),0) 
			+
			isnull((select sum(iva_euro)
			from estimatedetailview
			where idinc_iva = incomeestimate.idinc),0)) = 0
	      )
	then  1000
	when   (isnull(incometotal.curramount,0) <> 0 and 
		(isnull((select sum(taxable_euro)
		from estimatedetailview
		where idinc_taxable = incomeestimate.idinc),0) 
		+
		isnull((select sum(iva_euro)
		from estimatedetailview
		where idinc_iva = incomeestimate.idinc),0)) <> 0
	      )
	then
	((isnull(incometotal.curramount,0) 
	-
	(isnull((select sum(taxable_euro)
	from estimatedetailview
	where idinc_taxable = incomeestimate.idinc),0) 
	+
	isnull((select sum(iva_euro)
	from estimatedetailview
	where idinc_iva = incomeestimate.idinc),0)))
	/
	(isnull((select sum(taxable_euro)
	from estimatedetailview
	where idinc_taxable = incomeestimate.idinc),0) 
	+
	isnull((select sum(iva_euro)
	from estimatedetailview
	where idinc_iva = incomeestimate.idinc),0)))
	end,
	isnull(estimatekind.deltaamount,0),
	isnull(estimatekind.deltapercentage,0),
	incomelast.flag,
	incometotal.flag, 
	CASE
		WHEN ((incometotal.flag&1)=0) THEN 'C'
		WHEN ((incometotal.flag&1)=1) THEN 'R'
	END, 
	income.autokind,
	--income.idproceeds,
	income.idpayment,
	income.expiration,
	income.adate,
	incomeestimate.cu,
	incomeestimate.ct,
	incomeestimate.lu,
	incomeestimate.lt
	FROM incomeestimate (NOLOCK)
	JOIN income (NOLOCK)
		ON income.idinc = incomeestimate.idinc
	JOIN incomephase (NOLOCK)
		ON incomephase.nphase = income.nphase
	JOIN incomeyear (NOLOCK)
		ON incomeyear.idinc = income.idinc
	JOIN incometotal (NOLOCK)
		ON incometotal.idinc = incomeyear.idinc
		AND incometotal.ayear = incomeyear.ayear
	JOIN estimatekind
		ON estimatekind.idestimkind = incomeestimate.idestimkind
	LEFT OUTER JOIN income parentincome (NOLOCK)
		ON income.parentidinc = parentincome.idinc
	LEFT OUTER JOIN incometotal incometotal_firstyear(NOLOCK)
		ON incometotal_firstyear.idinc = income.idinc
		AND ((incometotal_firstyear.flag & 2) <> 0 )
	LEFT OUTER JOIN incomeyear incomeyear_starting(NOLOCK) 
		ON incomeyear_starting.idinc = incometotal_firstyear.idinc
		AND incomeyear_starting.ayear = incometotal_firstyear.ayear
	LEFT OUTER JOIN incomelast  (NOLOCK)
		ON incomelast.idinc = income.idinc
	LEFT OUTER JOIN proceeds  (NOLOCK)
		ON incomelast.kpro = proceeds.kpro
	LEFT OUTER JOIN fin (NOLOCK)
		ON fin.idfin = incomeyear.idfin
	LEFT OUTER JOIN upb (NOLOCK)
		ON upb.idupb = incomeyear.idupb
	LEFT OUTER JOIN registry (NOLOCK)
		ON registry.idreg = income.idreg
	LEFT OUTER JOIN manager (NOLOCK)
		ON manager.idman = income.idman








GO

-- VERIFICA DI incomeestimateview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'incomeestimateview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'incomeestimateview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','incomeestimateview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'incomeestimateview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','incomeestimateview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'incomeestimateview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','incomeestimateview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'incomeestimateview' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','incomeestimateview','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'incomeestimateview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','incomeestimateview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'ayearstartamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '9',field = 'ayearstartamount',col_precision = '19' where tablename = 'incomeestimateview' AND field = 'ayearstartamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','incomeestimateview','N','','9','ayearstartamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'incomeestimateview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','incomeestimateview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'incomeestimateview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','incomeestimateview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'incomeestimateview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','incomeestimateview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'incomeestimateview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','incomeestimateview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'incomeestimateview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','incomeestimateview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'deltapercent')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,6)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '17',field = 'deltapercent',col_precision = '38' where tablename = 'incomeestimateview' AND field = 'deltapercent'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(38,6)','N','incomeestimateview','N','','17','deltapercent','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'deltavalue')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,6)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '17',field = 'deltavalue',col_precision = '38' where tablename = 'incomeestimateview' AND field = 'deltavalue'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(38,6)','N','incomeestimateview','N','','17','deltavalue','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'incomeestimateview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','incomeestimateview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'incomeestimateview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','incomeestimateview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'incomeestimateview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','incomeestimateview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'estimkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '150',field = 'estimkind',col_precision = '' where tablename = 'incomeestimateview' AND field = 'estimkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','incomeestimateview','S','','150','estimkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'incomeestimateview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','incomeestimateview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'incomeestimateview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','incomeestimateview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'incomeestimateview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','incomeestimateview','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'incomeestimateview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','incomeestimateview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'idestimkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '20',field = 'idestimkind',col_precision = '' where tablename = 'incomeestimateview' AND field = 'idestimkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','incomeestimateview','S','','20','idestimkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'incomeestimateview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeestimateview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'idinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '4',field = 'idinc',col_precision = '' where tablename = 'incomeestimateview' AND field = 'idinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','incomeestimateview','S','','4','idinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'incomeestimateview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeestimateview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'incomeestimateview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeestimateview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'incomeestimateview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeestimateview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'incomeestimateview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','incomeestimateview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'incomelastflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '1',field = 'incomelastflag',col_precision = '' where tablename = 'incomeestimateview' AND field = 'incomelastflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','incomeestimateview','N','','1','incomelastflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'kpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '4',field = 'kpro',col_precision = '' where tablename = 'incomeestimateview' AND field = 'kpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeestimateview','N','','4','kpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'limitpercent')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '9',field = 'limitpercent',col_precision = '19' where tablename = 'incomeestimateview' AND field = 'limitpercent'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','N','System.Decimal','decimal(19,6)','N','incomeestimateview','S','','9','limitpercent','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'limitvalue')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '9',field = 'limitvalue',col_precision = '19' where tablename = 'incomeestimateview' AND field = 'limitvalue'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','N','System.Decimal','decimal(19,2)','N','incomeestimateview','S','','9','limitvalue','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'incomeestimateview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','incomeestimateview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'incomeestimateview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','incomeestimateview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'incomeestimateview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','incomeestimateview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'movkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '2',field = 'movkind',col_precision = '' where tablename = 'incomeestimateview' AND field = 'movkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','incomeestimateview','S','','2','movkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'nestim')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '4',field = 'nestim',col_precision = '' where tablename = 'incomeestimateview' AND field = 'nestim'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','incomeestimateview','S','','4','nestim','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'incomeestimateview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','incomeestimateview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'incomeestimateview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','incomeestimateview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'npro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '4',field = 'npro',col_precision = '' where tablename = 'incomeestimateview' AND field = 'npro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeestimateview','N','','4','npro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'parentidinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '4',field = 'parentidinc',col_precision = '' where tablename = 'incomeestimateview' AND field = 'parentidinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeestimateview','N','','4','parentidinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'incomeestimateview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeestimateview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'incomeestimateview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','incomeestimateview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'incomeestimateview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','incomeestimateview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'incomeestimateview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','incomeestimateview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'totdetail')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,6)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '17',field = 'totdetail',col_precision = '38' where tablename = 'incomeestimateview' AND field = 'totdetail'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(38,6)','N','incomeestimateview','N','','17','totdetail','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'incomeestimateview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','incomeestimateview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'yestim')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '2',field = 'yestim',col_precision = '' where tablename = 'incomeestimateview' AND field = 'yestim'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','incomeestimateview','S','','2','yestim','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomeestimateview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'incomeestimateview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','incomeestimateview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeestimateview' AND field = 'ypro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomeestimateview',denynull = 'N',format = '',col_len = '2',field = 'ypro',col_precision = '' where tablename = 'incomeestimateview' AND field = 'ypro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','incomeestimateview','N','','2','ypro','')
GO

-- VERIFICA DI incomeestimateview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'incomeestimateview')
UPDATE customobject set isreal = 'N' where objectname = 'incomeestimateview'
ELSE
INSERT INTO customobject (objectname, isreal) values('incomeestimateview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA incomeinvoiceview
IF EXISTS(select * from sysobjects where id = object_id(N'[incomeinvoiceview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [incomeinvoiceview]
GO


-- select * from incomeinvoiceview
CREATE  VIEW incomeinvoiceview 
	(
	idinvkind,
	codeinvkind,
	invoicekind,
	yinv,
	ninv,
	movkind,
	idinc,
	nphase,
	phase,
	ymov,
	nmov,
	parentidinc,
	parentymov,
	parentnmov,
	ayear,
	idfin,
	codefin,
	finance,
	idupb,
	codeupb,
	upb,
	idreg,
	registry,
	idman,
	manager,
	kpro,
	ypro,
	npro,
	doc,
	docdate,
	description,
	amount,
	ayearstartamount,
	curramount,
	available,
	unpartitioned,
	incomelastflag,
	flag, 
	flagarrear,
	autokind,
	idpayment,
	expiration,
	adate,
	cu,
	ct,
	lu,
	lt
	)
	AS SELECT
	incomeinvoice.idinvkind,
	invoicekind.codeinvkind,
	invoicekind.description,
	incomeinvoice.yinv,
	incomeinvoice.ninv,
	incomeinvoice.movkind,
	incomeinvoice.idinc,
	income.nphase,
	incomephase.description,
	income.ymov,
	income.nmov,
	--income.ycreation,
	income.parentidinc,
	parentincome.ymov,
	parentincome.nmov,
	incomeyear.ayear,
	incomeyear.idfin,
	fin.codefin,
	fin.title,
	upb.idupb,	
	upb.codeupb,	
	upb.title,	
	income.idreg,
	registry.title,
	income.idman,
	manager.title,
	proceeds.kpro,
	proceeds.ypro,
	proceeds.npro,
	income.doc,
	income.docdate,
	income.description,
	incomeyear_starting.amount, --income.amount,
	incomeyear.amount,--incometotal.amount,
	incometotal.curramount,
	incometotal.available,
	ISNULL(incometotal.curramount,0) - ISNULL(incometotal.partitioned,0),
	incomelast.flag, --fulfilled
	incometotal.flag,
	CASE
		WHEN ((incometotal.flag&1)=0) THEN 'C'
		WHEN ((incometotal.flag&1)=1) THEN 'R'
	END, 
	income.autokind,
	income.idpayment,
	income.expiration,
	income.adate,
	incomeinvoice.cu,
	incomeinvoice.ct,
	incomeinvoice.lu,
	incomeinvoice.lt
	FROM incomeinvoice (NOLOCK)
	JOIN invoicekind (NOLOCK)
		ON invoicekind.idinvkind = incomeinvoice.idinvkind
	JOIN income (NOLOCK)
		ON income.idinc = incomeinvoice.idinc
	JOIN incomephase (NOLOCK)
		ON incomephase.nphase = income.nphase
	JOIN incomeyear (NOLOCK)
		ON incomeyear.idinc = income.idinc
	JOIN incometotal (NOLOCK)
		ON incometotal.idinc = incomeyear.idinc
		AND incometotal.ayear = incomeyear.ayear
	LEFT OUTER JOIN incometotal incometotal_firstyear(NOLOCK)
		ON incometotal_firstyear.idinc = income.idinc
		AND ((incometotal_firstyear.flag & 2) <> 0 )
	LEFT OUTER JOIN incomeyear incomeyear_starting(NOLOCK) 
		ON incomeyear_starting.idinc = incometotal_firstyear.idinc
		AND incomeyear_starting.ayear = incometotal_firstyear.ayear
	LEFT OUTER JOIN income parentincome (NOLOCK)
		ON income.parentidinc = parentincome.idinc
	LEFT OUTER JOIN incomelast  (NOLOCK)
		ON incomelast.idinc = income.idinc
	LEFT OUTER JOIN proceeds  (NOLOCK)
		ON incomelast.kpro = proceeds.kpro
	LEFT OUTER JOIN fin (NOLOCK)
		ON fin.idfin = incomeyear.idfin
	LEFT OUTER JOIN upb (NOLOCK)
		ON upb.idupb=incomeyear.idupb
	LEFT OUTER JOIN registry (NOLOCK)
		ON registry.idreg = income.idreg
	LEFT OUTER JOIN manager (NOLOCK)
		ON manager.idman = income.idman


GO

-- VERIFICA DI incomeinvoiceview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'incomeinvoiceview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','incomeinvoiceview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'incomeinvoiceview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','incomeinvoiceview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','incomeinvoiceview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'incomeinvoiceview' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','incomeinvoiceview','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','incomeinvoiceview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'ayearstartamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '9',field = 'ayearstartamount',col_precision = '19' where tablename = 'incomeinvoiceview' AND field = 'ayearstartamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','incomeinvoiceview','N','','9','ayearstartamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','incomeinvoiceview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'codeinvkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'S',format = '',col_len = '20',field = 'codeinvkind',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'codeinvkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','incomeinvoiceview','S','','20','codeinvkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','incomeinvoiceview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','incomeinvoiceview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','incomeinvoiceview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'incomeinvoiceview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','incomeinvoiceview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','incomeinvoiceview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','incomeinvoiceview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','incomeinvoiceview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','incomeinvoiceview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','incomeinvoiceview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','incomeinvoiceview','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','incomeinvoiceview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeinvoiceview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'idinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'S',format = '',col_len = '4',field = 'idinc',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'idinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','incomeinvoiceview','S','','4','idinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'idinvkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'S',format = '',col_len = '4',field = 'idinvkind',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'idinvkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','incomeinvoiceview','S','','4','idinvkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeinvoiceview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeinvoiceview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeinvoiceview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','incomeinvoiceview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'incomelastflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '1',field = 'incomelastflag',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'incomelastflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','incomeinvoiceview','N','','1','incomelastflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'invoicekind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'S',format = '',col_len = '50',field = 'invoicekind',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'invoicekind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','incomeinvoiceview','S','','50','invoicekind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'kpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'kpro',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'kpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeinvoiceview','N','','4','kpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','incomeinvoiceview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','incomeinvoiceview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','incomeinvoiceview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'movkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'S',format = '',col_len = '2',field = 'movkind',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'movkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','incomeinvoiceview','S','','2','movkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'ninv')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'S',format = '',col_len = '4',field = 'ninv',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'ninv'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','incomeinvoiceview','S','','4','ninv','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','incomeinvoiceview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','incomeinvoiceview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'npro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'npro',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'npro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeinvoiceview','N','','4','npro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'parentidinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'parentidinc',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'parentidinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeinvoiceview','N','','4','parentidinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeinvoiceview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','incomeinvoiceview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','incomeinvoiceview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','incomeinvoiceview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'unpartitioned')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(20,2)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '13',field = 'unpartitioned',col_precision = '20' where tablename = 'incomeinvoiceview' AND field = 'unpartitioned'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(20,2)','N','incomeinvoiceview','N','','13','unpartitioned','20')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','incomeinvoiceview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'yinv')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'S',format = '',col_len = '2',field = 'yinv',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'yinv'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','incomeinvoiceview','S','','2','yinv','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','incomeinvoiceview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeinvoiceview' AND field = 'ypro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomeinvoiceview',denynull = 'N',format = '',col_len = '2',field = 'ypro',col_precision = '' where tablename = 'incomeinvoiceview' AND field = 'ypro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','incomeinvoiceview','N','','2','ypro','')
GO

-- VERIFICA DI incomeinvoiceview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'incomeinvoiceview')
UPDATE customobject set isreal = 'N' where objectname = 'incomeinvoiceview'
ELSE
INSERT INTO customobject (objectname, isreal) values('incomeinvoiceview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA incomelastview
IF EXISTS(select * from sysobjects where id = object_id(N'[incomelastview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [incomelastview]
GO



CREATE    VIEW [incomelastview]
(
	idinc,
	nphase,
	phase,
	ymov,
	nmov,
	parentymov,
	parentnmov,
	parentidinc,
	ayear,
	idfin,
	codefin,
	finance,
	idupb,
	codeupb,
	upb,
	idreg,
	registry,
	idman,
	manager,
	kpro,
	ypro,
	npro,
	doc,
	docdate,
	description,
	amount,
	ayearstartamount,
	curramount,
	available,
  	unpartitioned,
	flag,
	totflag,
	flagarrear,
	autokind,
	autocode,
	idpayment,
	expiration,
	adate,
	nbill,
	idpro,
	cu,
	ct,
	lu,
	lt
)
AS SELECT
	income.idinc,
	income.nphase,
	incomephase.description,
	income.ymov,
	income.nmov,
	parentincome.ymov,
	parentincome.nmov,
	--income.ycreation,
	income.parentidinc,
	incomeyear.ayear,
	incomeyear.idfin,
	fin.codefin,
	fin.title,
	upb.idupb,
	upb.codeupb,
	upb.title,
	income.idreg,
	registry.title,
	income.idman,
	manager.title,
	proceeds.kpro,
	proceeds.ypro,
	proceeds.npro,
	income.doc,
	income.docdate,
	income.description,
	--income.amount,
	incomeyear_starting.amount,
	incomeyear.amount,
	incometotal.curramount,
	incometotal.available,
	-- Modificato da Francesco per correggere la visualizzazione dell'importo da assegnare su movimenti residui
        case income.nphase 
	 WHEN (SELECT incomefinphase FROM uniconfig) THEN
		CASE   
			WHEN ((incometotal.flag&1) = 0) THEN  ISNULL(incometotal.curramount,0)-ISNULL(incometotal.partitioned,0)
			ELSE
			0
		END
	ELSE
		  ISNULL(incometotal.curramount,0)-ISNULL(incometotal.partitioned,0)
	END,
	incomelast.flag,
	incometotal.flag, 
	CASE
		WHEN ((incometotal.flag&1)=0) THEN 'C'
		WHEN ((incometotal.flag&1)=1) THEN 'R'
	END, 
	income.autokind,
	income.autocode,
	--income.idproceeds,
	income.idpayment,
	income.expiration,
	income.adate,
	incomelast.nbill,
	incomelast.idpro,
	incomelast.cu,
	incomelast.ct,
	incomelast.lu,
	incomelast.lt
	FROM income (NOLOCK)
	JOIN incomephase (NOLOCK)
	ON incomephase.nphase = income.nphase
	JOIN incomeyear (NOLOCK)
	ON incomeyear.idinc = income.idinc 
	JOIN incometotal (NOLOCK)
	ON incometotal.idinc = income.idinc
	AND incometotal.ayear = incomeyear.ayear
	LEFT OUTER JOIN income parentincome (NOLOCK)
	ON income.parentidinc = parentincome.idinc
	JOIN incomelast  (NOLOCK)
	ON incomelast.idinc = income.idinc
	LEFT OUTER JOIN proceeds  (NOLOCK)
	ON incomelast.kpro = proceeds.kpro
	LEFT OUTER JOIN fin (NOLOCK)
	ON fin.idfin = incomeyear.idfin
	LEFT OUTER JOIN upb (NOLOCK)
	ON upb.idupb=incomeyear.idupb
	LEFT OUTER JOIN registry (NOLOCK)
	ON registry.idreg = income.idreg
	LEFT OUTER JOIN manager (NOLOCK)
	ON manager.idman = income.idman
	LEFT OUTER JOIN incometotal incometotal_firstyear(NOLOCK)
  	ON incometotal_firstyear.idinc = income.idinc
  	AND ((incometotal_firstyear.flag & 2) <> 0 )
 	LEFT OUTER JOIN incomeyear incomeyear_starting(NOLOCK) 
	ON incomeyear_starting.idinc = incometotal_firstyear.idinc
  	AND incomeyear_starting.ayear = incometotal_firstyear.ayear

GO

-- VERIFICA DI incomelastview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'incomelastview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'incomelastview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'incomelastview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','incomelastview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'incomelastview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','incomelastview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'autocode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '4',field = 'autocode',col_precision = '' where tablename = 'incomelastview' AND field = 'autocode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomelastview','N','','4','autocode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'incomelastview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','incomelastview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'incomelastview' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','incomelastview','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomelastview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'incomelastview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','incomelastview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'ayearstartamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '9',field = 'ayearstartamount',col_precision = '19' where tablename = 'incomelastview' AND field = 'ayearstartamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','incomelastview','N','','9','ayearstartamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'incomelastview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','incomelastview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'incomelastview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','incomelastview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'incomelastview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'incomelastview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','incomelastview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'incomelastview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'incomelastview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','incomelastview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'incomelastview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','incomelastview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'incomelastview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'incomelastview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','incomelastview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'incomelastview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','incomelastview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'incomelastview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','incomelastview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'incomelastview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','incomelastview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'incomelastview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','incomelastview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'incomelastview',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'incomelastview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','incomelastview','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'incomelastview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','incomelastview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'incomelastview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomelastview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'idinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomelastview',denynull = 'S',format = '',col_len = '4',field = 'idinc',col_precision = '' where tablename = 'incomelastview' AND field = 'idinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','incomelastview','S','','4','idinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'incomelastview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomelastview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'incomelastview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomelastview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'idpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '4',field = 'idpro',col_precision = '' where tablename = 'incomelastview' AND field = 'idpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomelastview','N','','4','idpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'incomelastview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomelastview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'incomelastview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','incomelastview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'kpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '4',field = 'kpro',col_precision = '' where tablename = 'incomelastview' AND field = 'kpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomelastview','N','','4','kpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'incomelastview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'incomelastview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','incomelastview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'incomelastview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'incomelastview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','incomelastview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'incomelastview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','incomelastview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'nbill')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '4',field = 'nbill',col_precision = '' where tablename = 'incomelastview' AND field = 'nbill'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomelastview','N','','4','nbill','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomelastview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'incomelastview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','incomelastview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'incomelastview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'incomelastview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','incomelastview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'npro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '4',field = 'npro',col_precision = '' where tablename = 'incomelastview' AND field = 'npro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomelastview','N','','4','npro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'parentidinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '4',field = 'parentidinc',col_precision = '' where tablename = 'incomelastview' AND field = 'parentidinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomelastview','N','','4','parentidinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'incomelastview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomelastview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'incomelastview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','incomelastview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'incomelastview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'incomelastview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','incomelastview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'incomelastview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','incomelastview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'incomelastview',denynull = 'S',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'incomelastview' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','incomelastview','S','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'unpartitioned')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(20,2)',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '13',field = 'unpartitioned',col_precision = '20' where tablename = 'incomelastview' AND field = 'unpartitioned'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(20,2)','N','incomelastview','N','','13','unpartitioned','20')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'incomelastview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','incomelastview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomelastview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'incomelastview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','incomelastview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomelastview' AND field = 'ypro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomelastview',denynull = 'N',format = '',col_len = '2',field = 'ypro',col_precision = '' where tablename = 'incomelastview' AND field = 'ypro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','incomelastview','N','','2','ypro','')
GO

-- VERIFICA DI incomelastview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'incomelastview')
UPDATE customobject set isreal = 'N' where objectname = 'incomelastview'
ELSE
INSERT INTO customobject (objectname, isreal) values('incomelastview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA incomevarview
IF EXISTS(select * from sysobjects where id = object_id(N'[incomevarview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [incomevarview]
GO


CREATE  VIEW [incomevarview]
(
	idinc,
	nvar,
	yvar,
	nphase,
	phase,
	ymov,
	nmov,
	description,
	amount,
	doc,
	docdate,
	adate,
	transferkind,
	autokind,
	cu,
	ct,
	lu,
	lt,
	codefin,
	finance,
	idinvkind,
	codeinvkind,
	invoicekind,
	yinv,
	ninv,
	movkind
)
AS SELECT
	incomevar.idinc,
	incomevar.nvar,
	incomevar.yvar,
	income.nphase,
	incomephase.description,
	income.ymov,
	income.nmov,
	incomevar.description,
	incomevar.amount,
	incomevar.doc,
	incomevar.docdate,
	incomevar.adate,
	incomevar.transferkind,
	incomevar.autokind,
	incomevar.cu,
	incomevar.ct,
	incomevar.lu,
	incomevar.lt,
	fin.codefin,
	fin.title,
	incomevar.idinvkind,
	invoicekind.codeinvkind,
	invoicekind.description,
	incomevar.yinv,
	incomevar.ninv,
	incomevar.movkind
FROM incomevar (NOLOCK)
JOIN income (NOLOCK)
	ON income.idinc = incomevar.idinc
JOIN incomephase (NOLOCK)
	ON incomephase.nphase = income.nphase
JOIN incomeyear (NOLOCK)
	ON incomeyear.idinc= income.idinc
	AND incomeyear.ayear= incomevar.yvar
LEFT OUTER JOIN fin (NOLOCK)
	ON fin.idfin= incomeyear.idfin
LEFT OUTER JOIN invoicekind
	ON incomevar.idinvkind = invoicekind.idinvkind
	
	











GO

-- VERIFICA DI incomevarview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'incomevarview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'incomevarview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'incomevarview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','incomevarview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'incomevarview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'incomevarview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','incomevarview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'incomevarview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'incomevarview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','incomevarview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'incomevarview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'incomevarview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','incomevarview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'codeinvkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'incomevarview',denynull = 'N',format = '',col_len = '20',field = 'codeinvkind',col_precision = '' where tablename = 'incomevarview' AND field = 'codeinvkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','incomevarview','N','','20','codeinvkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'incomevarview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'incomevarview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','incomevarview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'incomevarview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'incomevarview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','incomevarview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'incomevarview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'incomevarview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','incomevarview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'incomevarview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'incomevarview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','incomevarview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'incomevarview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'incomevarview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','incomevarview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'incomevarview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'incomevarview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','incomevarview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'idinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomevarview',denynull = 'S',format = '',col_len = '4',field = 'idinc',col_precision = '' where tablename = 'incomevarview' AND field = 'idinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','incomevarview','S','','4','idinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'idinvkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomevarview',denynull = 'N',format = '',col_len = '4',field = 'idinvkind',col_precision = '' where tablename = 'incomevarview' AND field = 'idinvkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomevarview','N','','4','idinvkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'invoicekind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'incomevarview',denynull = 'N',format = '',col_len = '50',field = 'invoicekind',col_precision = '' where tablename = 'incomevarview' AND field = 'invoicekind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','incomevarview','N','','50','invoicekind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'incomevarview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'incomevarview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','incomevarview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'incomevarview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'incomevarview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','incomevarview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'movkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomevarview',denynull = 'N',format = '',col_len = '2',field = 'movkind',col_precision = '' where tablename = 'incomevarview' AND field = 'movkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','incomevarview','N','','2','movkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'ninv')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomevarview',denynull = 'N',format = '',col_len = '4',field = 'ninv',col_precision = '' where tablename = 'incomevarview' AND field = 'ninv'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomevarview','N','','4','ninv','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomevarview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'incomevarview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','incomevarview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'incomevarview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'incomevarview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','incomevarview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'nvar')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomevarview',denynull = 'S',format = '',col_len = '4',field = 'nvar',col_precision = '' where tablename = 'incomevarview' AND field = 'nvar'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','incomevarview','S','','4','nvar','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'incomevarview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'incomevarview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','incomevarview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'transferkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'incomevarview',denynull = 'N',format = '',col_len = '1',field = 'transferkind',col_precision = '' where tablename = 'incomevarview' AND field = 'transferkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','incomevarview','N','','1','transferkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'yinv')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomevarview',denynull = 'N',format = '',col_len = '2',field = 'yinv',col_precision = '' where tablename = 'incomevarview' AND field = 'yinv'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','incomevarview','N','','2','yinv','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomevarview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'incomevarview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','incomevarview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomevarview' AND field = 'yvar')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomevarview',denynull = 'S',format = '',col_len = '2',field = 'yvar',col_precision = '' where tablename = 'incomevarview' AND field = 'yvar'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','incomevarview','S','','2','yvar','')
GO

-- VERIFICA DI incomevarview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'incomevarview')
UPDATE customobject set isreal = 'N' where objectname = 'incomevarview'
ELSE
INSERT INTO customobject (objectname, isreal) values('incomevarview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA incomeview
IF EXISTS(select * from sysobjects where id = object_id(N'[incomeview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [incomeview]
GO




CREATE  VIEW [incomeview]
(
	idinc,
	nphase,
	phase,
	ymov,
	nmov,
	parentymov,
	parentnmov,
	parentidinc,
	ayear,
	idfin,
	codefin,
	finance,
	idupb,
	codeupb,
	upb,
	idreg,
	registry,
	idman,
	manager,
	kpro,
	ypro,
	npro,
	doc,
	docdate,
	description,
	amount,
	ayearstartamount,
	curramount,
	available,
  	unpartitioned,
	flag,
	totflag,
	flagarrear,
	autokind,
	autocode,
	idpayment,
	expiration,
	adate,
	nbill,
	idpro,
	cu,
	ct,
	lu,
	lt
)
AS SELECT
	income.idinc,
	income.nphase,
	incomephase.description,
	income.ymov,
	income.nmov,
	parentincome.ymov,
	parentincome.nmov,
	income.parentidinc,
	incomeyear.ayear,
	incomeyear.idfin,
	fin.codefin,
	fin.title,
	upb.idupb,
	upb.codeupb,
	upb.title,
	income.idreg,
	registry.title,
	income.idman,
	manager.title,
	proceeds.kpro,
	proceeds.ypro,
	proceeds.npro,
	income.doc,
	income.docdate,
	income.description,
	incomeyear_starting.amount,
	incomeyear.amount,
	incometotal.curramount,
	incometotal.available,
	-- Modificato da Francesco per correggere la visualizzazione dell'importo da assegnare su movimenti residui
        case income.nphase 
	 WHEN (SELECT incomeregphase from uniconfig) THEN
		CASE   
			WHEN ((incometotal.flag&1) = 0) THEN  ISNULL(incometotal.curramount,0)-ISNULL(incometotal.partitioned,0)
			ELSE
			0
		END
	ELSE
		  ISNULL(incometotal.curramount,0)-ISNULL(incometotal.partitioned,0)
	END,
	incomelast.flag,
	incometotal.flag, 
	CASE
		WHEN ((incometotal.flag&1)=0) THEN 'C'
		WHEN ((incometotal.flag&1)=1) THEN 'R'
	END, 
	income.autokind,
	income.autocode,
	income.idpayment,
	income.expiration,
	income.adate,
	incomelast.nbill,
	incomelast.idpro,
	income.cu,
	income.ct,
	income.lu,
	income.lt
	FROM income (NOLOCK)
	JOIN incomephase (NOLOCK)
	ON incomephase.nphase = income.nphase
	JOIN incomeyear (NOLOCK)
	ON incomeyear.idinc = income.idinc 
	JOIN incometotal (NOLOCK)
	ON incometotal.idinc = income.idinc
	AND incometotal.ayear = incomeyear.ayear
	LEFT OUTER JOIN income parentincome (NOLOCK)
	ON income.parentidinc = parentincome.idinc
	LEFT OUTER JOIN incomelast  (NOLOCK)
	ON incomelast.idinc = income.idinc
	LEFT OUTER JOIN proceeds  (NOLOCK)
	ON incomelast.kpro = proceeds.kpro
	LEFT OUTER JOIN fin (NOLOCK)
	ON fin.idfin = incomeyear.idfin
	LEFT OUTER JOIN upb (NOLOCK)
	ON upb.idupb=incomeyear.idupb
	LEFT OUTER JOIN registry (NOLOCK)
	ON registry.idreg = income.idreg
	LEFT OUTER JOIN manager (NOLOCK)
	ON manager.idman = income.idman
	LEFT OUTER JOIN incometotal incometotal_firstyear(NOLOCK)
  	ON incometotal_firstyear.idinc = income.idinc
  	AND ((incometotal_firstyear.flag & 2) <> 0 )
 	LEFT OUTER JOIN incomeyear incomeyear_starting(NOLOCK) 
	ON incomeyear_starting.idinc = incometotal_firstyear.idinc
  	AND incomeyear_starting.ayear = incometotal_firstyear.ayear


GO

-- VERIFICA DI incomeview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'incomeview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'incomeview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'incomeview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','incomeview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'incomeview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','incomeview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'autocode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '4',field = 'autocode',col_precision = '' where tablename = 'incomeview' AND field = 'autocode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeview','N','','4','autocode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'incomeview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','incomeview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'incomeview' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','incomeview','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomeview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'incomeview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','incomeview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'ayearstartamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '9',field = 'ayearstartamount',col_precision = '19' where tablename = 'incomeview' AND field = 'ayearstartamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','incomeview','N','','9','ayearstartamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'incomeview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','incomeview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'incomeview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','incomeview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'incomeview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'incomeview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','incomeview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'incomeview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'incomeview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','incomeview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'incomeview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','incomeview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'incomeview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'incomeview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','incomeview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'incomeview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','incomeview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'incomeview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','incomeview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'incomeview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','incomeview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'incomeview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','incomeview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'incomeview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','incomeview','N','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'incomeview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','incomeview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'incomeview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'idinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeview',denynull = 'S',format = '',col_len = '4',field = 'idinc',col_precision = '' where tablename = 'incomeview' AND field = 'idinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','incomeview','S','','4','idinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'incomeview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'incomeview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'idpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '4',field = 'idpro',col_precision = '' where tablename = 'incomeview' AND field = 'idpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeview','N','','4','idpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'incomeview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'incomeview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','incomeview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'kpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '4',field = 'kpro',col_precision = '' where tablename = 'incomeview' AND field = 'kpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeview','N','','4','kpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'incomeview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'incomeview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','incomeview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'incomeview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'incomeview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','incomeview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'incomeview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','incomeview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'nbill')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '4',field = 'nbill',col_precision = '' where tablename = 'incomeview' AND field = 'nbill'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeview','N','','4','nbill','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'incomeview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','incomeview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'incomeview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'incomeview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','incomeview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'npro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '4',field = 'npro',col_precision = '' where tablename = 'incomeview' AND field = 'npro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeview','N','','4','npro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'parentidinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '4',field = 'parentidinc',col_precision = '' where tablename = 'incomeview' AND field = 'parentidinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeview','N','','4','parentidinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'incomeview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','incomeview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'incomeview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','incomeview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'incomeview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'incomeview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','incomeview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'incomeview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','incomeview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'incomeview',denynull = 'S',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'incomeview' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','incomeview','S','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'unpartitioned')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(20,2)',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '13',field = 'unpartitioned',col_precision = '20' where tablename = 'incomeview' AND field = 'unpartitioned'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(20,2)','N','incomeview','N','','13','unpartitioned','20')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'incomeview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','incomeview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomeview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'incomeview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','incomeview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'incomeview' AND field = 'ypro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'incomeview',denynull = 'N',format = '',col_len = '2',field = 'ypro',col_precision = '' where tablename = 'incomeview' AND field = 'ypro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','incomeview','N','','2','ypro','')
GO

-- VERIFICA DI incomeview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'incomeview')
UPDATE customobject set isreal = 'N' where objectname = 'incomeview'
ELSE
INSERT INTO customobject (objectname, isreal) values('incomeview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA invoicelinked
IF EXISTS(select * from sysobjects where id = object_id(N'[invoicelinked]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [invoicelinked]
GO


CREATE                                 VIEW [invoicelinked]
	(
	idinvkind,
	codeinvkind,
	invoicekind,
	yinv,
	ninv,
	flag,
	flagbuysell,
	flagvariation,
	idreg,
	registry,
	registryreference,
	description,
	paymentexpiring,
	idexpirationkind,
	idcurrency,
	codecurrency,
	currency,
	exchangerate,
	doc,
	docdate,
	adate,
	packinglistnum,
	packinglistdate,
	--flagintra,
	officiallyprinted,
	txt,
	cu, 
	ct, 
	lu, 
	lt
	)
	AS SELECT
	invoice.idinvkind,
	invoicekind.codeinvkind,
	invoicekind.description,
	invoice.yinv,
	invoice.ninv,
	invoicekind.flag,
	CASE
		WHEN ((invoicekind.flag&1)=0) THEN 'A'--flagbuysell
		WHEN ((invoicekind.flag&1)<>0) THEN 'V'
	END, 
	CASE
		WHEN ((invoicekind.flag&4)=0) THEN 'N'--flagvariation
		WHEN ((invoicekind.flag&4)<>0) THEN 'S'
	END, 
	invoice.idreg,
	registry.title,
	invoice.registryreference,
	invoice.description,
	invoice.paymentexpiring,
	invoice.idexpirationkind,
	invoice.idcurrency,
	currency.codecurrency,
	currency.description,
	invoice.exchangerate,
	invoice.doc,
	invoice.docdate,
	invoice.adate,
	invoice.packinglistnum,
	invoice.packinglistdate,
	--invoice.flagintra,
	invoice.officiallyprinted,
	invoice.txt,
	invoice.cu, 
	invoice.ct, 
	invoice.lu,
	invoice.lt 
	FROM invoice (NOLOCK)
	JOIN invoicekind(NOLOCK)
	ON invoicekind.idinvkind = invoice.idinvkind
	JOIN registry (NOLOCK)
	ON registry.idreg = invoice.idreg
	LEFT OUTER JOIN currency (NOLOCK)
	ON currency.idcurrency = invoice.idcurrency
	WHERE EXISTS
		(SELECT * FROM expenseinvoice
		WHERE expenseinvoice.idinvkind = invoice.idinvkind
		AND expenseinvoice.yinv=invoice.yinv
		AND expenseinvoice.ninv=invoice.ninv)











GO

-- VERIFICA DI invoicelinked IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'invoicelinked'
IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'invoicelinked',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'invoicelinked' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','invoicelinked','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'codecurrency')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'invoicelinked',denynull = 'N',format = '',col_len = '20',field = 'codecurrency',col_precision = '' where tablename = 'invoicelinked' AND field = 'codecurrency'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','invoicelinked','N','','20','codecurrency','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'codeinvkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'invoicelinked',denynull = 'S',format = '',col_len = '20',field = 'codeinvkind',col_precision = '' where tablename = 'invoicelinked' AND field = 'codeinvkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','invoicelinked','S','','20','codeinvkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'invoicelinked',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'invoicelinked' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','invoicelinked','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'invoicelinked',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'invoicelinked' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','invoicelinked','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'currency')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'invoicelinked',denynull = 'N',format = '',col_len = '50',field = 'currency',col_precision = '' where tablename = 'invoicelinked' AND field = 'currency'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','invoicelinked','N','','50','currency','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'invoicelinked',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'invoicelinked' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','invoicelinked','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'invoicelinked',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'invoicelinked' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','invoicelinked','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'invoicelinked',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'invoicelinked' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','invoicelinked','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'exchangerate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'float',defaultvalue = '',allownull = 'S',systemtype = 'System.Double',sqldeclaration = 'float',iskey = 'N',tablename = 'invoicelinked',denynull = 'N',format = '',col_len = '8',field = 'exchangerate',col_precision = '' where tablename = 'invoicelinked' AND field = 'exchangerate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','float','','S','System.Double','float','N','invoicelinked','N','','8','exchangerate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'invoicelinked',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'invoicelinked' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','invoicelinked','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'flagbuysell')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'invoicelinked',denynull = 'N',format = '',col_len = '1',field = 'flagbuysell',col_precision = '' where tablename = 'invoicelinked' AND field = 'flagbuysell'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','invoicelinked','N','','1','flagbuysell','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'flagvariation')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'invoicelinked',denynull = 'N',format = '',col_len = '1',field = 'flagvariation',col_precision = '' where tablename = 'invoicelinked' AND field = 'flagvariation'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','invoicelinked','N','','1','flagvariation','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'idcurrency')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicelinked',denynull = 'N',format = '',col_len = '4',field = 'idcurrency',col_precision = '' where tablename = 'invoicelinked' AND field = 'idcurrency'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','invoicelinked','N','','4','idcurrency','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'idexpirationkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'invoicelinked',denynull = 'N',format = '',col_len = '2',field = 'idexpirationkind',col_precision = '' where tablename = 'invoicelinked' AND field = 'idexpirationkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','invoicelinked','N','','2','idexpirationkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'idinvkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicelinked',denynull = 'S',format = '',col_len = '4',field = 'idinvkind',col_precision = '' where tablename = 'invoicelinked' AND field = 'idinvkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','invoicelinked','S','','4','idinvkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicelinked',denynull = 'S',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'invoicelinked' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','invoicelinked','S','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'invoicekind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'invoicelinked',denynull = 'S',format = '',col_len = '50',field = 'invoicekind',col_precision = '' where tablename = 'invoicelinked' AND field = 'invoicekind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','invoicelinked','S','','50','invoicekind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'invoicelinked',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'invoicelinked' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','invoicelinked','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'invoicelinked',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'invoicelinked' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','invoicelinked','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'ninv')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicelinked',denynull = 'S',format = '',col_len = '4',field = 'ninv',col_precision = '' where tablename = 'invoicelinked' AND field = 'ninv'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','invoicelinked','S','','4','ninv','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'officiallyprinted')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'invoicelinked',denynull = 'S',format = '',col_len = '1',field = 'officiallyprinted',col_precision = '' where tablename = 'invoicelinked' AND field = 'officiallyprinted'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','N','System.String','char(1)','N','invoicelinked','S','','1','officiallyprinted','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'packinglistdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'invoicelinked',denynull = 'N',format = '',col_len = '4',field = 'packinglistdate',col_precision = '' where tablename = 'invoicelinked' AND field = 'packinglistdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','invoicelinked','N','','4','packinglistdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'packinglistnum')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(25)',iskey = 'N',tablename = 'invoicelinked',denynull = 'N',format = '',col_len = '25',field = 'packinglistnum',col_precision = '' where tablename = 'invoicelinked' AND field = 'packinglistnum'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(25)','N','invoicelinked','N','','25','packinglistnum','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'paymentexpiring')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'invoicelinked',denynull = 'N',format = '',col_len = '2',field = 'paymentexpiring',col_precision = '' where tablename = 'invoicelinked' AND field = 'paymentexpiring'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','invoicelinked','N','','2','paymentexpiring','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'invoicelinked',denynull = 'S',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'invoicelinked' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(100)','N','invoicelinked','S','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'registryreference')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'invoicelinked',denynull = 'N',format = '',col_len = '150',field = 'registryreference',col_precision = '' where tablename = 'invoicelinked' AND field = 'registryreference'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','invoicelinked','N','','150','registryreference','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'txt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'text',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'text',iskey = 'N',tablename = 'invoicelinked',denynull = 'N',format = '',col_len = '16',field = 'txt',col_precision = '' where tablename = 'invoicelinked' AND field = 'txt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','text','','S','System.String','text','N','invoicelinked','N','','16','txt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicelinked' AND field = 'yinv')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'invoicelinked',denynull = 'S',format = '',col_len = '2',field = 'yinv',col_precision = '' where tablename = 'invoicelinked' AND field = 'yinv'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','invoicelinked','S','','2','yinv','')
GO

-- VERIFICA DI invoicelinked IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'invoicelinked')
UPDATE customobject set isreal = 'N' where objectname = 'invoicelinked'
ELSE
INSERT INTO customobject (objectname, isreal) values('invoicelinked', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA invoiceresidualestimate
IF EXISTS(select * from sysobjects where id = object_id(N'[invoiceresidualestimate]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [invoiceresidualestimate]
GO





CREATE     VIEW [invoiceresidualestimate]
(
	idinvkind,
	codeinvkind,
	yinv,
	ninv,
	description,
	idreg,
	idupb,
	registry,
	taxabletotal,
	ivatotal,
	residual,
	linkedimpon,
	linkedimpos,
	linkeddocum,
	flag,
	flagbuysell,
	flagvariation,
	idinc_taxableestim,
	idinc_ivaestim,
	idestimkind,
	estimatekind,
	yestim,
	nestim,
	estimrownum,
	active,
	upb
)
	AS SELECT
	invoice.idinvkind,
	invoicekind.codeinvkind,
	invoice.yinv,
	invoice.ninv,
	invoice.description,
	invoice.idreg,
	invoicedetail.idupb,
	registry.title,
	CONVERT(DECIMAL(19,2),
		ISNULL(SUM(  ROUND(invoicedetail.taxable * invoicedetail.number * 
		     	     CONVERT(decimal(19,6),invoice.exchangerate) * 
		     	     (1 - CONVERT(decimal(19,6),ISNULL(invoicedetail.discount, 0.0))),2)
	   ),0)
	),
	CONVERT(DECIMAL(19,2),
		ISNULL(SUM(ROUND(invoicedetail.tax * CONVERT(decimal(19,6), invoice.exchangerate),2)
	   ),0)
	),
	-- residuo :somma dei dett. fattura non contabilizzati 
	-- oppure 0 se la fattura è di ACQUISTO contabilizzata con fondo economale
	-- (la contabilizzazione totale è obbligatoria in questo caso)
	CASE 
	WHEN ((invoicekind.flag&1)<>0) 
	THEN	CONVERT(DECIMAL(19,2),
			ISNULL(SUM(
			    CASE 
				WHEN (invoicedetail.idinc_taxable IS  NULL) AND (invoicedetail.idinc_iva IS  NOT NULL)
				THEN
				     ROUND(invoicedetail.taxable * invoicedetail.number * 
			     	     CONVERT(decimal(19,6),invoice.exchangerate) * 
			     	     (1 - CONVERT(decimal(19,6),ISNULL(invoicedetail.discount, 0.0))),2)
	
				WHEN (invoicedetail.idinc_iva IS NULL) AND (invoicedetail.idinc_taxable IS  NOT NULL)
				THEN
				    ROUND(invoicedetail.tax * CONVERT(decimal(19,6), invoice.exchangerate),2)
	
				WHEN (invoicedetail.idinc_iva IS  NULL) AND (invoicedetail.idinc_taxable IS  NULL)
				THEN
				     ROUND(invoicedetail.taxable * invoicedetail.number * 
			     	     CONVERT(decimal(19,6),invoice.exchangerate) * 
			     	     (1 - CONVERT(decimal(19,6),ISNULL(invoicedetail.discount, 0.0))),2) 
				     +
				     ROUND(invoicedetail.tax * CONVERT(decimal(19,6), invoice.exchangerate),2)
				ELSE   0
	
			    END
			   ),0)
			)
	END,
-- (mov.movkind = '3' )
	CONVERT(DECIMAL(19,2),
		ISNULL(SUM(
		    CASE 
			WHEN (((invoicekind.flag&1)<>0)  AND invoicedetail.idinc_taxable IS NOT NULL 
				AND (invoicedetail.idinc_iva IS NULL OR 
				invoicedetail.idinc_taxable<>invoicedetail.idinc_iva)) 
			THEN
			      ROUND(invoicedetail.taxable * invoicedetail.number * 
		     	     CONVERT(decimal(19,6),invoice.exchangerate) * 
		     	     (1 - CONVERT(decimal(19,6),ISNULL(invoicedetail.discount, 0.0))),2)
			ELSE   0
		    END
			
		   ),0)
		),

-- (mov.movkind = '2')
	CONVERT(DECIMAL(19,2),
		ISNULL(SUM(
		    CASE 
			WHEN (((invoicekind.flag&1)<>0)  AND invoicedetail.idinc_iva IS NOT NULL 
				AND  (invoicedetail.idinc_taxable IS NULL OR 
				invoicedetail.idinc_taxable<>invoicedetail.idinc_iva)) 
			THEN
			       ROUND(invoicedetail.tax * CONVERT(decimal(19,6), invoice.exchangerate),2)
			ELSE   0
		    END
			
		   ),0)
		),
	
--  (mov.movkind = '1' )
	CONVERT(DECIMAL(19,2),
		ISNULL(SUM(
		    CASE 
			WHEN (((invoicekind.flag&1)<>0)  AND invoicedetail.idinc_taxable IS NOT NULL 
				AND invoicedetail.idinc_iva= invoicedetail.idinc_taxable)
			THEN
	  		     ROUND(invoicedetail.taxable * invoicedetail.number * 
		     	     CONVERT(decimal(19,6),invoice.exchangerate) * 
		     	     (1 - CONVERT(decimal(19,6),ISNULL(invoicedetail.discount, 0.0))),2) 
			     +
			     ROUND(invoicedetail.tax * CONVERT(decimal(19,6), invoice.exchangerate),2)			
			ELSE   0
		    END
		   ),0)
		),
	invoicekind.flag,
	CASE
		WHEN ((invoicekind.flag&1)=0) THEN 'A'--flagbuysell
		WHEN ((invoicekind.flag&1)<>0) THEN 'V'
	END, 
	CASE
		WHEN ((invoicekind.flag&4)=0) THEN 'N'--flagvariation
		WHEN ((invoicekind.flag&4)<>0) THEN 'S'
	END, 

	estimatedetail.idinc_taxable,
	estimatedetail.idinc_iva,
	estimatedetail.idestimkind,
	estimatekind.description,
	estimatedetail.yestim,
	estimatedetail.nestim,
	estimatedetail.rownum,
	invoice.active,
	upb.title
	FROM invoicedetail (NOLOCK)
	JOIN invoice (NOLOCK)
  	ON invoicedetail.idinvkind = invoice.idinvkind
	AND invoicedetail.yinv = invoice.yinv
  	AND invoicedetail.ninv = invoice.ninv
	JOIN invoicekind (NOLOCK)
	ON invoicekind.idinvkind = invoice.idinvkind
	JOIN registry (NOLOCK)
	ON registry.idreg = invoice.idreg
	LEFT OUTER JOIN estimatekind
	ON estimatekind.idestimkind = invoicedetail.idestimkind
	LEFT OUTER JOIN upb
	on upb.idupb=invoicedetail.idupb
	LEFT OUTER JOIN estimatedetail
	ON  estimatedetail.idestimkind=invoicedetail.idestimkind 
	and estimatedetail.yestim=invoicedetail.yestim 
	and estimatedetail.nestim=invoicedetail.nestim
	and estimatedetail.rownum=invoicedetail.estimrownum
	GROUP BY invoice.idinvkind, invoicekind.codeinvkind,invoice.yinv, invoice.ninv,
	invoicedetail.idestimkind, invoicedetail.yestim, invoicedetail.nestim,
	estimatedetail.idinc_taxable,estimatedetail.idinc_iva,
	invoice.description,invoice.idreg,registry.title,invoicedetail.idupb,
	estimatedetail.idestimkind,estimatekind.description,estimatedetail.yestim,
	estimatedetail.nestim,estimatedetail.rownum,invoicekind.flag,
	(invoicekind.flag&1), (invoicekind.flag&4),invoice.active,upb.title

GO

-- VERIFICA DI invoiceresidualestimate IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'invoiceresidualestimate'
IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'active')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'N',format = '',col_len = '1',field = 'active',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'active'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','invoiceresidualestimate','N','','1','active','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'codeinvkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'S',format = '',col_len = '20',field = 'codeinvkind',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'codeinvkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','invoiceresidualestimate','S','','20','codeinvkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','invoiceresidualestimate','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'estimatekind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'N',format = '',col_len = '150',field = 'estimatekind',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'estimatekind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','invoiceresidualestimate','N','','150','estimatekind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'estimrownum')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'N',format = '',col_len = '4',field = 'estimrownum',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'estimrownum'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','invoiceresidualestimate','N','','4','estimrownum','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','invoiceresidualestimate','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'flagbuysell')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'N',format = '',col_len = '1',field = 'flagbuysell',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'flagbuysell'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','invoiceresidualestimate','N','','1','flagbuysell','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'flagvariation')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'N',format = '',col_len = '1',field = 'flagvariation',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'flagvariation'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','invoiceresidualestimate','N','','1','flagvariation','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'idestimkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'N',format = '',col_len = '20',field = 'idestimkind',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'idestimkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','invoiceresidualestimate','N','','20','idestimkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'idinc_ivaestim')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'N',format = '',col_len = '4',field = 'idinc_ivaestim',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'idinc_ivaestim'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','invoiceresidualestimate','N','','4','idinc_ivaestim','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'idinc_taxableestim')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'N',format = '',col_len = '4',field = 'idinc_taxableestim',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'idinc_taxableestim'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','invoiceresidualestimate','N','','4','idinc_taxableestim','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'idinvkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'S',format = '',col_len = '4',field = 'idinvkind',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'idinvkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','invoiceresidualestimate','S','','4','idinvkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'S',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','invoiceresidualestimate','S','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','invoiceresidualestimate','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'ivatotal')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'N',format = '',col_len = '9',field = 'ivatotal',col_precision = '19' where tablename = 'invoiceresidualestimate' AND field = 'ivatotal'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','invoiceresidualestimate','N','','9','ivatotal','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'linkeddocum')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'N',format = '',col_len = '9',field = 'linkeddocum',col_precision = '19' where tablename = 'invoiceresidualestimate' AND field = 'linkeddocum'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','invoiceresidualestimate','N','','9','linkeddocum','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'linkedimpon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'N',format = '',col_len = '9',field = 'linkedimpon',col_precision = '19' where tablename = 'invoiceresidualestimate' AND field = 'linkedimpon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','invoiceresidualestimate','N','','9','linkedimpon','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'linkedimpos')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'N',format = '',col_len = '9',field = 'linkedimpos',col_precision = '19' where tablename = 'invoiceresidualestimate' AND field = 'linkedimpos'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','invoiceresidualestimate','N','','9','linkedimpos','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'nestim')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'N',format = '',col_len = '4',field = 'nestim',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'nestim'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','invoiceresidualestimate','N','','4','nestim','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'ninv')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'S',format = '',col_len = '4',field = 'ninv',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'ninv'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','invoiceresidualestimate','S','','4','ninv','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'S',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(100)','N','invoiceresidualestimate','S','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'residual')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'N',format = '',col_len = '9',field = 'residual',col_precision = '19' where tablename = 'invoiceresidualestimate' AND field = 'residual'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','invoiceresidualestimate','N','','9','residual','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'taxabletotal')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'N',format = '',col_len = '9',field = 'taxabletotal',col_precision = '19' where tablename = 'invoiceresidualestimate' AND field = 'taxabletotal'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','invoiceresidualestimate','N','','9','taxabletotal','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','invoiceresidualestimate','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'yestim')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'N',format = '',col_len = '2',field = 'yestim',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'yestim'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','invoiceresidualestimate','N','','2','yestim','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoiceresidualestimate' AND field = 'yinv')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'invoiceresidualestimate',denynull = 'S',format = '',col_len = '2',field = 'yinv',col_precision = '' where tablename = 'invoiceresidualestimate' AND field = 'yinv'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','invoiceresidualestimate','S','','2','yinv','')
GO

-- VERIFICA DI invoiceresidualestimate IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'invoiceresidualestimate')
UPDATE customobject set isreal = 'N' where objectname = 'invoiceresidualestimate'
ELSE
INSERT INTO customobject (objectname, isreal) values('invoiceresidualestimate', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA itinerationavailable
IF EXISTS(select * from sysobjects where id = object_id(N'[itinerationavailable]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [itinerationavailable]
GO


CREATE  VIEW [itinerationavailable]
	(
	iditineration,
	yitineration,
	nitineration,
	description,
	idreg,
	registry,
	start,
	stop,
	totalgross,
	totadvance,
	active
	)
	AS SELECT
	itineration.iditineration,
	itineration.yitineration,
	itineration.nitineration,
	itineration.description,
	itineration.idreg,
	registry.title,
	itineration.start,
	itineration.stop,
	itineration.totalgross,
	itineration.totadvance,
	itineration.active
	FROM itineration (NOLOCK)
	JOIN registry (NOLOCK)
	ON registry.idreg = itineration.idreg
	WHERE itineration.totalgross >
		ISNULL(
		(SELECT SUM(expenseyear_starting.amount)  
		FROM expenseitineration mov
		JOIN expense s
		ON s.idexp = mov.idexp
		LEFT OUTER JOIN expensetotal expensetotal_firstyear(NOLOCK)
  			ON expensetotal_firstyear.idexp = s.idexp
  			AND ((expensetotal_firstyear.flag & 2) <> 0 )
		LEFT OUTER JOIN expenseyear expenseyear_starting(NOLOCK) 
			ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
  			AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
		WHERE mov.iditineration = itineration.iditineration
		AND (mov.movkind = 4 OR mov.movkind = 6)
		)
	,0) +
	ISNULL(
		(SELECT SUM(v.amount)
		FROM expenseitineration mov
		JOIN expense s
		ON s.idexp = mov.idexp
		JOIN expensevar v
		ON v.idexp = mov.idexp
		WHERE mov.iditineration = itineration.iditineration
		AND (mov.movkind = 4 OR mov.movkind = 6)
		AND (ISNULL(v.autokind,'')<>4)
		)
	,0) +
	ISNULL(
		(SELECT SUM(p.amount)
		FROM pettycashoperationitineration mov
		JOIN pettycashoperation p
		ON mov.idpettycash = p.idpettycash
		AND mov.yoperation = p.yoperation
		AND mov.noperation = p.noperation
		WHERE mov.iditineration = itineration.iditineration
		AND mov.movkind = 6)
	,0)

GO

-- VERIFICA DI itinerationavailable IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'itinerationavailable'
IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationavailable' AND field = 'active')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'itinerationavailable',denynull = 'N',format = '',col_len = '1',field = 'active',col_precision = '' where tablename = 'itinerationavailable' AND field = 'active'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','itinerationavailable','N','','1','active','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationavailable' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'itinerationavailable',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'itinerationavailable' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','itinerationavailable','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationavailable' AND field = 'iditineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationavailable',denynull = 'S',format = '',col_len = '4',field = 'iditineration',col_precision = '' where tablename = 'itinerationavailable' AND field = 'iditineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationavailable','S','','4','iditineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationavailable' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationavailable',denynull = 'S',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'itinerationavailable' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationavailable','S','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationavailable' AND field = 'nitineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationavailable',denynull = 'S',format = '',col_len = '4',field = 'nitineration',col_precision = '' where tablename = 'itinerationavailable' AND field = 'nitineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationavailable','S','','4','nitineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationavailable' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'itinerationavailable',denynull = 'S',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'itinerationavailable' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(100)','N','itinerationavailable','S','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationavailable' AND field = 'start')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'itinerationavailable',denynull = 'S',format = '',col_len = '4',field = 'start',col_precision = '' where tablename = 'itinerationavailable' AND field = 'start'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','itinerationavailable','S','','4','start','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationavailable' AND field = 'stop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'itinerationavailable',denynull = 'S',format = '',col_len = '4',field = 'stop',col_precision = '' where tablename = 'itinerationavailable' AND field = 'stop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','itinerationavailable','S','','4','stop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationavailable' AND field = 'totadvance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'itinerationavailable',denynull = 'N',format = '',col_len = '9',field = 'totadvance',col_precision = '19' where tablename = 'itinerationavailable' AND field = 'totadvance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','itinerationavailable','N','','9','totadvance','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationavailable' AND field = 'totalgross')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'itinerationavailable',denynull = 'N',format = '',col_len = '9',field = 'totalgross',col_precision = '19' where tablename = 'itinerationavailable' AND field = 'totalgross'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','itinerationavailable','N','','9','totalgross','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationavailable' AND field = 'yitineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'itinerationavailable',denynull = 'S',format = '',col_len = '2',field = 'yitineration',col_precision = '' where tablename = 'itinerationavailable' AND field = 'yitineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','itinerationavailable','S','','2','yitineration','')
GO

-- VERIFICA DI itinerationavailable IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'itinerationavailable')
UPDATE customobject set isreal = 'N' where objectname = 'itinerationavailable'
ELSE
INSERT INTO customobject (objectname, isreal) values('itinerationavailable', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA itinerationlapview
IF EXISTS(select * from sysobjects where id = object_id(N'[itinerationlapview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [itinerationlapview]
GO


CREATE  VIEW itinerationlapview 
(
	iditineration,
	yitineration,
	nitineration,
	lapnumber,
	idforeigncountry,
	codeforeigncountry,
	location,
	flagitalian,
	description,
	starttime,
	stoptime,
	days,
	hours,
	idreduction,
	reduction,
	allowance,
	advancepercentage,
	ancereductionpercentage,
	cu, ct, lu, lt
)
AS SELECT
	itinerationlap.iditineration,
	itineration.yitineration,
	itineration.nitineration,
	itinerationlap.lapnumber,
	itinerationlap.idforeigncountry,
	foreigncountry.codeforeigncountry,
	foreigncountry.description,
	itinerationlap.flagitalian,
	itinerationlap.description,
	itinerationlap.starttime,
	itinerationlap.stoptime,
	itinerationlap.days,
	itinerationlap.hours,
	itinerationlap.idreduction,
	reduction.description,
	itinerationlap.allowance, 
	itinerationlap.advancepercentage, 
	itinerationlap.reductionpercentage,
	itinerationlap.cu, itinerationlap.ct, itinerationlap.lu, itinerationlap.lt
FROM itinerationlap
JOIN itineration
ON itineration.iditineration = itinerationlap.iditineration
LEFT OUTER JOIN foreigncountry
ON foreigncountry.idforeigncountry = itinerationlap.idforeigncountry
LEFT OUTER JOIN reduction
ON reduction.idreduction = itinerationlap.idreduction


GO

-- VERIFICA DI itinerationlapview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'itinerationlapview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'advancepercentage')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '8',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,8)',iskey = 'N',tablename = 'itinerationlapview',denynull = 'N',format = '',col_len = '9',field = 'advancepercentage',col_precision = '19' where tablename = 'itinerationlapview' AND field = 'advancepercentage'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','8','decimal','','S','System.Decimal','decimal(19,8)','N','itinerationlapview','N','','9','advancepercentage','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'allowance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'itinerationlapview',denynull = 'N',format = '',col_len = '9',field = 'allowance',col_precision = '19' where tablename = 'itinerationlapview' AND field = 'allowance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','itinerationlapview','N','','9','allowance','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'ancereductionpercentage')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '8',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,8)',iskey = 'N',tablename = 'itinerationlapview',denynull = 'N',format = '',col_len = '9',field = 'ancereductionpercentage',col_precision = '19' where tablename = 'itinerationlapview' AND field = 'ancereductionpercentage'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','8','decimal','','S','System.Decimal','decimal(19,8)','N','itinerationlapview','N','','9','ancereductionpercentage','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'codeforeigncountry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'itinerationlapview',denynull = 'N',format = '',col_len = '20',field = 'codeforeigncountry',col_precision = '' where tablename = 'itinerationlapview' AND field = 'codeforeigncountry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','itinerationlapview','N','','20','codeforeigncountry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'itinerationlapview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'itinerationlapview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','itinerationlapview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'itinerationlapview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'itinerationlapview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','itinerationlapview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'days')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'float',defaultvalue = '',allownull = 'N',systemtype = 'System.Double',sqldeclaration = 'float',iskey = 'N',tablename = 'itinerationlapview',denynull = 'S',format = '',col_len = '8',field = 'days',col_precision = '' where tablename = 'itinerationlapview' AND field = 'days'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','float','','N','System.Double','float','N','itinerationlapview','S','','8','days','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'itinerationlapview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'itinerationlapview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','itinerationlapview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'flagitalian')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'itinerationlapview',denynull = 'S',format = '',col_len = '1',field = 'flagitalian',col_precision = '' where tablename = 'itinerationlapview' AND field = 'flagitalian'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','N','System.String','char(1)','N','itinerationlapview','S','','1','flagitalian','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'hours')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'float',defaultvalue = '',allownull = 'N',systemtype = 'System.Double',sqldeclaration = 'float',iskey = 'N',tablename = 'itinerationlapview',denynull = 'S',format = '',col_len = '8',field = 'hours',col_precision = '' where tablename = 'itinerationlapview' AND field = 'hours'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','float','','N','System.Double','float','N','itinerationlapview','S','','8','hours','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'idforeigncountry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationlapview',denynull = 'N',format = '',col_len = '4',field = 'idforeigncountry',col_precision = '' where tablename = 'itinerationlapview' AND field = 'idforeigncountry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','itinerationlapview','N','','4','idforeigncountry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'iditineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationlapview',denynull = 'S',format = '',col_len = '4',field = 'iditineration',col_precision = '' where tablename = 'itinerationlapview' AND field = 'iditineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationlapview','S','','4','iditineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'idreduction')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'itinerationlapview',denynull = 'N',format = '',col_len = '20',field = 'idreduction',col_precision = '' where tablename = 'itinerationlapview' AND field = 'idreduction'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','itinerationlapview','N','','20','idreduction','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'lapnumber')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'itinerationlapview',denynull = 'S',format = '',col_len = '2',field = 'lapnumber',col_precision = '' where tablename = 'itinerationlapview' AND field = 'lapnumber'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','itinerationlapview','S','','2','lapnumber','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'location')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'itinerationlapview',denynull = 'N',format = '',col_len = '50',field = 'location',col_precision = '' where tablename = 'itinerationlapview' AND field = 'location'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','itinerationlapview','N','','50','location','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'itinerationlapview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'itinerationlapview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','itinerationlapview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'itinerationlapview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'itinerationlapview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','itinerationlapview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'nitineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationlapview',denynull = 'S',format = '',col_len = '4',field = 'nitineration',col_precision = '' where tablename = 'itinerationlapview' AND field = 'nitineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationlapview','S','','4','nitineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'reduction')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'itinerationlapview',denynull = 'N',format = '',col_len = '50',field = 'reduction',col_precision = '' where tablename = 'itinerationlapview' AND field = 'reduction'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','itinerationlapview','N','','50','reduction','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'starttime')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'itinerationlapview',denynull = 'N',format = '',col_len = '4',field = 'starttime',col_precision = '' where tablename = 'itinerationlapview' AND field = 'starttime'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','itinerationlapview','N','','4','starttime','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'stoptime')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'itinerationlapview',denynull = 'N',format = '',col_len = '4',field = 'stoptime',col_precision = '' where tablename = 'itinerationlapview' AND field = 'stoptime'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','itinerationlapview','N','','4','stoptime','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlapview' AND field = 'yitineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'itinerationlapview',denynull = 'S',format = '',col_len = '2',field = 'yitineration',col_precision = '' where tablename = 'itinerationlapview' AND field = 'yitineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','itinerationlapview','S','','2','yitineration','')
GO

-- VERIFICA DI itinerationlapview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'itinerationlapview')
UPDATE customobject set isreal = 'N' where objectname = 'itinerationlapview'
ELSE
INSERT INTO customobject (objectname, isreal) values('itinerationlapview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA itinerationlinked
IF EXISTS(select * from sysobjects where id = object_id(N'[itinerationlinked]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [itinerationlinked]
GO


CREATE  VIEW [itinerationlinked]
(
	ayear,
	idreg, registry,
	idser, service, codeser,
	iditineration,yitineration, nitineration,
	description,
	authorizationdate, start, stop, adate,
	admincarkmcost, owncarkmcost, footkmcost,
	admincarkm, owncarkm, footkm, 
	grossfactor,
	netfee, 
	totalgross,
	total,
	totadvance,
	idupb,
	codeupb,
	upb,
	idsor1,
	idsor2,
	idsor3,
	idaccmotive,
	codemotive,
	txt, rtf,
	ct, cu, lu, lt
)
AS
SELECT 
	accountingyear.ayear,
	itineration.idreg, registry.title,
	itineration.idser, service.description, service.codeser,
	itineration.iditineration,itineration.yitineration, itineration.nitineration,
	itineration.description,
	itineration.authorizationdate, itineration.start, itineration.stop, itineration.adate,
	itineration.admincarkmcost, itineration.owncarkmcost, itineration.footkmcost,
	itineration.admincarkm, itineration.owncarkm, itineration.footkm, 
	itineration.grossfactor,
	itineration.netfee, 
	itineration.totalgross,
	itineration.total,
	itineration.totadvance,
	itineration.idupb,
	upb.codeupb,
	upb.title,
	itineration.idsor1,
	itineration.idsor2,
	itineration.idsor3,
	itineration.idaccmotive,
	accmotive.codemotive,
	itineration.txt, itineration.rtf,
	itineration.ct, itineration.cu, itineration.lu, itineration.lt
FROM itineration
INNER JOIN expenseitineration WITH (NOLOCK)
ON itineration.iditineration = expenseitineration.iditineration
CROSS JOIN accountingyear
JOIN registry
	ON itineration.idreg = registry.idreg 
JOIN service
	ON service.idser = itineration.idser  
LEFT OUTER JOIN upb
	ON upb.idupb = itineration.idupb
LEFT OUTER JOIN accmotive
	ON accmotive.idaccmotive = itineration.idaccmotive
WHERE EXISTS (SELECT * 
		FROM expenseitineration AS  MM 
		JOIN expenseyear AS II
		ON   II.idexp=MM.idexp
		AND  MM.iditineration=itineration.iditineration
		WHERE II.ayear = accountingyear.ayear
)


GO

-- VERIFICA DI itinerationlinked IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'itinerationlinked'
IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'itinerationlinked',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'itinerationlinked' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','itinerationlinked','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'admincarkm')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'float',defaultvalue = '',allownull = 'S',systemtype = 'System.Double',sqldeclaration = 'float',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '8',field = 'admincarkm',col_precision = '' where tablename = 'itinerationlinked' AND field = 'admincarkm'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','float','','S','System.Double','float','N','itinerationlinked','N','','8','admincarkm','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'admincarkmcost')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '9',field = 'admincarkmcost',col_precision = '19' where tablename = 'itinerationlinked' AND field = 'admincarkmcost'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','itinerationlinked','N','','9','admincarkmcost','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'authorizationdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'itinerationlinked',denynull = 'S',format = '',col_len = '4',field = 'authorizationdate',col_precision = '' where tablename = 'itinerationlinked' AND field = 'authorizationdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','itinerationlinked','S','','4','authorizationdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'itinerationlinked',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'itinerationlinked' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','itinerationlinked','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'codemotive')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '50',field = 'codemotive',col_precision = '' where tablename = 'itinerationlinked' AND field = 'codemotive'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','itinerationlinked','N','','50','codemotive','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'codeser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'itinerationlinked',denynull = 'S',format = '',col_len = '20',field = 'codeser',col_precision = '' where tablename = 'itinerationlinked' AND field = 'codeser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','itinerationlinked','S','','20','codeser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'itinerationlinked' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','itinerationlinked','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'itinerationlinked',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'itinerationlinked' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','itinerationlinked','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'itinerationlinked',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'itinerationlinked' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','itinerationlinked','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'itinerationlinked',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'itinerationlinked' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','itinerationlinked','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'footkm')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'float',defaultvalue = '',allownull = 'S',systemtype = 'System.Double',sqldeclaration = 'float',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '8',field = 'footkm',col_precision = '' where tablename = 'itinerationlinked' AND field = 'footkm'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','float','','S','System.Double','float','N','itinerationlinked','N','','8','footkm','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'footkmcost')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '9',field = 'footkmcost',col_precision = '19' where tablename = 'itinerationlinked' AND field = 'footkmcost'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','itinerationlinked','N','','9','footkmcost','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'grossfactor')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'float',defaultvalue = '',allownull = 'S',systemtype = 'System.Double',sqldeclaration = 'float',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '8',field = 'grossfactor',col_precision = '' where tablename = 'itinerationlinked' AND field = 'grossfactor'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','float','','S','System.Double','float','N','itinerationlinked','N','','8','grossfactor','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'idaccmotive')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '36',field = 'idaccmotive',col_precision = '' where tablename = 'itinerationlinked' AND field = 'idaccmotive'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','itinerationlinked','N','','36','idaccmotive','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'iditineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationlinked',denynull = 'S',format = '',col_len = '4',field = 'iditineration',col_precision = '' where tablename = 'itinerationlinked' AND field = 'iditineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationlinked','S','','4','iditineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationlinked',denynull = 'S',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'itinerationlinked' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationlinked','S','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationlinked',denynull = 'S',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'itinerationlinked' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationlinked','S','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'idsor1')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '4',field = 'idsor1',col_precision = '' where tablename = 'itinerationlinked' AND field = 'idsor1'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','itinerationlinked','N','','4','idsor1','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'idsor2')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '4',field = 'idsor2',col_precision = '' where tablename = 'itinerationlinked' AND field = 'idsor2'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','itinerationlinked','N','','4','idsor2','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'idsor3')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '4',field = 'idsor3',col_precision = '' where tablename = 'itinerationlinked' AND field = 'idsor3'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','itinerationlinked','N','','4','idsor3','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'itinerationlinked' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','itinerationlinked','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'itinerationlinked',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'itinerationlinked' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','itinerationlinked','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'itinerationlinked',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'itinerationlinked' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','itinerationlinked','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'netfee')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '9',field = 'netfee',col_precision = '19' where tablename = 'itinerationlinked' AND field = 'netfee'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','itinerationlinked','N','','9','netfee','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'nitineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationlinked',denynull = 'S',format = '',col_len = '4',field = 'nitineration',col_precision = '' where tablename = 'itinerationlinked' AND field = 'nitineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationlinked','S','','4','nitineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'owncarkm')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'float',defaultvalue = '',allownull = 'S',systemtype = 'System.Double',sqldeclaration = 'float',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '8',field = 'owncarkm',col_precision = '' where tablename = 'itinerationlinked' AND field = 'owncarkm'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','float','','S','System.Double','float','N','itinerationlinked','N','','8','owncarkm','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'owncarkmcost')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '9',field = 'owncarkmcost',col_precision = '19' where tablename = 'itinerationlinked' AND field = 'owncarkmcost'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','itinerationlinked','N','','9','owncarkmcost','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'itinerationlinked',denynull = 'S',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'itinerationlinked' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(100)','N','itinerationlinked','S','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'rtf')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'image',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte[]',sqldeclaration = 'image',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '16',field = 'rtf',col_precision = '' where tablename = 'itinerationlinked' AND field = 'rtf'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','image','','S','System.Byte[]','image','N','itinerationlinked','N','','16','rtf','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'itinerationlinked',denynull = 'S',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'itinerationlinked' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','itinerationlinked','S','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'start')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'itinerationlinked',denynull = 'S',format = '',col_len = '4',field = 'start',col_precision = '' where tablename = 'itinerationlinked' AND field = 'start'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','itinerationlinked','S','','4','start','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'stop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'itinerationlinked',denynull = 'S',format = '',col_len = '4',field = 'stop',col_precision = '' where tablename = 'itinerationlinked' AND field = 'stop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','itinerationlinked','S','','4','stop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'totadvance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '9',field = 'totadvance',col_precision = '19' where tablename = 'itinerationlinked' AND field = 'totadvance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','itinerationlinked','N','','9','totadvance','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'total')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '9',field = 'total',col_precision = '19' where tablename = 'itinerationlinked' AND field = 'total'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','itinerationlinked','N','','9','total','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'totalgross')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '9',field = 'totalgross',col_precision = '19' where tablename = 'itinerationlinked' AND field = 'totalgross'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','itinerationlinked','N','','9','totalgross','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'txt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'text',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'text',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '16',field = 'txt',col_precision = '' where tablename = 'itinerationlinked' AND field = 'txt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','text','','S','System.String','text','N','itinerationlinked','N','','16','txt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'itinerationlinked',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'itinerationlinked' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','itinerationlinked','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationlinked' AND field = 'yitineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'itinerationlinked',denynull = 'S',format = '',col_len = '2',field = 'yitineration',col_precision = '' where tablename = 'itinerationlinked' AND field = 'yitineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','itinerationlinked','S','','2','yitineration','')
GO

-- VERIFICA DI itinerationlinked IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'itinerationlinked')
UPDATE customobject set isreal = 'N' where objectname = 'itinerationlinked'
ELSE
INSERT INTO customobject (objectname, isreal) values('itinerationlinked', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA itinerationrefundview
IF EXISTS(select * from sysobjects where id = object_id(N'[itinerationrefundview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [itinerationrefundview]
GO


CREATE  VIEW itinerationrefundview 
(
	iditineration,
	yitineration,
	nitineration,
	nrefund,
	idcurrency,
	codecurrency,
	currency,
	iditinerationrefundkind,
	codeitinerationrefundkind,
	itinerationrefundkind,
	iditinerationrefundkindgroup,
	itinerationrefundkindgroup,
	description,
	amount,
	exchangerate,
	extraallowance,
	advancepercentage,
	starttime,
	stoptime,
	flagitalian,
	cu, 
	ct, 
	lu, 
	lt
)
AS SELECT
	itinerationrefund.iditineration,
	itineration.yitineration,
	itineration.nitineration,
	itinerationrefund.nrefund,
	itinerationrefund.idcurrency,
	currency.codecurrency,
	currency.description,
	itinerationrefund.iditinerationrefundkind,
	itinerationrefundkind.codeitinerationrefundkind,
	itinerationrefundkind.description,
	itinerationrefundkindgroup.iditinerationrefundkindgroup,
	itinerationrefundkindgroup.description,
	itinerationrefund.description,
	itinerationrefund.amount,
	itinerationrefund.exchangerate,
	itinerationrefund.extraallowance,
	itinerationrefund.advancepercentage,
	itinerationrefund.starttime,
	itinerationrefund.stoptime,
	itinerationrefund.flag_geo,
	itinerationrefund.cu, 
	itinerationrefund.ct, 
	itinerationrefund.lu, 
	itinerationrefund.lt
FROM itinerationrefund
JOIN itineration
	ON itineration.iditineration = itinerationrefund.iditineration
LEFT OUTER JOIN currency
	ON currency.idcurrency = itinerationrefund.idcurrency
LEFT OUTER JOIN itinerationrefundkind
	ON itinerationrefundkind.iditinerationrefundkind = itinerationrefund.iditinerationrefundkind
LEFT OUTER JOIN itinerationrefundkindgroup
	ON itinerationrefundkindgroup.iditinerationrefundkindgroup = itinerationrefundkind.iditinerationrefundkindgroup


GO

-- VERIFICA DI itinerationrefundview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'itinerationrefundview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'advancepercentage')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '8',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,8)',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'N',format = '',col_len = '9',field = 'advancepercentage',col_precision = '19' where tablename = 'itinerationrefundview' AND field = 'advancepercentage'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','8','decimal','','S','System.Decimal','decimal(19,8)','N','itinerationrefundview','N','','9','advancepercentage','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'itinerationrefundview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','itinerationrefundview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'codecurrency')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'N',format = '',col_len = '20',field = 'codecurrency',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'codecurrency'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','itinerationrefundview','N','','20','codecurrency','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'codeitinerationrefundkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'N',format = '',col_len = '20',field = 'codeitinerationrefundkind',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'codeitinerationrefundkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','itinerationrefundview','N','','20','codeitinerationrefundkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','itinerationrefundview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','itinerationrefundview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'currency')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'N',format = '',col_len = '50',field = 'currency',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'currency'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','itinerationrefundview','N','','50','currency','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','itinerationrefundview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'exchangerate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'float',defaultvalue = '',allownull = 'S',systemtype = 'System.Double',sqldeclaration = 'float',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'N',format = '',col_len = '8',field = 'exchangerate',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'exchangerate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','float','','S','System.Double','float','N','itinerationrefundview','N','','8','exchangerate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'extraallowance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'N',format = '',col_len = '9',field = 'extraallowance',col_precision = '19' where tablename = 'itinerationrefundview' AND field = 'extraallowance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','itinerationrefundview','N','','9','extraallowance','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'flagitalian')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'N',format = '',col_len = '1',field = 'flagitalian',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'flagitalian'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','itinerationrefundview','N','','1','flagitalian','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'idcurrency')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'N',format = '',col_len = '4',field = 'idcurrency',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'idcurrency'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','itinerationrefundview','N','','4','idcurrency','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'iditineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'S',format = '',col_len = '4',field = 'iditineration',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'iditineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationrefundview','S','','4','iditineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'iditinerationrefundkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'N',format = '',col_len = '4',field = 'iditinerationrefundkind',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'iditinerationrefundkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','itinerationrefundview','N','','4','iditinerationrefundkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'iditinerationrefundkindgroup')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'N',format = '',col_len = '4',field = 'iditinerationrefundkindgroup',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'iditinerationrefundkindgroup'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','itinerationrefundview','N','','4','iditinerationrefundkindgroup','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'itinerationrefundkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'N',format = '',col_len = '150',field = 'itinerationrefundkind',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'itinerationrefundkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','itinerationrefundview','N','','150','itinerationrefundkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'itinerationrefundkindgroup')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'N',format = '',col_len = '100',field = 'itinerationrefundkindgroup',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'itinerationrefundkindgroup'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','itinerationrefundview','N','','100','itinerationrefundkindgroup','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','itinerationrefundview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','itinerationrefundview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'nitineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'S',format = '',col_len = '4',field = 'nitineration',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'nitineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationrefundview','S','','4','nitineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'nrefund')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'S',format = '',col_len = '2',field = 'nrefund',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'nrefund'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','itinerationrefundview','S','','2','nrefund','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'starttime')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'N',format = '',col_len = '8',field = 'starttime',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'starttime'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','itinerationrefundview','N','','8','starttime','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'stoptime')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'N',format = '',col_len = '8',field = 'stoptime',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'stoptime'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','itinerationrefundview','N','','8','stoptime','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationrefundview' AND field = 'yitineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'itinerationrefundview',denynull = 'S',format = '',col_len = '2',field = 'yitineration',col_precision = '' where tablename = 'itinerationrefundview' AND field = 'yitineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','itinerationrefundview','S','','2','yitineration','')
GO

-- VERIFICA DI itinerationrefundview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'itinerationrefundview')
UPDATE customobject set isreal = 'N' where objectname = 'itinerationrefundview'
ELSE
INSERT INTO customobject (objectname, isreal) values('itinerationrefundview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA itinerationresidual
IF EXISTS(select * from sysobjects where id = object_id(N'[itinerationresidual]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [itinerationresidual]
GO


CREATE     VIEW [itinerationresidual]
	(
	iditineration,
	yitineration,
	nitineration,
	description,
	idreg,
	registry,
	start,
	stop,
	totalgross,
	totadvance,
	residual,
	linkedsaldo,
	linkedangir,
	linkedanpag,
	active,
	completed,
	idupb,
	codeupb,
	upb,
	idaccmotive,
	codemotive,
	idsor1,
	idsor2,
	idsor3
)
	AS SELECT
	itineration.iditineration,
	itineration.yitineration,
	itineration.nitineration,
	itineration.description,
	itineration.idreg,
	registry.title,
	itineration.start,      
	itineration.stop,
	itineration.totalgross,
	itineration.totadvance,
	--residual
	CONVERT(decimal(23,6),itineration.totalgross -
		(
		ISNULL(	
			(SELECT SUM(expenseyear_starting.amount)
			FROM expenseitineration mov
			JOIN expense s
			ON s.idexp = mov.idexp
			LEFT OUTER JOIN expensetotal expensetotal_firstyear(NOLOCK)
  				ON expensetotal_firstyear.idexp = s.idexp
  				AND ((expensetotal_firstyear.flag & 2) <> 0 )
			LEFT OUTER JOIN expenseyear expenseyear_starting(NOLOCK) 
				ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
  				AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
			WHERE mov.iditineration = itineration.iditineration
			AND ((mov.movkind = 4)OR(mov.movkind = 6))
			--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
			)
		,0) +
		ISNULL(
			(SELECT SUM(v.amount)
			FROM expenseitineration mov
			JOIN expense s
			ON s.idexp = mov.idexp
			LEFT OUTER JOIN expensevar v
			ON (v.idexp = mov.idexp)
			WHERE mov.iditineration = itineration.iditineration
			AND ( (mov.movkind = 4 )OR(mov.movkind = 6 ))
			AND (ISNULL(v.autokind,0)<> 4) --'RITEN')
			--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
			)
		,0) +
		ISNULL(
			(SELECT SUM(p.amount)
			FROM pettycashoperationitineration mov
			JOIN pettycashoperation p
			ON mov.idpettycash = p.idpettycash
			AND mov.yoperation = p.yoperation
			AND mov.noperation = p.noperation
			WHERE mov.iditineration = itineration.iditineration
			AND mov.movkind = 6 )
			
		,0)
		)
	),
	--linkedsaldo
	CONVERT(decimal(23,6),
		(
		ISNULL(	
			(SELECT SUM(expenseyear_starting.amount)
			FROM expenseitineration mov
			JOIN expense s
			ON s.idexp = mov.idexp
			LEFT OUTER JOIN expensetotal expensetotal_firstyear(NOLOCK)
  				ON expensetotal_firstyear.idexp = s.idexp
  				AND ((expensetotal_firstyear.flag & 2) <> 0 )
			LEFT OUTER JOIN expenseyear expenseyear_starting(NOLOCK) 
				ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
  				AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
			WHERE mov.iditineration = itineration.iditineration
			AND (mov.movkind = 4)
			--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
			)
		,0) +
		ISNULL(
			(SELECT SUM(v.amount)
			FROM expenseitineration mov
			JOIN expense s
			ON s.idexp = mov.idexp
			LEFT OUTER JOIN expensevar v
			ON v.idexp = mov.idexp
			WHERE mov.iditineration = itineration.iditineration
			AND (mov.movkind = 4)
			AND (ISNULL(v.autokind,0)<>4) --'RITEN')
			--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
			)
		,0)
		)
	) ,
	--linkedangir
	CONVERT(decimal(23,6),
		(
		ISNULL(
			(SELECT SUM(expenseyear_starting.amount)
			FROM expenseitineration mov
			JOIN expense s
			ON s.idexp = mov.idexp
			LEFT OUTER JOIN expensetotal expensetotal_firstyear(NOLOCK)
  				ON expensetotal_firstyear.idexp = s.idexp
  				AND ((expensetotal_firstyear.flag & 2) <> 0 )
			LEFT OUTER JOIN expenseyear expenseyear_starting(NOLOCK) 
				ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
  				AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
			WHERE mov.iditineration = itineration.iditineration
			AND (mov.movkind = 6)
			--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
			)
		,0) +
		ISNULL(
			(SELECT SUM(v.amount)
			FROM expenseitineration mov
			JOIN expense s
			ON s.idexp = mov.idexp
			LEFT OUTER JOIN expensevar v
			ON v.idexp = mov.idexp
			WHERE mov.iditineration = itineration.iditineration
			AND (mov.movkind = 6 )
			AND (ISNULL(v.autokind,0)<>4 ) --'RITEN')
			--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
			)
		,0) +
		ISNULL(
			(SELECT SUM(p.amount)
			FROM pettycashoperationitineration mov
			JOIN pettycashoperation p
			ON mov.idpettycash = p.idpettycash
			AND mov.yoperation = p.yoperation
			AND mov.noperation = p.noperation
			WHERE mov.iditineration = itineration.iditineration
			AND mov.movkind = 6)
		,0)
		)
	),
	--linkedanpag
	CONVERT(decimal(23,6),
		(
		ISNULL(
			(SELECT SUM(expenseyear_starting.amount)
			FROM expenseitineration mov
			JOIN expense s
			ON s.idexp = mov.idexp
			LEFT OUTER JOIN expensetotal expensetotal_firstyear(NOLOCK)
  				ON expensetotal_firstyear.idexp = s.idexp
  				AND ((expensetotal_firstyear.flag & 2) <> 0 )
			LEFT OUTER JOIN expenseyear expenseyear_starting(NOLOCK) 
				ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
  				AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
			WHERE mov.iditineration = itineration.iditineration
			AND (mov.movkind = 6)
			--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
			)
		,0) +
		ISNULL(
			(SELECT SUM(v.amount)
			FROM expenseitineration mov
			JOIN expense s
			ON s.idexp = mov.idexp
			LEFT OUTER JOIN expensevar v
			ON v.idexp = mov.idexp
			WHERE mov.iditineration = itineration.iditineration
			AND (mov.movkind = 6 )
			AND (ISNULL(v.autokind,0)<>4) --'RITEN')
			--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
			)
		,0) +
		ISNULL(
			(SELECT SUM(p.amount)
			FROM pettycashoperationitineration mov
			JOIN pettycashoperation p
			ON mov.idpettycash = p.idpettycash
			AND mov.yoperation = p.yoperation
			AND mov.noperation = p.noperation
			WHERE mov.iditineration = itineration.iditineration
			AND mov.movkind = 6)
		,0)
		)
	),
	itineration.active,
	itineration.completed,
	itineration.idupb,
	upb.codeupb,
	upb.title,
	itineration.idaccmotive,
	accmotive.codemotive,
	itineration.idsor1,
	itineration.idsor2,
	itineration.idsor3
	FROM itineration (NOLOCK)
	JOIN registry (NOLOCK)
	ON registry.idreg = itineration.idreg
	LEFT OUTER JOIN upb
	ON upb.idupb = itineration.idupb
	LEFT OUTER JOIN accmotive
	ON accmotive.idaccmotive = itineration.idaccmotive

GO

-- VERIFICA DI itinerationresidual IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'itinerationresidual'
IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'active')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'itinerationresidual',denynull = 'N',format = '',col_len = '1',field = 'active',col_precision = '' where tablename = 'itinerationresidual' AND field = 'active'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','itinerationresidual','N','','1','active','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'codemotive')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'itinerationresidual',denynull = 'N',format = '',col_len = '50',field = 'codemotive',col_precision = '' where tablename = 'itinerationresidual' AND field = 'codemotive'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','itinerationresidual','N','','50','codemotive','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'itinerationresidual',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'itinerationresidual' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','itinerationresidual','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'completed')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'itinerationresidual',denynull = 'N',format = '',col_len = '1',field = 'completed',col_precision = '' where tablename = 'itinerationresidual' AND field = 'completed'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','itinerationresidual','N','','1','completed','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'itinerationresidual',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'itinerationresidual' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','itinerationresidual','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'idaccmotive')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'itinerationresidual',denynull = 'N',format = '',col_len = '36',field = 'idaccmotive',col_precision = '' where tablename = 'itinerationresidual' AND field = 'idaccmotive'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','itinerationresidual','N','','36','idaccmotive','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'iditineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationresidual',denynull = 'S',format = '',col_len = '4',field = 'iditineration',col_precision = '' where tablename = 'itinerationresidual' AND field = 'iditineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationresidual','S','','4','iditineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationresidual',denynull = 'S',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'itinerationresidual' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationresidual','S','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'idsor1')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationresidual',denynull = 'N',format = '',col_len = '4',field = 'idsor1',col_precision = '' where tablename = 'itinerationresidual' AND field = 'idsor1'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','itinerationresidual','N','','4','idsor1','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'idsor2')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationresidual',denynull = 'N',format = '',col_len = '4',field = 'idsor2',col_precision = '' where tablename = 'itinerationresidual' AND field = 'idsor2'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','itinerationresidual','N','','4','idsor2','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'idsor3')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationresidual',denynull = 'N',format = '',col_len = '4',field = 'idsor3',col_precision = '' where tablename = 'itinerationresidual' AND field = 'idsor3'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','itinerationresidual','N','','4','idsor3','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'itinerationresidual',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'itinerationresidual' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','itinerationresidual','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'linkedangir')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(23,6)',iskey = 'N',tablename = 'itinerationresidual',denynull = 'N',format = '',col_len = '13',field = 'linkedangir',col_precision = '23' where tablename = 'itinerationresidual' AND field = 'linkedangir'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(23,6)','N','itinerationresidual','N','','13','linkedangir','23')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'linkedanpag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(23,6)',iskey = 'N',tablename = 'itinerationresidual',denynull = 'N',format = '',col_len = '13',field = 'linkedanpag',col_precision = '23' where tablename = 'itinerationresidual' AND field = 'linkedanpag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(23,6)','N','itinerationresidual','N','','13','linkedanpag','23')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'linkedsaldo')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(23,6)',iskey = 'N',tablename = 'itinerationresidual',denynull = 'N',format = '',col_len = '13',field = 'linkedsaldo',col_precision = '23' where tablename = 'itinerationresidual' AND field = 'linkedsaldo'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(23,6)','N','itinerationresidual','N','','13','linkedsaldo','23')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'nitineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationresidual',denynull = 'S',format = '',col_len = '4',field = 'nitineration',col_precision = '' where tablename = 'itinerationresidual' AND field = 'nitineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationresidual','S','','4','nitineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'itinerationresidual',denynull = 'S',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'itinerationresidual' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(100)','N','itinerationresidual','S','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'residual')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(23,6)',iskey = 'N',tablename = 'itinerationresidual',denynull = 'N',format = '',col_len = '13',field = 'residual',col_precision = '23' where tablename = 'itinerationresidual' AND field = 'residual'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(23,6)','N','itinerationresidual','N','','13','residual','23')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'start')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'itinerationresidual',denynull = 'S',format = '',col_len = '4',field = 'start',col_precision = '' where tablename = 'itinerationresidual' AND field = 'start'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','itinerationresidual','S','','4','start','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'stop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'itinerationresidual',denynull = 'S',format = '',col_len = '4',field = 'stop',col_precision = '' where tablename = 'itinerationresidual' AND field = 'stop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','itinerationresidual','S','','4','stop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'totadvance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'itinerationresidual',denynull = 'N',format = '',col_len = '9',field = 'totadvance',col_precision = '19' where tablename = 'itinerationresidual' AND field = 'totadvance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','itinerationresidual','N','','9','totadvance','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'totalgross')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'itinerationresidual',denynull = 'N',format = '',col_len = '9',field = 'totalgross',col_precision = '19' where tablename = 'itinerationresidual' AND field = 'totalgross'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','itinerationresidual','N','','9','totalgross','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'itinerationresidual',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'itinerationresidual' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','itinerationresidual','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationresidual' AND field = 'yitineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'itinerationresidual',denynull = 'S',format = '',col_len = '2',field = 'yitineration',col_precision = '' where tablename = 'itinerationresidual' AND field = 'yitineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','itinerationresidual','S','','2','yitineration','')
GO

-- VERIFICA DI itinerationresidual IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'itinerationresidual')
UPDATE customobject set isreal = 'N' where objectname = 'itinerationresidual'
ELSE
INSERT INTO customobject (objectname, isreal) values('itinerationresidual', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA itinerationtaxview
IF EXISTS(select * from sysobjects where id = object_id(N'[itinerationtaxview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [itinerationtaxview]
GO


CREATE  VIEW itinerationtaxview
(
	iditineration,
	yitineration,
	nitineration,
	taxcode,
	description,
	taxref,
	taxkind,
	taxablenumerator,
	taxabledenominator,
	adminrate,
 	adminnumerator,
  	admindenominator,
	employrate,
  	employnumerator,
  	employdenominator,
	admintax,
	employtax,
	taxable,
	flagunabatable, 
	cu,
	ct,
	lu,
	lt
)
AS SELECT
	itinerationtax.iditineration,
	itineration.yitineration,
	itineration.nitineration,
	itinerationtax.taxcode,
	tax.description,
	tax.taxref,
	tax.taxkind,
	itinerationtax.taxablenumerator,
	itinerationtax.taxabledenominator,
	itinerationtax.adminrate,
  	itinerationtax.adminnumerator,
  	itinerationtax.admindenominator,
	itinerationtax.employrate,
  	itinerationtax.employnumerator,
  	itinerationtax.employdenominator,
	itinerationtax.admintax,
	itinerationtax.employtax,
	itinerationtax.taxable,
	tax.flagunabatable, 
	itinerationtax.cu,
	itinerationtax.ct,
	itinerationtax.lu,
	itinerationtax.lt
FROM itinerationtax
JOIN tax
	ON tax.taxcode = itinerationtax.taxcode
JOIN itineration
	ON itineration.iditineration = itinerationtax.iditineration

GO

-- VERIFICA DI itinerationtaxview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'itinerationtaxview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'admindenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '8',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,8)',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'N',format = '',col_len = '9',field = 'admindenominator',col_precision = '19' where tablename = 'itinerationtaxview' AND field = 'admindenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','8','decimal','','S','System.Decimal','decimal(19,8)','N','itinerationtaxview','N','','9','admindenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'adminnumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '8',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,8)',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'N',format = '',col_len = '9',field = 'adminnumerator',col_precision = '19' where tablename = 'itinerationtaxview' AND field = 'adminnumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','8','decimal','','S','System.Decimal','decimal(19,8)','N','itinerationtaxview','N','','9','adminnumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'adminrate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '8',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,8)',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'N',format = '',col_len = '9',field = 'adminrate',col_precision = '19' where tablename = 'itinerationtaxview' AND field = 'adminrate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','8','decimal','','S','System.Decimal','decimal(19,8)','N','itinerationtaxview','N','','9','adminrate','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'admintax')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'N',format = '',col_len = '9',field = 'admintax',col_precision = '19' where tablename = 'itinerationtaxview' AND field = 'admintax'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','itinerationtaxview','N','','9','admintax','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'itinerationtaxview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','itinerationtaxview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'itinerationtaxview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','itinerationtaxview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'S',format = '',col_len = '50',field = 'description',col_precision = '' where tablename = 'itinerationtaxview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','itinerationtaxview','S','','50','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'employdenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'N',format = '',col_len = '9',field = 'employdenominator',col_precision = '19' where tablename = 'itinerationtaxview' AND field = 'employdenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','itinerationtaxview','N','','9','employdenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'employnumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '8',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,8)',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'N',format = '',col_len = '9',field = 'employnumerator',col_precision = '19' where tablename = 'itinerationtaxview' AND field = 'employnumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','8','decimal','','S','System.Decimal','decimal(19,8)','N','itinerationtaxview','N','','9','employnumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'employrate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '8',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,8)',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'N',format = '',col_len = '9',field = 'employrate',col_precision = '19' where tablename = 'itinerationtaxview' AND field = 'employrate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','8','decimal','','S','System.Decimal','decimal(19,8)','N','itinerationtaxview','N','','9','employrate','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'employtax')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'N',format = '',col_len = '9',field = 'employtax',col_precision = '19' where tablename = 'itinerationtaxview' AND field = 'employtax'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','itinerationtaxview','N','','9','employtax','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'flagunabatable')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'N',format = '',col_len = '1',field = 'flagunabatable',col_precision = '' where tablename = 'itinerationtaxview' AND field = 'flagunabatable'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','itinerationtaxview','N','','1','flagunabatable','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'iditineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'S',format = '',col_len = '4',field = 'iditineration',col_precision = '' where tablename = 'itinerationtaxview' AND field = 'iditineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationtaxview','S','','4','iditineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'itinerationtaxview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','itinerationtaxview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'itinerationtaxview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','itinerationtaxview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'nitineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'S',format = '',col_len = '4',field = 'nitineration',col_precision = '' where tablename = 'itinerationtaxview' AND field = 'nitineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationtaxview','S','','4','nitineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'taxable')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'N',format = '',col_len = '9',field = 'taxable',col_precision = '19' where tablename = 'itinerationtaxview' AND field = 'taxable'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','itinerationtaxview','N','','9','taxable','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'taxabledenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '8',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,8)',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'N',format = '',col_len = '9',field = 'taxabledenominator',col_precision = '19' where tablename = 'itinerationtaxview' AND field = 'taxabledenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','8','decimal','','S','System.Decimal','decimal(19,8)','N','itinerationtaxview','N','','9','taxabledenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'taxablenumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '8',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,8)',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'N',format = '',col_len = '9',field = 'taxablenumerator',col_precision = '19' where tablename = 'itinerationtaxview' AND field = 'taxablenumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','8','decimal','','S','System.Decimal','decimal(19,8)','N','itinerationtaxview','N','','9','taxablenumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'taxcode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'S',format = '',col_len = '4',field = 'taxcode',col_precision = '' where tablename = 'itinerationtaxview' AND field = 'taxcode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationtaxview','S','','4','taxcode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'taxkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'S',format = '',col_len = '2',field = 'taxkind',col_precision = '' where tablename = 'itinerationtaxview' AND field = 'taxkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','itinerationtaxview','S','','2','taxkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'taxref')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'S',format = '',col_len = '20',field = 'taxref',col_precision = '' where tablename = 'itinerationtaxview' AND field = 'taxref'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','itinerationtaxview','S','','20','taxref','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationtaxview' AND field = 'yitineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'itinerationtaxview',denynull = 'S',format = '',col_len = '2',field = 'yitineration',col_precision = '' where tablename = 'itinerationtaxview' AND field = 'yitineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','itinerationtaxview','S','','2','yitineration','')
GO

-- VERIFICA DI itinerationtaxview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'itinerationtaxview')
UPDATE customobject set isreal = 'N' where objectname = 'itinerationtaxview'
ELSE
INSERT INTO customobject (objectname, isreal) values('itinerationtaxview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA itinerationview
IF EXISTS(select * from sysobjects where id = object_id(N'[itinerationview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [itinerationview]
GO



CREATE  VIEW itinerationview 
(
	iditineration,
	yitineration,
	nitineration,
	description,
	idreg,
	registry,
	idser,
	service,
	codeser,
	admincarkmcost,
	owncarkmcost,
	footkmcost,
	admincarkm,
	owncarkm,
	footkm,
	authorizationdate,
	start,
	stop,
	adate,
	grossfactor,
	netfee,
	totalgross,
	total,
	totadvance,
	cu,
	ct,
	lu,
	lt,
	active,
	completed,
	idaccmotive,
	idupb,
	idsor1,
	idsor2,
	idsor3,
	txt,
	rtf
)
AS SELECT
	itineration.iditineration,
	itineration.yitineration,
	itineration.nitineration,
	itineration.description,
	itineration.idreg,
	registry.title,
	itineration.idser,
	service.description,
	service.codeser,
	itineration.admincarkmcost,
	itineration.owncarkmcost,
	itineration.footkmcost,
	itineration.admincarkm,
	itineration.owncarkm,
	itineration.footkm,
	itineration.authorizationdate,
	itineration.start,
	itineration.stop,
	itineration.adate,
	itineration.grossfactor,
	itineration.netfee,
	itineration.totalgross,
	itineration.total,
	itineration.totadvance,
	itineration.cu,
	itineration.ct,
	itineration.lu,
	itineration.lt,
	itineration.active,
	itineration.completed,
	itineration.idaccmotive,
	itineration.idupb,
	itineration.idsor1,
	itineration.idsor2,
	itineration.idsor3,
	itineration.txt,
	itineration.rtf
FROM itineration
JOIN registry 
	ON registry.idreg = itineration.idreg
LEFT OUTER JOIN service 
	ON service.idser = itineration.idser

GO

-- VERIFICA DI itinerationview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'itinerationview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'active')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '1',field = 'active',col_precision = '' where tablename = 'itinerationview' AND field = 'active'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','itinerationview','N','','1','active','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'itinerationview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'itinerationview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','itinerationview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'admincarkm')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'float',defaultvalue = '',allownull = 'S',systemtype = 'System.Double',sqldeclaration = 'float',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '8',field = 'admincarkm',col_precision = '' where tablename = 'itinerationview' AND field = 'admincarkm'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','float','','S','System.Double','float','N','itinerationview','N','','8','admincarkm','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'admincarkmcost')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '9',field = 'admincarkmcost',col_precision = '19' where tablename = 'itinerationview' AND field = 'admincarkmcost'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','itinerationview','N','','9','admincarkmcost','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'authorizationdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'itinerationview',denynull = 'S',format = '',col_len = '4',field = 'authorizationdate',col_precision = '' where tablename = 'itinerationview' AND field = 'authorizationdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','itinerationview','S','','4','authorizationdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'codeser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '20',field = 'codeser',col_precision = '' where tablename = 'itinerationview' AND field = 'codeser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','itinerationview','N','','20','codeser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'completed')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '1',field = 'completed',col_precision = '' where tablename = 'itinerationview' AND field = 'completed'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','itinerationview','N','','1','completed','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'itinerationview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'itinerationview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','itinerationview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'itinerationview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'itinerationview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','itinerationview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'itinerationview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'itinerationview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','itinerationview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'footkm')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'float',defaultvalue = '',allownull = 'S',systemtype = 'System.Double',sqldeclaration = 'float',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '8',field = 'footkm',col_precision = '' where tablename = 'itinerationview' AND field = 'footkm'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','float','','S','System.Double','float','N','itinerationview','N','','8','footkm','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'footkmcost')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '9',field = 'footkmcost',col_precision = '19' where tablename = 'itinerationview' AND field = 'footkmcost'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','itinerationview','N','','9','footkmcost','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'grossfactor')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'float',defaultvalue = '',allownull = 'S',systemtype = 'System.Double',sqldeclaration = 'float',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '8',field = 'grossfactor',col_precision = '' where tablename = 'itinerationview' AND field = 'grossfactor'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','float','','S','System.Double','float','N','itinerationview','N','','8','grossfactor','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'idaccmotive')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '36',field = 'idaccmotive',col_precision = '' where tablename = 'itinerationview' AND field = 'idaccmotive'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','itinerationview','N','','36','idaccmotive','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'iditineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationview',denynull = 'S',format = '',col_len = '4',field = 'iditineration',col_precision = '' where tablename = 'itinerationview' AND field = 'iditineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationview','S','','4','iditineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationview',denynull = 'S',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'itinerationview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationview','S','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationview',denynull = 'S',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'itinerationview' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationview','S','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'idsor1')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '4',field = 'idsor1',col_precision = '' where tablename = 'itinerationview' AND field = 'idsor1'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','itinerationview','N','','4','idsor1','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'idsor2')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '4',field = 'idsor2',col_precision = '' where tablename = 'itinerationview' AND field = 'idsor2'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','itinerationview','N','','4','idsor2','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'idsor3')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '4',field = 'idsor3',col_precision = '' where tablename = 'itinerationview' AND field = 'idsor3'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','itinerationview','N','','4','idsor3','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'itinerationview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','itinerationview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'itinerationview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'itinerationview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','itinerationview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'itinerationview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'itinerationview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','itinerationview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'netfee')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '9',field = 'netfee',col_precision = '19' where tablename = 'itinerationview' AND field = 'netfee'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','itinerationview','N','','9','netfee','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'nitineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'itinerationview',denynull = 'S',format = '',col_len = '4',field = 'nitineration',col_precision = '' where tablename = 'itinerationview' AND field = 'nitineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','itinerationview','S','','4','nitineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'owncarkm')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'float',defaultvalue = '',allownull = 'S',systemtype = 'System.Double',sqldeclaration = 'float',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '8',field = 'owncarkm',col_precision = '' where tablename = 'itinerationview' AND field = 'owncarkm'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','float','','S','System.Double','float','N','itinerationview','N','','8','owncarkm','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'owncarkmcost')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '9',field = 'owncarkmcost',col_precision = '19' where tablename = 'itinerationview' AND field = 'owncarkmcost'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','itinerationview','N','','9','owncarkmcost','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'itinerationview',denynull = 'S',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'itinerationview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(100)','N','itinerationview','S','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'rtf')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'image',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte[]',sqldeclaration = 'image',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '16',field = 'rtf',col_precision = '' where tablename = 'itinerationview' AND field = 'rtf'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','image','','S','System.Byte[]','image','N','itinerationview','N','','16','rtf','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'itinerationview' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','itinerationview','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'start')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'itinerationview',denynull = 'S',format = '',col_len = '4',field = 'start',col_precision = '' where tablename = 'itinerationview' AND field = 'start'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','itinerationview','S','','4','start','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'stop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'itinerationview',denynull = 'S',format = '',col_len = '4',field = 'stop',col_precision = '' where tablename = 'itinerationview' AND field = 'stop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','itinerationview','S','','4','stop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'totadvance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '9',field = 'totadvance',col_precision = '19' where tablename = 'itinerationview' AND field = 'totadvance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','itinerationview','N','','9','totadvance','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'total')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '9',field = 'total',col_precision = '19' where tablename = 'itinerationview' AND field = 'total'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','itinerationview','N','','9','total','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'totalgross')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '9',field = 'totalgross',col_precision = '19' where tablename = 'itinerationview' AND field = 'totalgross'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','itinerationview','N','','9','totalgross','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'txt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'text',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'text',iskey = 'N',tablename = 'itinerationview',denynull = 'N',format = '',col_len = '16',field = 'txt',col_precision = '' where tablename = 'itinerationview' AND field = 'txt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','text','','S','System.String','text','N','itinerationview','N','','16','txt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'itinerationview' AND field = 'yitineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'itinerationview',denynull = 'S',format = '',col_len = '2',field = 'yitineration',col_precision = '' where tablename = 'itinerationview' AND field = 'yitineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','itinerationview','S','','2','yitineration','')
GO

-- VERIFICA DI itinerationview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'itinerationview')
UPDATE customobject set isreal = 'N' where objectname = 'itinerationview'
ELSE
INSERT INTO customobject (objectname, isreal) values('itinerationview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA ivapayexpenseview
IF EXISTS(select * from sysobjects where id = object_id(N'[ivapayexpenseview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [ivapayexpenseview]
GO


CREATE  VIEW [ivapayexpenseview]
(
	yivapay,
	nivapay,
	idexp,
	nphase,
	phase,
	ymov,
	nmov,
	parentidexp,
	parentymov,
	parentnmov,
	ayear,
	idfin,
	codefin,
	finance,
	idupb,
	codeupb,
	upb,
	idreg,
	registry,
	idman,
	manager,
	kpay,
	ypay,
	npay,
	doc,
	docdate,
	description,
	amount,
	netamount,
	totalamount,
	ayearstartamount,
	curramount,
	available,
	idpaymethod,
	iban,
	cin,
	idbank,
	idcab,
	cc,
	paymentdescr,
	idser,
	service,
	servicestart,
	servicestop,
	ivaamount,
	flag,
	totflag,
	flagarrear,
	autokind,
	idpayment,
	expiration,
	adate,
	cu,
	ct,
	lu,
	lt
)
	AS SELECT
	ivapayexpense.yivapay,
	ivapayexpense.nivapay,
	ivapayexpense.idexp,
	expense.nphase,
	expensephase.description,
	expense.ymov,
	expense.nmov,
	expense.parentidexp,
	parentexpense.ymov,
	parentexpense.nmov,
	expenseyear.ayear,
	expenseyear.idfin,
	fin.codefin,
	fin.title,
	expenseyear.idupb,
	upb.codeupb,
	upb.title,
	expense.idreg,
	registry.title,
	expense.idman,
	manager.title,
	payment.kpay,
	payment.ypay,
	payment.npay,
	expense.doc,
	expense.docdate,
	expense.description,
	expenseyear_starting.amount,
	ISNULL(expenseyear_starting.amount,0)- ISNULL((SELECT SUM(employtax) from expensetax
				where idexp = expense.idexp ),0),
	ISNULL(expenseyear_starting.amount,0)+ ISNULL((SELECT SUM(admintax) from expensetax
				where idexp = expense.idexp ),0),
	expenseyear.amount,
	expensetotal.curramount,
	expensetotal.available,
	expenselast.idpaymethod,
	expenselast.iban,
	expenselast.cin,
	expenselast.idbank,
	expenselast.idcab,
	expenselast.cc,
	expenselast.paymentdescr,
	expenselast.idser,
	service.description,
	expenselast.servicestart,
	expenselast.servicestop,
	expenselast.ivaamount,
	expenselast.flag,
	expensetotal.flag,
	CASE
		WHEN ((expensetotal.flag&1)=0) THEN 'C'
		WHEN ((expensetotal.flag&1)=1) THEN 'R'
	END, 
  	expense.autokind,
	expense.idpayment,
	expense.expiration,
	expense.adate,
	ivapayexpense.cu,
	ivapayexpense.ct,
	ivapayexpense.lu,
	ivapayexpense.lt
FROM ivapayexpense 
JOIN expense  
	ON expense.idexp = ivapayexpense.idexp
JOIN expensephase 
	ON expensephase.nphase = expense.nphase
JOIN expenseyear 
	ON expenseyear.idexp = expense.idexp
JOIN expensetotal 
	ON expensetotal.idexp = expenseyear.idexp
	AND expensetotal.ayear = expenseyear.ayear
LEFT OUTER JOIN fin 
	ON fin.idfin = expenseyear.idfin
LEFT OUTER JOIN upb 
	ON upb.idupb = expenseyear.idupb
LEFT OUTER JOIN registry 
	ON registry.idreg = expense.idreg
LEFT OUTER JOIN manager 
	ON manager.idman = expense.idman
LEFT OUTER JOIN expenselast  
	ON expense.idexp = expenselast.idexp
LEFT OUTER JOIN payment  
	ON payment.kpay = expenselast.kpay
LEFT OUTER JOIN service 
	ON service.idser = expenselast.idser
LEFT OUTER JOIN expense parentexpense 
	ON expense.parentidexp = parentexpense.idexp
LEFT OUTER JOIN expensetotal expensetotal_firstyear
	ON expensetotal_firstyear.idexp = expense.idexp
	AND ((expensetotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN expenseyear expenseyear_starting 
	ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
	AND expenseyear_starting.ayear = expensetotal_firstyear.ayear

GO

-- VERIFICA DI ivapayexpenseview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'ivapayexpenseview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','ivapayexpenseview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'ivapayexpenseview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','ivapayexpenseview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','ivapayexpenseview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'ivapayexpenseview' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','ivapayexpenseview','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','ivapayexpenseview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'ayearstartamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '9',field = 'ayearstartamount',col_precision = '19' where tablename = 'ivapayexpenseview' AND field = 'ayearstartamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','ivapayexpenseview','N','','9','ayearstartamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'cc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(30)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '30',field = 'cc',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'cc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(30)','N','ivapayexpenseview','N','','30','cc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'cin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(2)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '2',field = 'cin',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'cin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(2)','N','ivapayexpenseview','N','','2','cin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','ivapayexpenseview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','ivapayexpenseview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','ivapayexpenseview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','ivapayexpenseview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'ivapayexpenseview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','ivapayexpenseview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','ivapayexpenseview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','ivapayexpenseview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','ivapayexpenseview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','ivapayexpenseview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','ivapayexpenseview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','ivapayexpenseview','N','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','ivapayexpenseview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'iban')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '50',field = 'iban',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'iban'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','ivapayexpenseview','N','','50','iban','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'idbank')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '20',field = 'idbank',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'idbank'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','ivapayexpenseview','N','','20','idbank','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'idcab')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '20',field = 'idcab',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'idcab'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','ivapayexpenseview','N','','20','idcab','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','ivapayexpenseview','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','ivapayexpenseview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','ivapayexpenseview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','ivapayexpenseview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'idpaymethod')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idpaymethod',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'idpaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','ivapayexpenseview','N','','4','idpaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','ivapayexpenseview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','ivapayexpenseview','N','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','ivapayexpenseview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'ivaamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '9',field = 'ivaamount',col_precision = '19' where tablename = 'ivapayexpenseview' AND field = 'ivaamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','ivapayexpenseview','N','','9','ivaamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','ivapayexpenseview','N','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','ivapayexpenseview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','ivapayexpenseview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','ivapayexpenseview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'netamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '17',field = 'netamount',col_precision = '38' where tablename = 'ivapayexpenseview' AND field = 'netamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(38,2)','N','ivapayexpenseview','N','','17','netamount','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'nivapay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'S',format = '',col_len = '4',field = 'nivapay',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'nivapay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','ivapayexpenseview','S','','4','nivapay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','ivapayexpenseview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','ivapayexpenseview','N','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','ivapayexpenseview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'parentidexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'parentidexp',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'parentidexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','ivapayexpenseview','N','','4','parentidexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','ivapayexpenseview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','ivapayexpenseview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'paymentdescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '150',field = 'paymentdescr',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'paymentdescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','ivapayexpenseview','N','','150','paymentdescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','ivapayexpenseview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','ivapayexpenseview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','ivapayexpenseview','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'servicestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '8',field = 'servicestart',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','ivapayexpenseview','N','','8','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'servicestop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '8',field = 'servicestop',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','ivapayexpenseview','N','','8','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'totalamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '17',field = 'totalamount',col_precision = '38' where tablename = 'ivapayexpenseview' AND field = 'totalamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(38,2)','N','ivapayexpenseview','N','','17','totalamount','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','ivapayexpenseview','N','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','ivapayexpenseview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'yivapay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'S',format = '',col_len = '4',field = 'yivapay',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'yivapay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','ivapayexpenseview','S','','4','yivapay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','ivapayexpenseview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayexpenseview' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'ivapayexpenseview',denynull = 'N',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'ivapayexpenseview' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','ivapayexpenseview','N','','2','ypay','')
GO

-- VERIFICA DI ivapayexpenseview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'ivapayexpenseview')
UPDATE customobject set isreal = 'N' where objectname = 'ivapayexpenseview'
ELSE
INSERT INTO customobject (objectname, isreal) values('ivapayexpenseview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA ivapayincomeview
IF EXISTS(select * from sysobjects where id = object_id(N'[ivapayincomeview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [ivapayincomeview]
GO





CREATE  VIEW [ivapayincomeview]
	(
	yivapay,
	nivapay,
	idinc,
	nphase,
	phase,
	ymov,
	nmov,
	parentidinc,
	parentymov,
	parentnmov,
	ayear,
	idfin,
	codefin,
	finance,
	idupb,
	codeupb,
	upb,
	idreg,
	registry,
	idman,
	manager,
	kpro,
	ypro,
	npro,
	doc,
	docdate,
	description,
	amount,
	ayearstartamount,
	curramount,
	available,
	unpartitioned,
	flag,
	totflag,
	flagarrear,
  	autokind,
	idpayment,
	expiration,
	adate,
	cu,
	ct,
	lu,
	lt
	)
	AS SELECT
	ivapayincome.yivapay,
	ivapayincome.nivapay,
	ivapayincome.idinc,
	income.nphase,
	incomephase.description,
	income.ymov,
	income.nmov,
	--income.ycreation,
	income.parentidinc,
	parentincome.ymov,
	parentincome.nmov,
	incomeyear.ayear,
	incomeyear.idfin,
	fin.codefin,
	fin.title,
	incomeyear.idupb,
	upb.codeupb,
	upb.title,
	income.idreg,
	registry.title,
	income.idman,
	manager.title,
	--income.ypro,
	proceeds.kpro,
	proceeds.ypro,
	proceeds.npro,
	income.doc,
	income.docdate,
	income.description,
	--income.amount,
	incomeyear_starting.amount,
	--incometotal.amount,
	incomeyear.amount,
	incometotal.curramount,
	incometotal.available,
	ISNULL(incometotal.curramount,0)-ISNULL(incometotal.partitioned,0),
	--income.fulfilled,
	incomelast.flag,
	incometotal.flag,
	--incomeyear.flagarrear,
	CASE
		WHEN ((incometotal.flag&1)=0) THEN 'C'
		WHEN ((incometotal.flag&1)=1) THEN 'R'
	END, 
	income.autokind,
	--income.idproceeds,
	income.idpayment,
	income.expiration,
	income.adate,
	ivapayincome.cu,
	ivapayincome.ct,
	ivapayincome.lu,
	ivapayincome.lt
	FROM ivapayincome (NOLOCK)
	JOIN income (NOLOCK)
	ON income.idinc = ivapayincome.idinc
	JOIN incomephase (NOLOCK)
	ON incomephase.nphase = income.nphase
	JOIN incomeyear (NOLOCK)
	ON incomeyear.idinc = income.idinc
	JOIN incometotal (NOLOCK)
	ON incometotal.idinc = incomeyear.idinc
	AND incometotal.ayear = incomeyear.ayear
	LEFT OUTER JOIN fin (NOLOCK)
	ON fin.idfin = incomeyear.idfin
	LEFT OUTER JOIN upb (NOLOCK)
	ON upb.idupb = incomeyear.idupb
	LEFT OUTER JOIN registry (NOLOCK)
	ON registry.idreg = income.idreg
	LEFT OUTER JOIN manager (NOLOCK)
	ON manager.idman = income.idman
	LEFT OUTER JOIN incomelast  (NOLOCK)
	ON income.idinc = incomelast.idinc
	LEFT OUTER JOIN proceeds  (NOLOCK)
	ON proceeds.kpro = incomelast.kpro
	LEFT OUTER JOIN income parentincome (NOLOCK)
	ON income.parentidinc = parentincome.idinc
	LEFT OUTER JOIN incometotal incometotal_firstyear(NOLOCK)
  	ON incometotal_firstyear.idinc = income.idinc
  	AND ((incometotal_firstyear.flag & 2) <> 0 )
	LEFT OUTER JOIN incomeyear incomeyear_starting(NOLOCK) 
	ON incomeyear_starting.idinc = incometotal_firstyear.idinc
  	AND incomeyear_starting.ayear = incometotal_firstyear.ayear

GO

-- VERIFICA DI ivapayincomeview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'ivapayincomeview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','ivapayincomeview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'ivapayincomeview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','ivapayincomeview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','ivapayincomeview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'ivapayincomeview' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','ivapayincomeview','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','ivapayincomeview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'ayearstartamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '9',field = 'ayearstartamount',col_precision = '19' where tablename = 'ivapayincomeview' AND field = 'ayearstartamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','ivapayincomeview','N','','9','ayearstartamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','ivapayincomeview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','ivapayincomeview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','ivapayincomeview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','ivapayincomeview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'ivapayincomeview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','ivapayincomeview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','ivapayincomeview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','ivapayincomeview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','ivapayincomeview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','ivapayincomeview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','ivapayincomeview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','ivapayincomeview','N','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','ivapayincomeview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','ivapayincomeview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'idinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'S',format = '',col_len = '4',field = 'idinc',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'idinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','ivapayincomeview','S','','4','idinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','ivapayincomeview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','ivapayincomeview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','ivapayincomeview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','ivapayincomeview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'kpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '4',field = 'kpro',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'kpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','ivapayincomeview','N','','4','kpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','ivapayincomeview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','ivapayincomeview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','ivapayincomeview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'nivapay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'S',format = '',col_len = '4',field = 'nivapay',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'nivapay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','ivapayincomeview','S','','4','nivapay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','ivapayincomeview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','ivapayincomeview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'npro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '4',field = 'npro',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'npro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','ivapayincomeview','N','','4','npro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'parentidinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '4',field = 'parentidinc',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'parentidinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','ivapayincomeview','N','','4','parentidinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','ivapayincomeview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','ivapayincomeview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','ivapayincomeview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','ivapayincomeview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'S',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','ivapayincomeview','S','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'unpartitioned')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(20,2)',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '13',field = 'unpartitioned',col_precision = '20' where tablename = 'ivapayincomeview' AND field = 'unpartitioned'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(20,2)','N','ivapayincomeview','N','','13','unpartitioned','20')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','ivapayincomeview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'yivapay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'S',format = '',col_len = '4',field = 'yivapay',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'yivapay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','ivapayincomeview','S','','4','yivapay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','ivapayincomeview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'ivapayincomeview' AND field = 'ypro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'ivapayincomeview',denynull = 'N',format = '',col_len = '2',field = 'ypro',col_precision = '' where tablename = 'ivapayincomeview' AND field = 'ypro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','ivapayincomeview','N','','2','ypro','')
GO

-- VERIFICA DI ivapayincomeview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'ivapayincomeview')
UPDATE customobject set isreal = 'N' where objectname = 'ivapayincomeview'
ELSE
INSERT INTO customobject (objectname, isreal) values('ivapayincomeview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA mandateresidual
IF EXISTS(select * from sysobjects where id = object_id(N'[mandateresidual]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [mandateresidual]
GO



CREATE     VIEW [mandateresidual]
	(
	idmankind,	
	yman,
	nman,
	mankind,
	description,
	idreg,
	idupb,
	registry,
	taxabletotal,
	ivatotal,
	residual,
	linkedimpon,
	linkedimpos,
	linkedordin,
	active,
	upb
	)
AS SELECT
	mandatedetail.idmankind,
	mandatedetail.yman,
	mandatedetail.nman,
	mandatekind.description,
	mandate.description,
	isnull(mandate.idreg,mandatedetail.idreg),
	mandatedetail.idupb,
	CASE
	WHEN mandate.idreg is not null THEN (select title from
					registry 
					where idreg= mandate.idreg)
	WHEN mandatedetail.idreg is not null THEN (select title from
					registry 
					where idreg= mandatedetail.idreg)
	ELSE null
	END,
	CONVERT(DECIMAL(19,2),
		ISNULL(SUM(  ROUND(mandatedetail.taxable * mandatedetail.number * 
		     	     CONVERT(decimal(19,6),mandate.exchangerate) * 
		     	     (1 - CONVERT(decimal(19,6),ISNULL(mandatedetail.discount, 0.0))),2)
	   ),0)
	),
	CONVERT(DECIMAL(19,2),
		ISNULL(SUM(ROUND(mandatedetail.tax * CONVERT(decimal(19,6), mandate.exchangerate),2)
	   ),0)
	),
	--residuo :somma dei dett. ordine non contabilizzati
	CONVERT(DECIMAL(19,2),
		ISNULL(SUM(
		    CASE 
			WHEN (mandatedetail.idexp_taxable IS  NULL) AND (mandatedetail.idexp_iva IS  NOT NULL)
			THEN
			     ROUND(mandatedetail.taxable * mandatedetail.number * 
		     	     CONVERT(decimal(19,6),mandate.exchangerate) * 
		     	     (1 - CONVERT(decimal(19,6),ISNULL(mandatedetail.discount, 0.0))),2)

			WHEN ( mandatedetail.idexp_iva IS NULL) AND (mandatedetail.idexp_taxable IS  NOT NULL)
			THEN
			    ROUND(mandatedetail.tax * CONVERT(decimal(19,6), mandate.exchangerate),2)

			WHEN ( mandatedetail.idexp_iva IS  NULL) AND (mandatedetail.idexp_taxable IS  NULL)
			THEN
			     ROUND(mandatedetail.taxable * mandatedetail.number * 
		     	     CONVERT(decimal(19,6),mandate.exchangerate) * 
		     	     (1 - CONVERT(decimal(19,6),ISNULL(mandatedetail.discount, 0.0))),2) 
			     +
			     ROUND(mandatedetail.tax * CONVERT(decimal(19,6), mandate.exchangerate),2)
			ELSE   0

		    END
		   ),0)
		),
-- (mov.movkind = '3' )
	CONVERT(DECIMAL(19,2),
		ISNULL(SUM(
		    CASE 
			WHEN (mandatedetail.idexp_taxable IS NOT NULL 
				AND (mandatedetail.idexp_iva IS NULL OR mandatedetail.idexp_taxable<>mandatedetail.idexp_iva)) 
			THEN
			      ROUND(mandatedetail.taxable * mandatedetail.number * 
		     	     CONVERT(decimal(19,6),mandate.exchangerate) * 
		     	     (1 - CONVERT(decimal(19,6),ISNULL(mandatedetail.discount, 0.0))),2)
			ELSE   0
		    END
			
		   ),0)
		),

-- (mov.movkind = '2')
	CONVERT(DECIMAL(19,2),
		ISNULL(SUM(
		    CASE 
			WHEN (mandatedetail.idexp_iva IS NOT NULL 
				AND  (mandatedetail.idexp_taxable IS NULL OR mandatedetail.idexp_taxable<>mandatedetail.idexp_iva)) 
			THEN
			       ROUND(mandatedetail.tax * CONVERT(decimal(19,6), mandate.exchangerate),2)
			ELSE   0
		    END
			
		   ),0)
		),
	
--  (mov.movkind = '1' )
	CONVERT(DECIMAL(19,2),
		ISNULL(SUM(
		    CASE 
			WHEN (mandatedetail.idexp_taxable IS NOT NULL AND mandatedetail.idexp_iva= mandatedetail.idexp_taxable)
			THEN
	  		     ROUND(mandatedetail.taxable * mandatedetail.number * 
		     	     CONVERT(decimal(19,6),mandate.exchangerate) * 
		     	     (1 - CONVERT(decimal(19,6),ISNULL(mandatedetail.discount, 0.0))),2) 
			     +
			     ROUND(mandatedetail.tax * CONVERT(decimal(19,6), mandate.exchangerate),2)			
			ELSE   0
		    END
		   ),0)
		),

	mandate.active,
	upb.title
FROM mandatedetail (NOLOCK)
JOIN mandate (NOLOCK)
  	ON mandatedetail.idmankind = mandate.idmankind
	AND mandatedetail.yman = mandate.yman
  	AND mandatedetail.nman = mandate.nman
JOIN mandatekind
	ON mandatekind.idmankind = mandate.idmankind 
LEFT OUTER JOIN upb
	on upb.idupb=mandatedetail.idupb
GROUP BY mandatedetail.idmankind, mandatedetail.yman, mandatedetail.nman,
	mandate.idreg,mandatedetail.idreg,mandatedetail.idupb,
	mandatekind.description,mandate.description,
	mandate.active,upb.title

GO

-- VERIFICA DI mandateresidual IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'mandateresidual'
IF exists(SELECT * FROM columntypes WHERE tablename = 'mandateresidual' AND field = 'active')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'mandateresidual',denynull = 'N',format = '',col_len = '1',field = 'active',col_precision = '' where tablename = 'mandateresidual' AND field = 'active'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','mandateresidual','N','','1','active','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'mandateresidual' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'mandateresidual',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'mandateresidual' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','mandateresidual','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'mandateresidual' AND field = 'idmankind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'mandateresidual',denynull = 'S',format = '',col_len = '20',field = 'idmankind',col_precision = '' where tablename = 'mandateresidual' AND field = 'idmankind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','mandateresidual','S','','20','idmankind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'mandateresidual' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'mandateresidual',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'mandateresidual' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','mandateresidual','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'mandateresidual' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'mandateresidual',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'mandateresidual' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','mandateresidual','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'mandateresidual' AND field = 'ivatotal')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'mandateresidual',denynull = 'N',format = '',col_len = '9',field = 'ivatotal',col_precision = '19' where tablename = 'mandateresidual' AND field = 'ivatotal'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','mandateresidual','N','','9','ivatotal','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'mandateresidual' AND field = 'linkedimpon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'mandateresidual',denynull = 'N',format = '',col_len = '9',field = 'linkedimpon',col_precision = '19' where tablename = 'mandateresidual' AND field = 'linkedimpon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','mandateresidual','N','','9','linkedimpon','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'mandateresidual' AND field = 'linkedimpos')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'mandateresidual',denynull = 'N',format = '',col_len = '9',field = 'linkedimpos',col_precision = '19' where tablename = 'mandateresidual' AND field = 'linkedimpos'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','mandateresidual','N','','9','linkedimpos','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'mandateresidual' AND field = 'linkedordin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'mandateresidual',denynull = 'N',format = '',col_len = '9',field = 'linkedordin',col_precision = '19' where tablename = 'mandateresidual' AND field = 'linkedordin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','mandateresidual','N','','9','linkedordin','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'mandateresidual' AND field = 'mankind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'mandateresidual',denynull = 'S',format = '',col_len = '150',field = 'mankind',col_precision = '' where tablename = 'mandateresidual' AND field = 'mankind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','mandateresidual','S','','150','mankind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'mandateresidual' AND field = 'nman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'mandateresidual',denynull = 'S',format = '',col_len = '4',field = 'nman',col_precision = '' where tablename = 'mandateresidual' AND field = 'nman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','mandateresidual','S','','4','nman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'mandateresidual' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'mandateresidual',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'mandateresidual' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','mandateresidual','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'mandateresidual' AND field = 'residual')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'mandateresidual',denynull = 'N',format = '',col_len = '9',field = 'residual',col_precision = '19' where tablename = 'mandateresidual' AND field = 'residual'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','mandateresidual','N','','9','residual','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'mandateresidual' AND field = 'taxabletotal')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'mandateresidual',denynull = 'N',format = '',col_len = '9',field = 'taxabletotal',col_precision = '19' where tablename = 'mandateresidual' AND field = 'taxabletotal'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','mandateresidual','N','','9','taxabletotal','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'mandateresidual' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'mandateresidual',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'mandateresidual' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','mandateresidual','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'mandateresidual' AND field = 'yman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'mandateresidual',denynull = 'S',format = '',col_len = '2',field = 'yman',col_precision = '' where tablename = 'mandateresidual' AND field = 'yman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','mandateresidual','S','','2','yman','')
GO

-- VERIFICA DI mandateresidual IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'mandateresidual')
UPDATE customobject set isreal = 'N' where objectname = 'mandateresidual'
ELSE
INSERT INTO customobject (objectname, isreal) values('mandateresidual', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA parentexpenseview
IF EXISTS(select * from sysobjects where id = object_id(N'[parentexpenseview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [parentexpenseview]
GO




CREATE     VIEW parentexpenseview
(
	idexp,
	nphase,
	phase,
	ymov,
	nmov,
	parentidexp,
	parentymov,
	parentnmov,
	idformerexpense,
	ayear,
	idfin,
	codefin,
	finance,
	idupb,
	codeupb,
	upb,
	idreg,
	registry,
	idman,
	manager,
	kpay,
	ypay,
	npay,
	paymentadate,
	doc,
	docdate,
	description,
	amount,
	ayearstartamount,
	curramount,
	available,
	idregistrypaymethod,
	idpaymethod,
	iban,
	cin,
	idbank,
	idcab,
	cc,
	iddeputy,
	deputy,
	refexternaldoc,
	paymentdescr,
	idser,
	service,
	codeser,
	servicestart,
	servicestop,
	ivaamount,
	flag,
	totflag,
	flagarrear,
	autokind,
	idpayment,
	expiration,
	adate,
	autocode,
	idclawback,
	clawback,
	clawbackref,
	nbill,
	idpay,
	txt,
	cu,
	ct,
	lu,
	lt
)
AS SELECT
	expensechild.idexp,
	expense.nphase,
	expensephase.description,
	expense.ymov,
	expense.nmov,
	expense.parentidexp,
	parentexpense.ymov,
	parentexpense.nmov,
	expense.idformerexpense,
	expenseyear.ayear,
	expenseyear.idfin,
	fin.codefin,
	fin.title,
	upb.idupb,
	upb.codeupb,
	upb.title,
	expense.idreg,
	registry.title,
	expense.idman,
	manager.title,
	payment.kpay,
	payment.ypay,
	payment.npay,
	payment.adate,
	expense.doc,
	expense.docdate,
	expense.description,
	expenseyear_starting.amount,
	expenseyear.amount,
	expensetotal.curramount,
	expensetotal.available,
	expenselast.idregistrypaymethod,
	expenselast.idpaymethod,
	expenselast.iban,
	expenselast.cin,
	expenselast.idbank,
	expenselast.idcab,
	expenselast.cc,
	expenselast.iddeputy,  
	deputy.title,
	expenselast.refexternaldoc,
	expenselast.paymentdescr,
	expenselast.idser,
	service.description,
	service.codeser,
	expenselast.servicestart,
	expenselast.servicestop,
	expenselast.ivaamount,
	expenselast.flag,
	expensetotal.flag,
	CASE
		WHEN ((expensetotal.flag&1)=0) THEN 'C'
		WHEN ((expensetotal.flag&1)=1) THEN 'R'
	END, 
	expense.autokind,
	expense.idpayment,
	expense.expiration,
	expense.adate,
	expense.autocode,
	expense.idclawback,
	clawback.description,
	clawback.clawbackref,
	expenselast.nbill,
	expenselast.idpay,
	expense.txt,
	expense.cu,
	expense.ct,
	expense.lu,
	expense.lt
FROM expense
JOIN expense expensechild
	ON expense.idexp= expensechild.parentidexp
JOIN expensephase
	ON expensephase.nphase = expense.nphase
JOIN expenseyear
	ON expenseyear.idexp = expense.idexp
JOIN expensetotal
	ON expensetotal.idexp = expense.idexp
	AND expensetotal.ayear = expenseyear.ayear
LEFT OUTER JOIN expense parentexpense
	ON parentexpense.idexp = expense.parentidexp
LEFT OUTER JOIN expenselast 
	ON expenselast.idexp = expense.idexp
LEFT OUTER JOIN fin
	ON fin.idfin = expenseyear.idfin
LEFT OUTER JOIN upb
	on upb.idupb = expenseyear.idupb
LEFT OUTER JOIN registry
	ON registry.idreg = expense.idreg
LEFT OUTER JOIN manager
	ON manager.idman = expense.idman
LEFT OUTER JOIN service
	ON service.idser = expenselast.idser
LEFT OUTER JOIN payment
	ON payment.kpay = expenselast.kpay
LEFT OUTER JOIN registry deputy
	ON deputy.idreg = expenselast.iddeputy
LEFT OUTER JOIN clawback
	ON clawback.idclawback = expense.idclawback
LEFT OUTER JOIN expensetotal expensetotal_firstyear
  	ON expensetotal_firstyear.idexp = expense.idexp
  	AND ((expensetotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN expenseyear expenseyear_starting
	ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
  	AND expenseyear_starting.ayear = expensetotal_firstyear.ayear



GO

-- VERIFICA DI parentexpenseview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'parentexpenseview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'adate')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'parentexpenseview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'parentexpenseview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','smalldatetime','','N','System.DateTime','smalldatetime','N','parentexpenseview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'amount')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'parentexpenseview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(19,2)','N','parentexpenseview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'autocode')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'autocode',col_precision = '' where tablename = 'parentexpenseview' AND field = 'autocode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','parentexpenseview','N','','4','autocode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'autokind')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'parentexpenseview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','tinyint','','S','System.Byte','tinyint','N','parentexpenseview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'available')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'parentexpenseview' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(19,2)','N','parentexpenseview','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'ayear')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'parentexpenseview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'parentexpenseview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','smallint','','N','System.Int16','smallint','N','parentexpenseview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'ayearstartamount')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '9',field = 'ayearstartamount',col_precision = '19' where tablename = 'parentexpenseview' AND field = 'ayearstartamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(19,2)','N','parentexpenseview','N','','9','ayearstartamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'cc')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(30)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '30',field = 'cc',col_precision = '' where tablename = 'parentexpenseview' AND field = 'cc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(30)','N','parentexpenseview','N','','30','cc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'cin')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(2)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '2',field = 'cin',col_precision = '' where tablename = 'parentexpenseview' AND field = 'cin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(2)','N','parentexpenseview','N','','2','cin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'clawback')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '50',field = 'clawback',col_precision = '' where tablename = 'parentexpenseview' AND field = 'clawback'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(50)','N','parentexpenseview','N','','50','clawback','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'clawbackref')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '20',field = 'clawbackref',col_precision = '' where tablename = 'parentexpenseview' AND field = 'clawbackref'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(20)','N','parentexpenseview','N','','20','clawbackref','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'codefin')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'parentexpenseview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(50)','N','parentexpenseview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'codeser')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '20',field = 'codeser',col_precision = '' where tablename = 'parentexpenseview' AND field = 'codeser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(20)','N','parentexpenseview','N','','20','codeser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'parentexpenseview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(50)','N','parentexpenseview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'ct')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'parentexpenseview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'parentexpenseview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','datetime','','N','System.DateTime','datetime','N','parentexpenseview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'cu')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'parentexpenseview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(64)','N','parentexpenseview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'curramount')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'parentexpenseview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(19,2)','N','parentexpenseview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'deputy')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '100',field = 'deputy',col_precision = '' where tablename = 'parentexpenseview' AND field = 'deputy'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(100)','N','parentexpenseview','N','','100','deputy','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'description')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'parentexpenseview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(150)','N','parentexpenseview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'doc')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'parentexpenseview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(35)','N','parentexpenseview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'docdate')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'parentexpenseview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','smalldatetime','','S','System.DateTime','smalldatetime','N','parentexpenseview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'expiration')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'parentexpenseview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','smalldatetime','','S','System.DateTime','smalldatetime','N','parentexpenseview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'finance')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'parentexpenseview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(150)','N','parentexpenseview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'flag')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'parentexpenseview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','tinyint','','S','System.Byte','tinyint','N','parentexpenseview','N','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'parentexpenseview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(1)','N','parentexpenseview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'iban')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '50',field = 'iban',col_precision = '' where tablename = 'parentexpenseview' AND field = 'iban'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(50)','N','parentexpenseview','N','','50','iban','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'idbank')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '20',field = 'idbank',col_precision = '' where tablename = 'parentexpenseview' AND field = 'idbank'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(20)','N','parentexpenseview','N','','20','idbank','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'idcab')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '20',field = 'idcab',col_precision = '' where tablename = 'parentexpenseview' AND field = 'idcab'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(20)','N','parentexpenseview','N','','20','idcab','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'idclawback')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idclawback',col_precision = '' where tablename = 'parentexpenseview' AND field = 'idclawback'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','parentexpenseview','N','','4','idclawback','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'iddeputy')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'iddeputy',col_precision = '' where tablename = 'parentexpenseview' AND field = 'iddeputy'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','parentexpenseview','N','','4','iddeputy','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'idexp')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'parentexpenseview',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'parentexpenseview' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','N','System.Int32','int','N','parentexpenseview','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'idfin')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'parentexpenseview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','parentexpenseview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'idformerexpense')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idformerexpense',col_precision = '' where tablename = 'parentexpenseview' AND field = 'idformerexpense'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','parentexpenseview','N','','4','idformerexpense','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'idman')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'parentexpenseview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','parentexpenseview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'idpay')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idpay',col_precision = '' where tablename = 'parentexpenseview' AND field = 'idpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','parentexpenseview','N','','4','idpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'parentexpenseview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','parentexpenseview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'idpaymethod')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idpaymethod',col_precision = '' where tablename = 'parentexpenseview' AND field = 'idpaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','parentexpenseview','N','','4','idpaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'idreg')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'parentexpenseview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','parentexpenseview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'idregistrypaymethod')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idregistrypaymethod',col_precision = '' where tablename = 'parentexpenseview' AND field = 'idregistrypaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','parentexpenseview','N','','4','idregistrypaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'idser')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'parentexpenseview' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','parentexpenseview','N','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'idupb')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'parentexpenseview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(36)','N','parentexpenseview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'ivaamount')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '9',field = 'ivaamount',col_precision = '19' where tablename = 'parentexpenseview' AND field = 'ivaamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(19,2)','N','parentexpenseview','N','','9','ivaamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'kpay')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'parentexpenseview' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','parentexpenseview','N','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'lt')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'parentexpenseview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'parentexpenseview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','datetime','','N','System.DateTime','datetime','N','parentexpenseview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'lu')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'parentexpenseview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(64)','N','parentexpenseview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'manager')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'parentexpenseview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(150)','N','parentexpenseview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'nbill')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'nbill',col_precision = '' where tablename = 'parentexpenseview' AND field = 'nbill'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','parentexpenseview','N','','4','nbill','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'nmov')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'parentexpenseview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'parentexpenseview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','N','System.Int32','int','N','parentexpenseview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'npay')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'parentexpenseview' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','parentexpenseview','N','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'nphase')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'parentexpenseview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'parentexpenseview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','tinyint','','N','System.Byte','tinyint','N','parentexpenseview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'parentidexp')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'parentidexp',col_precision = '' where tablename = 'parentexpenseview' AND field = 'parentidexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','parentexpenseview','N','','4','parentidexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'parentexpenseview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','parentexpenseview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'parentexpenseview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','smallint','','S','System.Int16','smallint','N','parentexpenseview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'paymentadate')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '4',field = 'paymentadate',col_precision = '' where tablename = 'parentexpenseview' AND field = 'paymentadate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','smalldatetime','','S','System.DateTime','smalldatetime','N','parentexpenseview','N','','4','paymentadate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'paymentdescr')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '150',field = 'paymentdescr',col_precision = '' where tablename = 'parentexpenseview' AND field = 'paymentdescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(150)','N','parentexpenseview','N','','150','paymentdescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'phase')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'parentexpenseview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(50)','N','parentexpenseview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'refexternaldoc')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(5)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '5',field = 'refexternaldoc',col_precision = '' where tablename = 'parentexpenseview' AND field = 'refexternaldoc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(5)','N','parentexpenseview','N','','5','refexternaldoc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'registry')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'parentexpenseview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(100)','N','parentexpenseview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'service')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'parentexpenseview' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(50)','N','parentexpenseview','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'servicestart')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '8',field = 'servicestart',col_precision = '' where tablename = 'parentexpenseview' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','datetime','','S','System.DateTime','datetime','N','parentexpenseview','N','','8','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'servicestop')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '8',field = 'servicestop',col_precision = '' where tablename = 'parentexpenseview' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','datetime','','S','System.DateTime','datetime','N','parentexpenseview','N','','8','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'totflag')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'parentexpenseview' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','tinyint','','S','System.Byte','tinyint','N','parentexpenseview','N','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'txt')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'text',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'text',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '16',field = 'txt',col_precision = '' where tablename = 'parentexpenseview' AND field = 'txt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','text','','S','System.String','text','N','parentexpenseview','N','','16','txt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'upb')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'parentexpenseview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(150)','N','parentexpenseview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'ymov')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'parentexpenseview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'parentexpenseview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','smallint','','N','System.Int16','smallint','N','parentexpenseview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'parentexpenseview' AND field = 'ypay')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'parentexpenseview',denynull = 'N',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'parentexpenseview' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','smallint','','S','System.Int16','smallint','N','parentexpenseview','N','','2','ypay','')
GO

-- VERIFICA DI parentexpenseview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'parentexpenseview')
UPDATE customobject set isreal = 'N' where objectname = 'parentexpenseview'
ELSE
INSERT INTO customobject (objectname, isreal) values('parentexpenseview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA payedtaxview
IF EXISTS(select * from sysobjects where id = object_id(N'[payedtaxview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [payedtaxview]
GO




--,  15:18:05
CREATE   VIEW [payedtaxview]
(
	cf,
	address,
	cap,
	city,
	country,
	nation,
	location,
	idexp,
	nbracket,
	abatements,
	nphase,
	phase,
	ymov,
	nmov,
	idreg,
	registry,
	expensedescription,
	adate,
	idser,
	codeser,
	service,
	certificatekind,
	servicestart,
	servicestop,
	taxcode,
	taxref,
	description,
	taxkind,
	taxablegross,
	taxablenet,
	employrate,
	employnumerator,
	employdenominator,
	employtax,
	adminrate,
	adminnumerator,
	admindenominator,
	admintax,
	competencydate,
	datetaxpay,
	ytaxpay,
	ntaxpay,
	cu,
	ct,
	lu,
	lt
)
	AS SELECT     
	registry.cf, 
	registryaddress.address, 
	registryaddress.cap, 
	geo_city.title, 
	geo_country.province, 
	geo_nation.title, 
	registryaddress.location,
	expensetax.idexp, 
	expensetax.nbracket, 
	expensetax.abatements,
	expense.nphase, 
	expensephase.description, 
	expense.ymov, 
	expense.nmov, 
	expense.idreg, 
	registry.title, 
	expense.description, 
	expense.adate, 
	expenselast.idser, 
	service.codeser,
	service.description, 
	service.certificatekind, 
	expenselast.servicestart, 
	expenselast.servicestop, 
	expensetax.taxcode, 
	tax.taxref,
	tax.description, 
	tax.taxkind, 
	expensetax.taxablegross, 
	expensetax.taxablenet, 
	expensetax.employrate, 
	expensetax.employnumerator, 
	expensetax.employdenominator, 
	expensetax.employtax, 
	expensetax.adminrate, 
	expensetax.adminnumerator, 
	expensetax.admindenominator, 
	expensetax.admintax, 
	expensetax.competencydate, 
	CASE config.taxvaliditykind 
		WHEN 3 THEN payment.adate 
		WHEN 4 THEN payment.printdate
		WHEN 5 THEN  paymenttransmission.transmissiondate
		WHEN 6 THEN (SELECT MIN(banktransaction.transactiondate)
			FROM banktransaction 
			WHERE banktransaction.kpay=expenselast.kpay)
		-- data ultima fase di spesa
		WHEN 2 THEN expense.adate 
		ELSE expensetax.competencydate
	END,
	expensetax.ytaxpay, 
	expensetax.ntaxpay,
	expensetax.cu, expensetax.ct, expensetax.lu, expensetax.lt
FROM    
     expensetax(NOLOCK) JOIN
     tax(NOLOCK) ON tax.taxcode = expensetax.taxcode JOIN
     expense(NOLOCK) ON expense.idexp = expensetax.idexp JOIN
     expenselast(NOLOCK) ON expense.idexp = expenselast.idexp JOIN
     config(NOLOCK) ON expense.ymov = config.ayear JOIN
     expensephase(NOLOCK) ON expensephase.nphase = expense.nphase LEFT OUTER JOIN
     payment(NOLOCK) ON payment.kpay = expenselast.kpay LEFT OUTER JOIN
     paymenttransmission(NOLOCK) ON paymenttransmission.kpaymenttransmission =  payment.kpaymenttransmission LEFT OUTER JOIN
     registry(NOLOCK) ON registry.idreg = expense.idreg LEFT OUTER JOIN
     service(NOLOCK) ON service.idser = expenselast.idser left outer join
     registryaddress on registry.idreg = registryaddress.idreg left outer join
     geo_city on registryaddress.idcity = geo_city.idcity left outer join
     geo_country on geo_city.idcountry = geo_country.idcountry left outer join
     geo_nation on registryaddress.idnation = geo_nation.idnation
	     where (registryaddress.idaddresskind is null or registryaddress.idaddresskind = 
		(select top 1 idaddresskind 
		   from registryaddress ci
		   join address ON registryaddress.idaddresskind = address.idaddress
		  where ci.idreg = registry.idreg
	       order by case codeaddress
				when '07_SW_DOM' then 1
				when '07_SW_DEF' then 2
				else 3
			end
		) and registryaddress.start = 
		(	select max(start)
			from registryaddress ci2
			where ci2.idreg = registry.idreg
			and ci2.idaddresskind = registryaddress.idaddresskind
		))

GO

-- VERIFICA DI payedtaxview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'payedtaxview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'abatements')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '9',field = 'abatements',col_precision = '19' where tablename = 'payedtaxview' AND field = 'abatements'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','payedtaxview','N','','9','abatements','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'payedtaxview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'payedtaxview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','payedtaxview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'address')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '100',field = 'address',col_precision = '' where tablename = 'payedtaxview' AND field = 'address'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','payedtaxview','N','','100','address','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'admindenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '9',field = 'admindenominator',col_precision = '19' where tablename = 'payedtaxview' AND field = 'admindenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','payedtaxview','N','','9','admindenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'adminnumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '9',field = 'adminnumerator',col_precision = '19' where tablename = 'payedtaxview' AND field = 'adminnumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','payedtaxview','N','','9','adminnumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'adminrate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '9',field = 'adminrate',col_precision = '19' where tablename = 'payedtaxview' AND field = 'adminrate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','payedtaxview','N','','9','adminrate','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'admintax')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '9',field = 'admintax',col_precision = '19' where tablename = 'payedtaxview' AND field = 'admintax'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','payedtaxview','N','','9','admintax','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'cap')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '20',field = 'cap',col_precision = '' where tablename = 'payedtaxview' AND field = 'cap'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','payedtaxview','N','','20','cap','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'certificatekind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '1',field = 'certificatekind',col_precision = '' where tablename = 'payedtaxview' AND field = 'certificatekind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','payedtaxview','N','','1','certificatekind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'cf')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(16)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '16',field = 'cf',col_precision = '' where tablename = 'payedtaxview' AND field = 'cf'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(16)','N','payedtaxview','N','','16','cf','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'city')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(65)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '65',field = 'city',col_precision = '' where tablename = 'payedtaxview' AND field = 'city'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(65)','N','payedtaxview','N','','65','city','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'codeser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '20',field = 'codeser',col_precision = '' where tablename = 'payedtaxview' AND field = 'codeser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','payedtaxview','N','','20','codeser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'competencydate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '4',field = 'competencydate',col_precision = '' where tablename = 'payedtaxview' AND field = 'competencydate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','payedtaxview','N','','4','competencydate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'country')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(2)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '2',field = 'country',col_precision = '' where tablename = 'payedtaxview' AND field = 'country'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(2)','N','payedtaxview','N','','2','country','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'payedtaxview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'payedtaxview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','payedtaxview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'payedtaxview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'payedtaxview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','payedtaxview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'datetaxpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '4',field = 'datetaxpay',col_precision = '' where tablename = 'payedtaxview' AND field = 'datetaxpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','payedtaxview','N','','4','datetaxpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'payedtaxview',denynull = 'S',format = '',col_len = '50',field = 'description',col_precision = '' where tablename = 'payedtaxview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','payedtaxview','S','','50','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'employdenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '9',field = 'employdenominator',col_precision = '19' where tablename = 'payedtaxview' AND field = 'employdenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','payedtaxview','N','','9','employdenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'employnumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '9',field = 'employnumerator',col_precision = '19' where tablename = 'payedtaxview' AND field = 'employnumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','payedtaxview','N','','9','employnumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'employrate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '9',field = 'employrate',col_precision = '19' where tablename = 'payedtaxview' AND field = 'employrate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','payedtaxview','N','','9','employrate','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'employtax')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '9',field = 'employtax',col_precision = '19' where tablename = 'payedtaxview' AND field = 'employtax'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','payedtaxview','N','','9','employtax','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'expensedescription')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'payedtaxview',denynull = 'S',format = '',col_len = '150',field = 'expensedescription',col_precision = '' where tablename = 'payedtaxview' AND field = 'expensedescription'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','payedtaxview','S','','150','expensedescription','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'payedtaxview',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'payedtaxview' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','payedtaxview','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'payedtaxview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','payedtaxview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'payedtaxview' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','payedtaxview','N','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'location')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '50',field = 'location',col_precision = '' where tablename = 'payedtaxview' AND field = 'location'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','payedtaxview','N','','50','location','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'payedtaxview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'payedtaxview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','payedtaxview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'payedtaxview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'payedtaxview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','payedtaxview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'nation')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(65)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '65',field = 'nation',col_precision = '' where tablename = 'payedtaxview' AND field = 'nation'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(65)','N','payedtaxview','N','','65','nation','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'nbracket')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'payedtaxview',denynull = 'S',format = '',col_len = '4',field = 'nbracket',col_precision = '' where tablename = 'payedtaxview' AND field = 'nbracket'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','payedtaxview','S','','4','nbracket','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'payedtaxview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'payedtaxview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','payedtaxview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'payedtaxview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'payedtaxview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','payedtaxview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'ntaxpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '4',field = 'ntaxpay',col_precision = '' where tablename = 'payedtaxview' AND field = 'ntaxpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','payedtaxview','N','','4','ntaxpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'payedtaxview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'payedtaxview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','payedtaxview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'payedtaxview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','payedtaxview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'payedtaxview' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','payedtaxview','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'servicestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '8',field = 'servicestart',col_precision = '' where tablename = 'payedtaxview' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','payedtaxview','N','','8','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'servicestop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '8',field = 'servicestop',col_precision = '' where tablename = 'payedtaxview' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','payedtaxview','N','','8','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'taxablegross')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '9',field = 'taxablegross',col_precision = '19' where tablename = 'payedtaxview' AND field = 'taxablegross'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','payedtaxview','N','','9','taxablegross','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'taxablenet')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '9',field = 'taxablenet',col_precision = '19' where tablename = 'payedtaxview' AND field = 'taxablenet'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','payedtaxview','N','','9','taxablenet','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'taxcode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'payedtaxview',denynull = 'S',format = '',col_len = '4',field = 'taxcode',col_precision = '' where tablename = 'payedtaxview' AND field = 'taxcode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','payedtaxview','S','','4','taxcode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'taxkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'payedtaxview',denynull = 'S',format = '',col_len = '2',field = 'taxkind',col_precision = '' where tablename = 'payedtaxview' AND field = 'taxkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','payedtaxview','S','','2','taxkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'taxref')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'payedtaxview',denynull = 'S',format = '',col_len = '20',field = 'taxref',col_precision = '' where tablename = 'payedtaxview' AND field = 'taxref'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','payedtaxview','S','','20','taxref','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'payedtaxview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'payedtaxview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','payedtaxview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payedtaxview' AND field = 'ytaxpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'payedtaxview',denynull = 'N',format = '',col_len = '2',field = 'ytaxpay',col_precision = '' where tablename = 'payedtaxview' AND field = 'ytaxpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','payedtaxview','N','','2','ytaxpay','')
GO

-- VERIFICA DI payedtaxview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'payedtaxview')
UPDATE customobject set isreal = 'N' where objectname = 'payedtaxview'
ELSE
INSERT INTO customobject (objectname, isreal) values('payedtaxview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA paymentcommunicated
IF EXISTS(select * from sysobjects where id = object_id(N'[paymentcommunicated]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [paymentcommunicated]
GO



CREATE   VIEW [paymentcommunicated]
(
	idexp,
	nphase,
	ymov,
	nmov,
	parentidexp,
	parentymov,
	parentnmov,
	idreg,
	idman,
	kpay,
	ypay,
	npay,
	kpaymenttransmission,
	ypaymenttransmission,
	npaymenttransmission,
	doc,
	docdate,
	description,
	amount,
	curramount,
	idpaymethod,
	iban,
	cin,
	idbank,
	idcab,
	cc,
	iddeputy,
	refexternaldoc,
	paymentdescr,
	idser,
	service,
	codeser,
	servicestart,
	servicestop,
	ivaamount,
	flag,
	totflag,
	flagarrear,
	autokind,
	idpayment,
	expiration,
	adate,
	printdate,
	competencydate,
	cu,
	ct,
	lu,
	lt,idfin,idupb
)
AS
SELECT
	expense.idexp,
	expense.nphase,
	expense.ymov,
	expense.nmov,
	expense.parentidexp,
	parentexpense.ymov,
	parentexpense.nmov,
	expense.idreg,
	expense.idman,
	payment.kpay,
	payment.ypay,
	payment.npay,
	paymenttransmission.kpaymenttransmission,
	paymenttransmission.ypaymenttransmission,
	paymenttransmission.npaymenttransmission,
	expense.doc,
	expense.docdate,
	expense.description,
	expenseyear_starting.amount,
	expensetotal.curramount,
	expenselast.idpaymethod,
	expenselast.iban,
	expenselast.cin,
	expenselast.idbank,
	expenselast.idcab,
	expenselast.cc,
	expenselast.iddeputy,
	expenselast.refexternaldoc,
	expenselast.paymentdescr,
	expenselast.idser,
	service.description,
	service.codeser,
	expenselast.servicestart,
	expenselast.servicestop,
	expenselast.ivaamount,
	expenselast.flag,
	expensetotal.flag,
	CASE
		WHEN ((expensetotal.flag&1)=0) THEN 'C'
		WHEN ((expensetotal.flag&1)=1) THEN 'R'
	END,
	expense.autokind,
	expense.idpayment,
	expense.expiration,
	expense.adate,
	payment.printdate,
	paymenttransmission.transmissiondate,
	expense.cu,
	expense.ct,
	expense.lu,
	expense.lt,
	expenseyear.idfin,expenseyear.idupb
FROM expense 
JOIN expenselast
	ON expenselast.idexp = expense.idexp
JOIN payment 
	ON payment.kpay = expenselast.kpay
JOIN paymenttransmission
	ON paymenttransmission.kpaymenttransmission = payment.kpaymenttransmission
JOIN expenseyear
	ON expense.idexp = expenseyear.idexp
	AND expense.ymov = expenseyear.ayear
JOIN expensetotal
	ON expensetotal.idexp = expenseyear.idexp
	AND expensetotal.ayear = expenseyear.ayear
LEFT OUTER JOIN expense parentexpense
	ON expense.parentidexp = parentexpense.idexp
LEFT OUTER JOIN expensetotal expensetotal_firstyear
	ON expensetotal_firstyear.idexp = expense.idexp
	AND ((expensetotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN expenseyear expenseyear_starting
	ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
	AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
LEFT OUTER JOIN service
	ON service.idser = expenselast.idexp

	

GO

-- VERIFICA DI paymentcommunicated IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'paymentcommunicated'
IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','paymentcommunicated','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'paymentcommunicated' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','paymentcommunicated','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','paymentcommunicated','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'cc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(30)',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '30',field = 'cc',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'cc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(30)','N','paymentcommunicated','N','','30','cc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'cin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(2)',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '2',field = 'cin',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'cin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(2)','N','paymentcommunicated','N','','2','cin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'codeser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '20',field = 'codeser',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'codeser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','paymentcommunicated','N','','20','codeser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'competencydate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '4',field = 'competencydate',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'competencydate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentcommunicated','N','','4','competencydate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','paymentcommunicated','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','paymentcommunicated','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'paymentcommunicated' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','paymentcommunicated','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','paymentcommunicated','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','paymentcommunicated','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentcommunicated','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentcommunicated','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','paymentcommunicated','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','paymentcommunicated','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'iban')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '50',field = 'iban',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'iban'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','paymentcommunicated','N','','50','iban','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'idbank')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '20',field = 'idbank',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'idbank'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','paymentcommunicated','N','','20','idbank','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'idcab')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '20',field = 'idcab',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'idcab'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','paymentcommunicated','N','','20','idcab','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'iddeputy')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '4',field = 'iddeputy',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'iddeputy'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentcommunicated','N','','4','iddeputy','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentcommunicated','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentcommunicated','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentcommunicated','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentcommunicated','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'kpaymenttransmission')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'S',format = '',col_len = '4',field = 'kpaymenttransmission',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'kpaymenttransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentcommunicated','S','','4','kpaymenttransmission','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'idpaymethod')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '4',field = 'idpaymethod',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'idpaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentcommunicated','N','','4','idpaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentcommunicated','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentcommunicated','N','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','paymentcommunicated','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'ivaamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '9',field = 'ivaamount',col_precision = '19' where tablename = 'paymentcommunicated' AND field = 'ivaamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','paymentcommunicated','N','','9','ivaamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'S',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentcommunicated','S','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','paymentcommunicated','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','paymentcommunicated','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentcommunicated','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'S',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentcommunicated','S','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'npaymenttransmission')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'S',format = '',col_len = '4',field = 'npaymenttransmission',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'npaymenttransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentcommunicated','S','','4','npaymenttransmission','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','paymentcommunicated','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'parentidexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '4',field = 'parentidexp',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'parentidexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentcommunicated','N','','4','parentidexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentcommunicated','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','paymentcommunicated','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'paymentdescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '150',field = 'paymentdescr',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'paymentdescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','paymentcommunicated','N','','150','paymentdescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'printdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '4',field = 'printdate',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'printdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentcommunicated','N','','4','printdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'refexternaldoc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(5)',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '5',field = 'refexternaldoc',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'refexternaldoc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(5)','N','paymentcommunicated','N','','5','refexternaldoc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','paymentcommunicated','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'servicestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '8',field = 'servicestart',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','paymentcommunicated','N','','8','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'servicestop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '8',field = 'servicestop',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','paymentcommunicated','N','','8','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'N',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','paymentcommunicated','N','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','paymentcommunicated','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'S',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','paymentcommunicated','S','','2','ypay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentcommunicated' AND field = 'ypaymenttransmission')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentcommunicated',denynull = 'S',format = '',col_len = '2',field = 'ypaymenttransmission',col_precision = '' where tablename = 'paymentcommunicated' AND field = 'ypaymenttransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','paymentcommunicated','S','','2','ypaymenttransmission','')
GO

-- VERIFICA DI paymentcommunicated IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'paymentcommunicated')
UPDATE customobject set isreal = 'N' where objectname = 'paymentcommunicated'
ELSE
INSERT INTO customobject (objectname, isreal) values('paymentcommunicated', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA paymentemitted
IF EXISTS(select * from sysobjects where id = object_id(N'[paymentemitted]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [paymentemitted]
GO




CREATE   VIEW [paymentemitted]
(
	idexp,
	nphase,
	ymov,
	nmov,
	parentidexp,
	parentymov,
	parentnmov,
	idreg,
	idman,
	kpay,
	ypay,
	npay,
	doc,
	docdate,
	description,
	amount,
	curramount,
	flag,
	totflag,
	flagarrear,
	idpaymethod,
	cin,
	idbank,
	idcab,
	cc,
	iddeputy,
	refexternaldoc,
	paymentdescr,
	idser,
	service,
	codeser,
	servicestart,
	servicestop,
	ivaamount,
	autokind,
	idpayment,
	expiration,
	adate,
	competencydate,
	cu,
	ct,
	lu,
	lt,
	idfin,idupb
)
AS SELECT
	expense.idexp,
	expense.nphase,
	expense.ymov,
	expense.nmov,
	expense.parentidexp,
	parentexpense.ymov,
	parentexpense.nmov,
	expense.idreg,
	expense.idman,
	payment.kpay,
	payment.ypay,
	payment.npay,
	expense.doc,
	expense.docdate,
	expense.description,
	expenseyear_starting.amount,
	expensetotal.curramount,
	expenselast.flag,
	expensetotal.flag,
	CASE
		WHEN ((expensetotal.flag&1)=0) THEN 'C'
		WHEN ((expensetotal.flag&1)=1) THEN 'R'
	END, 
	expenselast.idpaymethod,
	expenselast.cin,
	expenselast.idbank,
	expenselast.idcab,
	expenselast.cc,
	expenselast.iddeputy,
	expenselast.refexternaldoc,
	expenselast.paymentdescr,
	expenselast.idser,
	service.description,
	service.codeser,
	expenselast.servicestart,
	expenselast.servicestop,
	expenselast.ivaamount,
	expense.autokind,
	expense.idpayment,
	expense.expiration,
	expense.adate,
	payment.adate, 
	expense.cu,
	expense.ct,
	expense.lu,
	expense.lt,
	expenseyear.idfin,expenseyear.idupb
FROM expense
JOIN expenselast
	ON expenselast.idexp = expense.idexp
JOIN payment
	ON payment.kpay = expenselast.kpay 
JOIN expenseyear
	ON expense.idexp = expenseyear.idexp
	AND expense.ymov = expenseyear.ayear
JOIN expensetotal
	ON expensetotal.idexp = expenseyear.idexp
	AND expensetotal.ayear = expenseyear.ayear
LEFT OUTER JOIN expense parentexpense
	ON expense.parentidexp = parentexpense.idexp
LEFT OUTER JOIN expensetotal expensetotal_firstyear
	ON expensetotal_firstyear.idexp = expense.idexp
	AND ((expensetotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN expenseyear expenseyear_starting
	ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
	AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
LEFT OUTER JOIN service
	ON service.idser = expenselast.idser








GO

-- VERIFICA DI paymentemitted IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'paymentemitted'
IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentemitted',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'paymentemitted' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','paymentemitted','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'paymentemitted' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','paymentemitted','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'paymentemitted' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','paymentemitted','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'cc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(30)',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '30',field = 'cc',col_precision = '' where tablename = 'paymentemitted' AND field = 'cc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(30)','N','paymentemitted','N','','30','cc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'cin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(2)',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '2',field = 'cin',col_precision = '' where tablename = 'paymentemitted' AND field = 'cin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(2)','N','paymentemitted','N','','2','cin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'codeser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '20',field = 'codeser',col_precision = '' where tablename = 'paymentemitted' AND field = 'codeser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','paymentemitted','N','','20','codeser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'competencydate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '4',field = 'competencydate',col_precision = '' where tablename = 'paymentemitted' AND field = 'competencydate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentemitted','N','','4','competencydate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentemitted',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'paymentemitted' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','paymentemitted','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'paymentemitted',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'paymentemitted' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','paymentemitted','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'paymentemitted' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','paymentemitted','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'paymentemitted',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'paymentemitted' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','paymentemitted','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'paymentemitted' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','paymentemitted','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'paymentemitted' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentemitted','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'paymentemitted' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentemitted','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentemitted',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'paymentemitted' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','paymentemitted','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'paymentemitted' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','paymentemitted','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'idbank')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '20',field = 'idbank',col_precision = '' where tablename = 'paymentemitted' AND field = 'idbank'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','paymentemitted','N','','20','idbank','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'idcab')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '20',field = 'idcab',col_precision = '' where tablename = 'paymentemitted' AND field = 'idcab'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','paymentemitted','N','','20','idcab','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'iddeputy')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '4',field = 'iddeputy',col_precision = '' where tablename = 'paymentemitted' AND field = 'iddeputy'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentemitted','N','','4','iddeputy','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentemitted',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'paymentemitted' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentemitted','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'paymentemitted' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentemitted','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'paymentemitted' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentemitted','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'paymentemitted' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentemitted','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'idpaymethod')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '4',field = 'idpaymethod',col_precision = '' where tablename = 'paymentemitted' AND field = 'idpaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentemitted','N','','4','idpaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'paymentemitted' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentemitted','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'paymentemitted' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentemitted','N','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'paymentemitted' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','paymentemitted','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'ivaamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '9',field = 'ivaamount',col_precision = '19' where tablename = 'paymentemitted' AND field = 'ivaamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','paymentemitted','N','','9','ivaamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentemitted',denynull = 'S',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'paymentemitted' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentemitted','S','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentemitted',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'paymentemitted' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','paymentemitted','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'paymentemitted',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'paymentemitted' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','paymentemitted','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentemitted',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'paymentemitted' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentemitted','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentemitted',denynull = 'S',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'paymentemitted' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentemitted','S','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentemitted',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'paymentemitted' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','paymentemitted','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'parentidexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '4',field = 'parentidexp',col_precision = '' where tablename = 'paymentemitted' AND field = 'parentidexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentemitted','N','','4','parentidexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'paymentemitted' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentemitted','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'paymentemitted' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','paymentemitted','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'paymentdescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '150',field = 'paymentdescr',col_precision = '' where tablename = 'paymentemitted' AND field = 'paymentdescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','paymentemitted','N','','150','paymentdescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'refexternaldoc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(5)',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '5',field = 'refexternaldoc',col_precision = '' where tablename = 'paymentemitted' AND field = 'refexternaldoc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(5)','N','paymentemitted','N','','5','refexternaldoc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'paymentemitted' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','paymentemitted','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'servicestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '8',field = 'servicestart',col_precision = '' where tablename = 'paymentemitted' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','paymentemitted','N','','8','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'servicestop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '8',field = 'servicestop',col_precision = '' where tablename = 'paymentemitted' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','paymentemitted','N','','8','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentemitted',denynull = 'N',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'paymentemitted' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','paymentemitted','N','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentemitted',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'paymentemitted' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','paymentemitted','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentemitted' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentemitted',denynull = 'S',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'paymentemitted' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','paymentemitted','S','','2','ypay','')
GO

-- VERIFICA DI paymentemitted IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'paymentemitted')
UPDATE customobject set isreal = 'N' where objectname = 'paymentemitted'
ELSE
INSERT INTO customobject (objectname, isreal) values('paymentemitted', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA paymentlogview
IF EXISTS(select * from sysobjects where id = object_id(N'[paymentlogview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [paymentlogview]
GO



CREATE  VIEW paymentlogview
(
	idexp,
	nphase,
	ymov,
	nmov,
	parentidexp,
	parentymov,
	parentnmov,
	idreg,
	idman,
	kpay,
	ypay,
	npay,
	doc,
	docdate,
	description,
	amount,
	idpaymethod,
	iban,
	cin,
	idbank,
	idcab,
	cc,
	paymentdescr,
	idser,
	service,
	codeser,
	servicestart,
	servicestop,
	ivaamount,
	flag,
	autokind,
	idpayment,
	expiration,
	adate,
	competencydate,
	cu,
	ct,
	lu,
	lt
)
AS SELECT
	expense.idexp,
	expense.nphase,
	expense.ymov,
	expense.nmov,
	expense.parentidexp,
	parentexpense.ymov,
	parentexpense.nmov,
	expense.idreg,
	expense.idman,
	payment.kpay,
	payment.ypay,
	payment.npay,
	expense.doc,
	expense.docdate,
	expense.description,
	expenseyear_starting.amount,
	expenselast.idpaymethod,
	expenselast.iban,
	expenselast.cin,
	expenselast.idbank,
	expenselast.idcab,
	expenselast.cc,
	expenselast.paymentdescr,
	expenselast.idser,
	service.description,
	service.codeser,
	expenselast.servicestart,
	expenselast.servicestop,
	expenselast.ivaamount,
	expenselast.flag,
	expense.autokind,
	expense.idpayment,
	expense.expiration,
	expense.adate,
	CASE config.taxvaliditykind 
		WHEN 1 THEN payment.adate 
		WHEN 2 THEN payment.printdate
		WHEN 4 THEN ( SELECT MIN(banktransaction.transactiondate )
				FROM banktransaction
				WHERE banktransaction.kpay = expenselast.kpay)
		ELSE	paymenttransmission.transmissiondate
	END,
	expense.cu,
	expense.ct,
	expense.lu,
	expense.lt
FROM expense
JOIN expenselast
	ON expense.idexp = expenselast.idexp
LEFT OUTER JOIN config
ON config.ayear = expense.ymov
LEFT OUTER JOIN expense parentexpense
	ON parentexpense.idexp = expense.parentidexp
LEFT OUTER JOIN payment
	ON payment.kpay = expenselast.kpay
LEFT OUTER JOIN paymenttransmission
	ON paymenttransmission.kpaymenttransmission =  payment.kpaymenttransmission 
LEFT OUTER JOIN expensetotal expensetotal_firstyear
		ON expensetotal_firstyear.idexp = expense.idexp
		AND ((expensetotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN expenseyear expenseyear_starting
	ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
		AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
LEFT OUTER JOIN service
	ON service.idser = expenselast.idser




GO

-- VERIFICA DI paymentlogview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'paymentlogview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentlogview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'paymentlogview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','paymentlogview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'paymentlogview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','paymentlogview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'paymentlogview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','paymentlogview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'cc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(30)',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '30',field = 'cc',col_precision = '' where tablename = 'paymentlogview' AND field = 'cc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(30)','N','paymentlogview','N','','30','cc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'cin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(2)',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '2',field = 'cin',col_precision = '' where tablename = 'paymentlogview' AND field = 'cin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(2)','N','paymentlogview','N','','2','cin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'codeser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '20',field = 'codeser',col_precision = '' where tablename = 'paymentlogview' AND field = 'codeser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','paymentlogview','N','','20','codeser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'competencydate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '4',field = 'competencydate',col_precision = '' where tablename = 'paymentlogview' AND field = 'competencydate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentlogview','N','','4','competencydate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentlogview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'paymentlogview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','paymentlogview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'paymentlogview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'paymentlogview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','paymentlogview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'paymentlogview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'paymentlogview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','paymentlogview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'paymentlogview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','paymentlogview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'paymentlogview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentlogview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'paymentlogview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentlogview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentlogview',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'paymentlogview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','paymentlogview','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'iban')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '50',field = 'iban',col_precision = '' where tablename = 'paymentlogview' AND field = 'iban'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','paymentlogview','N','','50','iban','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'idbank')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '20',field = 'idbank',col_precision = '' where tablename = 'paymentlogview' AND field = 'idbank'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','paymentlogview','N','','20','idbank','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'idcab')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '20',field = 'idcab',col_precision = '' where tablename = 'paymentlogview' AND field = 'idcab'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','paymentlogview','N','','20','idcab','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentlogview',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'paymentlogview' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentlogview','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'paymentlogview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentlogview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'paymentlogview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentlogview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'idpaymethod')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '4',field = 'idpaymethod',col_precision = '' where tablename = 'paymentlogview' AND field = 'idpaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentlogview','N','','4','idpaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'paymentlogview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentlogview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'paymentlogview' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentlogview','N','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'ivaamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '9',field = 'ivaamount',col_precision = '19' where tablename = 'paymentlogview' AND field = 'ivaamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','paymentlogview','N','','9','ivaamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'paymentlogview' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentlogview','N','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentlogview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'paymentlogview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','paymentlogview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'paymentlogview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'paymentlogview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','paymentlogview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentlogview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'paymentlogview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentlogview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'paymentlogview' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentlogview','N','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentlogview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'paymentlogview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','paymentlogview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'parentidexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '4',field = 'parentidexp',col_precision = '' where tablename = 'paymentlogview' AND field = 'parentidexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentlogview','N','','4','parentidexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'paymentlogview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentlogview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'paymentlogview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','paymentlogview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'paymentdescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '150',field = 'paymentdescr',col_precision = '' where tablename = 'paymentlogview' AND field = 'paymentdescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','paymentlogview','N','','150','paymentdescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'paymentlogview' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','paymentlogview','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'servicestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '8',field = 'servicestart',col_precision = '' where tablename = 'paymentlogview' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','paymentlogview','N','','8','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'servicestop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '8',field = 'servicestop',col_precision = '' where tablename = 'paymentlogview' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','paymentlogview','N','','8','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentlogview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'paymentlogview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','paymentlogview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentlogview' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentlogview',denynull = 'N',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'paymentlogview' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','paymentlogview','N','','2','ypay','')
GO

-- VERIFICA DI paymentlogview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'paymentlogview')
UPDATE customobject set isreal = 'N' where objectname = 'paymentlogview'
ELSE
INSERT INTO customobject (objectname, isreal) values('paymentlogview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA paymentperformed
IF EXISTS(select * from sysobjects where id = object_id(N'[paymentperformed]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [paymentperformed]
GO






CREATE   VIEW [paymentperformed]
(
	idexp,
	nphase,
	ymov,
	nmov,
	parentidexp,
	parentymov,
	parentnmov,
	idreg,
	idman,
	kpay,
	ypay,
	npay,
	doc,
	docdate,
	description,
	amount,
	curramount,
	idpaymethod,
	iban,
	cin,
	idbank,
	idcab,
	cc,
	iddeputy,
	refexternaldoc,
	paymentdescr,
	idser,
	service,
	codeser,
	servicestart,
	servicestop,
	ivaamount,
	flag,
	totflag,
	flagarrear,
	autokind,
	idpayment,
	expiration,
	adate,
	competencydate,
	cu,
	ct,
	lu,
	lt,
	idfin,idupb
)
AS SELECT
	expense.idexp,
	expense.nphase,
	expense.ymov,
	expense.nmov,
	expense.parentidexp,
	parentexpense.ymov,
	parentexpense.nmov,
	expense.idreg,
	expense.idman,
	payment.kpay,
	payment.ypay,
	payment.npay,
	expense.doc,
	expense.docdate,
	expense.description,
	banktransaction.amount,
	banktransaction.amount,
	expenselast.idpaymethod,
	expenselast.iban,
	expenselast.cin,
	expenselast.idbank,
	expenselast.idcab,
	expenselast.cc,
	expenselast.iddeputy,
	expenselast.refexternaldoc,
	expenselast.paymentdescr,
	expenselast.idser,
	service.description,
	service.codeser,
	expenselast.servicestart,
	expenselast.servicestop,
	expenselast.ivaamount,
	expenselast.flag,
	expensetotal.flag,
	CASE
		when (( expensetotal.flag & 1)=0) then 'C'
		when (( expensetotal.flag & 1)=1) then 'R'
	End,
	expense.autokind,
	expense.idpayment,
	expense.expiration,
	expense.adate,
	banktransaction.transactiondate,
	expense.cu,
	expense.ct,
	expense.lu,
	expense.lt,
	expenseyear.idfin,expenseyear.idupb
FROM expense
JOIN expenseyear
	ON expense.idexp = expenseyear.idexp
	AND expense.ymov = expenseyear.ayear
JOIN expensetotal
	ON expensetotal.idexp = expenseyear.idexp
	AND expensetotal.ayear = expenseyear.ayear
JOIN expenselast
	ON expense.idexp = expenselast.idexp
JOIN payment
	ON payment.kpay = expenselast.kpay
JOIN banktransaction
	ON banktransaction.idexp = expense.idexp
LEFT OUTER JOIN expense parentexpense
	ON expense.parentidexp = parentexpense.idexp
LEFT OUTER JOIN service
	ON service.idser = expenselast.idser


GO

-- VERIFICA DI paymentperformed IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'paymentperformed'
IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentperformed',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'paymentperformed' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','paymentperformed','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'paymentperformed' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','paymentperformed','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'paymentperformed' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','paymentperformed','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'cc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(30)',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '30',field = 'cc',col_precision = '' where tablename = 'paymentperformed' AND field = 'cc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(30)','N','paymentperformed','N','','30','cc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'cin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(2)',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '2',field = 'cin',col_precision = '' where tablename = 'paymentperformed' AND field = 'cin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(2)','N','paymentperformed','N','','2','cin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'codeser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '20',field = 'codeser',col_precision = '' where tablename = 'paymentperformed' AND field = 'codeser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','paymentperformed','N','','20','codeser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'competencydate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '4',field = 'competencydate',col_precision = '' where tablename = 'paymentperformed' AND field = 'competencydate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentperformed','N','','4','competencydate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentperformed',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'paymentperformed' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','paymentperformed','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'paymentperformed',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'paymentperformed' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','paymentperformed','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'paymentperformed' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','paymentperformed','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'paymentperformed',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'paymentperformed' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','paymentperformed','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'paymentperformed' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','paymentperformed','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'paymentperformed' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentperformed','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'paymentperformed' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentperformed','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentperformed',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'paymentperformed' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','paymentperformed','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'paymentperformed' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','paymentperformed','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'iban')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '50',field = 'iban',col_precision = '' where tablename = 'paymentperformed' AND field = 'iban'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','paymentperformed','N','','50','iban','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'idbank')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '20',field = 'idbank',col_precision = '' where tablename = 'paymentperformed' AND field = 'idbank'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','paymentperformed','N','','20','idbank','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'idcab')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '20',field = 'idcab',col_precision = '' where tablename = 'paymentperformed' AND field = 'idcab'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','paymentperformed','N','','20','idcab','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'iddeputy')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '4',field = 'iddeputy',col_precision = '' where tablename = 'paymentperformed' AND field = 'iddeputy'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentperformed','N','','4','iddeputy','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentperformed',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'paymentperformed' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentperformed','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'paymentperformed' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentperformed','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'paymentperformed' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentperformed','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'paymentperformed' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentperformed','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'idpaymethod')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '4',field = 'idpaymethod',col_precision = '' where tablename = 'paymentperformed' AND field = 'idpaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentperformed','N','','4','idpaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'paymentperformed' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentperformed','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'paymentperformed' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentperformed','N','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'paymentperformed' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','paymentperformed','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'ivaamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '9',field = 'ivaamount',col_precision = '19' where tablename = 'paymentperformed' AND field = 'ivaamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','paymentperformed','N','','9','ivaamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentperformed',denynull = 'S',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'paymentperformed' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentperformed','S','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentperformed',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'paymentperformed' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','paymentperformed','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'paymentperformed',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'paymentperformed' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','paymentperformed','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentperformed',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'paymentperformed' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentperformed','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentperformed',denynull = 'S',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'paymentperformed' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentperformed','S','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentperformed',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'paymentperformed' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','paymentperformed','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'parentidexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '4',field = 'parentidexp',col_precision = '' where tablename = 'paymentperformed' AND field = 'parentidexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentperformed','N','','4','parentidexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'paymentperformed' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentperformed','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'paymentperformed' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','paymentperformed','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'paymentdescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '150',field = 'paymentdescr',col_precision = '' where tablename = 'paymentperformed' AND field = 'paymentdescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','paymentperformed','N','','150','paymentdescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'refexternaldoc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(5)',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '5',field = 'refexternaldoc',col_precision = '' where tablename = 'paymentperformed' AND field = 'refexternaldoc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(5)','N','paymentperformed','N','','5','refexternaldoc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'paymentperformed' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','paymentperformed','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'servicestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '8',field = 'servicestart',col_precision = '' where tablename = 'paymentperformed' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','paymentperformed','N','','8','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'servicestop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '8',field = 'servicestop',col_precision = '' where tablename = 'paymentperformed' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','paymentperformed','N','','8','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentperformed',denynull = 'N',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'paymentperformed' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','paymentperformed','N','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentperformed',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'paymentperformed' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','paymentperformed','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentperformed' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentperformed',denynull = 'S',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'paymentperformed' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','paymentperformed','S','','2','ypay','')
GO

-- VERIFICA DI paymentperformed IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'paymentperformed')
UPDATE customobject set isreal = 'N' where objectname = 'paymentperformed'
ELSE
INSERT INTO customobject (objectname, isreal) values('paymentperformed', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA paymentprinted
IF EXISTS(select * from sysobjects where id = object_id(N'[paymentprinted]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [paymentprinted]
GO



CREATE   VIEW [paymentprinted]
(
	idexp,
	nphase,
	ymov,
	nmov,
	parentidexp,
	parentymov,
	parentnmov,
	idreg,
	idman,
	kpay,
	ypay,
	npay,
	doc,
	docdate,
	description,
	amount,
	curramount,
	idpaymethod,
	iban,
	cin,
	idbank,
	idcab,
	cc,
	iddeputy,
	refexternaldoc,
	paymentdescr,
	idser,
	service,
	codeser,
	servicestart,
	servicestop,
	ivaamount,
	flag,
	totflag,
	flagarrear,
	autokind,
	idpayment,
	expiration,
	adate,
	competencydate,
	cu,
	ct,
	lu,
	lt,
	idfin,idupb
)
AS SELECT
	expense.idexp,
	expense.nphase,
	expense.ymov,
	expense.nmov,
	expense.parentidexp,
	parentexpense.ymov,
	parentexpense.nmov,
	expense.idreg,
	expense.idman,
	payment.kpay,
	payment.ypay,
	payment.npay,
	expense.doc,
	expense.docdate,
	expense.description,
	expenseyear_starting.amount,
	expensetotal.curramount,
	expenselast.idpaymethod,
	expenselast.iban,
	expenselast.cin,
	expenselast.idbank,
	expenselast.idcab,
	expenselast.cc,
	expenselast.iddeputy,
	expenselast.refexternaldoc,
	expenselast.paymentdescr,
	expenselast.idser,
	service.description,
	service.codeser,
	expenselast.servicestart,
	expenselast.servicestop,
	expenselast.ivaamount,
	expenselast.flag,
	expensetotal.flag,
	CASE
		WHEN (( expensetotal.flag & 1)=0) THEN 'C'
		WHEN (( expensetotal.flag & 1)=1) THEN 'R'
	END,
	expense.autokind,
	expense.idpayment,
	expense.expiration,
	expense.adate,
	payment.printdate,
	expense.cu,
	expense.ct,
	expense.lu,
	expense.lt,
	expenseyear.idfin,expenseyear.idupb
FROM expense
JOIN expenselast
	ON expense.idexp = expenselast.idexp
JOIN payment
	ON payment.kpay = expenselast.kpay 
JOIN expenseyear
	ON expense.idexp = expenseyear.idexp
	AND expense.ymov = expenseyear.ayear
JOIN expensetotal
	ON expensetotal.idexp = expenseyear.idexp
	AND expensetotal.ayear = expenseyear.ayear
LEFT OUTER JOIN expense parentexpense
	ON expense.parentidexp = parentexpense.idexp
LEFT OUTER JOIN expensetotal expensetotal_firstyear
	ON expensetotal_firstyear.idexp = expense.idexp
	AND ((expensetotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN expenseyear expenseyear_starting
	ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
	AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
LEFT OUTER JOIN service
	ON service.idser = expenselast.idser





GO

-- VERIFICA DI paymentprinted IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'paymentprinted'
IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentprinted',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'paymentprinted' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','paymentprinted','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'paymentprinted' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','paymentprinted','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'paymentprinted' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','paymentprinted','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'cc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(30)',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '30',field = 'cc',col_precision = '' where tablename = 'paymentprinted' AND field = 'cc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(30)','N','paymentprinted','N','','30','cc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'cin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(2)',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '2',field = 'cin',col_precision = '' where tablename = 'paymentprinted' AND field = 'cin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(2)','N','paymentprinted','N','','2','cin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'codeser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '20',field = 'codeser',col_precision = '' where tablename = 'paymentprinted' AND field = 'codeser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','paymentprinted','N','','20','codeser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'competencydate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '4',field = 'competencydate',col_precision = '' where tablename = 'paymentprinted' AND field = 'competencydate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentprinted','N','','4','competencydate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentprinted',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'paymentprinted' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','paymentprinted','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'paymentprinted',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'paymentprinted' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','paymentprinted','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'paymentprinted' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','paymentprinted','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'paymentprinted',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'paymentprinted' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','paymentprinted','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'paymentprinted' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','paymentprinted','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'paymentprinted' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentprinted','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'paymentprinted' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentprinted','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentprinted',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'paymentprinted' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','paymentprinted','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'paymentprinted' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','paymentprinted','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'iban')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '50',field = 'iban',col_precision = '' where tablename = 'paymentprinted' AND field = 'iban'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','paymentprinted','N','','50','iban','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'idbank')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '20',field = 'idbank',col_precision = '' where tablename = 'paymentprinted' AND field = 'idbank'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','paymentprinted','N','','20','idbank','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'idcab')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '20',field = 'idcab',col_precision = '' where tablename = 'paymentprinted' AND field = 'idcab'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','paymentprinted','N','','20','idcab','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'iddeputy')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '4',field = 'iddeputy',col_precision = '' where tablename = 'paymentprinted' AND field = 'iddeputy'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentprinted','N','','4','iddeputy','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentprinted',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'paymentprinted' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentprinted','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'paymentprinted' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentprinted','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'paymentprinted' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentprinted','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'paymentprinted' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentprinted','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'idpaymethod')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '4',field = 'idpaymethod',col_precision = '' where tablename = 'paymentprinted' AND field = 'idpaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentprinted','N','','4','idpaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'paymentprinted' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentprinted','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'paymentprinted' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentprinted','N','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'paymentprinted' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','paymentprinted','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'ivaamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '9',field = 'ivaamount',col_precision = '19' where tablename = 'paymentprinted' AND field = 'ivaamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','paymentprinted','N','','9','ivaamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentprinted',denynull = 'S',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'paymentprinted' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentprinted','S','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentprinted',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'paymentprinted' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','paymentprinted','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'paymentprinted',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'paymentprinted' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','paymentprinted','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentprinted',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'paymentprinted' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentprinted','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentprinted',denynull = 'S',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'paymentprinted' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentprinted','S','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentprinted',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'paymentprinted' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','paymentprinted','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'parentidexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '4',field = 'parentidexp',col_precision = '' where tablename = 'paymentprinted' AND field = 'parentidexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentprinted','N','','4','parentidexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'paymentprinted' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentprinted','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'paymentprinted' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','paymentprinted','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'paymentdescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '150',field = 'paymentdescr',col_precision = '' where tablename = 'paymentprinted' AND field = 'paymentdescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','paymentprinted','N','','150','paymentdescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'refexternaldoc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(5)',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '5',field = 'refexternaldoc',col_precision = '' where tablename = 'paymentprinted' AND field = 'refexternaldoc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(5)','N','paymentprinted','N','','5','refexternaldoc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'paymentprinted' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','paymentprinted','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'servicestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '8',field = 'servicestart',col_precision = '' where tablename = 'paymentprinted' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','paymentprinted','N','','8','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'servicestop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '8',field = 'servicestop',col_precision = '' where tablename = 'paymentprinted' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','paymentprinted','N','','8','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentprinted',denynull = 'N',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'paymentprinted' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','paymentprinted','N','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentprinted',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'paymentprinted' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','paymentprinted','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentprinted' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentprinted',denynull = 'S',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'paymentprinted' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','paymentprinted','S','','2','ypay','')
GO

-- VERIFICA DI paymentprinted IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'paymentprinted')
UPDATE customobject set isreal = 'N' where objectname = 'paymentprinted'
ELSE
INSERT INTO customobject (objectname, isreal) values('paymentprinted', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA paymentsupposed
IF EXISTS(select * from sysobjects where id = object_id(N'[paymentsupposed]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [paymentsupposed]
GO


CREATE  VIEW [paymentsupposed]
(
	ayear,
	idexp,
	nphase,
	description,
	ymov,
	nmov,
	curramount,
	available,
	adate,
	expiration,
	kpay,
	ypay,
	npay,
	paymentadate,
	ypaymenttransmission,
	npaymenttransmission,
	transmissiondate
)
AS
-- Pagamenti trasmessi
	SELECT 
	i1.ayear,
	s1.idexp,
	s1.nphase,
	f1.description,
	s1.ymov,
	s1.nmov,
	i1.curramount,
	NULL,
	s1.adate,
	s1.expiration,
	d1.kpay,
	d1.ypay,
	d1.npay,
	d1.adate,
	t1.ypaymenttransmission,
	t1.npaymenttransmission,
	t1.transmissiondate
	FROM expense s1
	JOIN expenselast l1
	ON l1.idexp = s1.idexp
	JOIN expensetotal i1
	ON s1.idexp = i1.idexp
	JOIN expenseyear i2
	ON i1.idexp = i2.idexp
	AND i1.ayear = i2.ayear
	LEFT OUTER JOIN payment d1
	ON l1.kpay = d1.kpay
	LEFT OUTER JOIN paymenttransmission t1
	ON d1.kpaymenttransmission = t1.kpaymenttransmission
	JOIN expensephase f1
	ON f1.nphase = s1.nphase
	WHERE f1.nphase = (SELECT MAX(nphase) FROM expensephase)
	UNION
	SELECT
	i1.ayear,
	s1.idexp,
	s1.nphase,
	f1.description,
	s1.ymov,
	s1.nmov,
	NULL,
	i1.available,
	s1.adate,
	s1.expiration,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL
	FROM expense s1
	JOIN expensetotal i1
	ON s1.idexp = i1.idexp
	JOIN expenseyear i2
	ON i1.idexp = i2.idexp
	AND i1.ayear = i2.ayear
	JOIN expensephase f1
	ON f1.nphase = s1.nphase
	WHERE i1.available <> 0
	AND f1.nphase >= (SELECT appropriationphasecode FROM config WHERE ayear = i2.ayear)
	AND f1.nphase < (SELECT MAX(nphase) FROM expensephase)

GO

-- VERIFICA DI paymentsupposed IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'paymentsupposed'
IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentsupposed' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentsupposed',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'paymentsupposed' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','paymentsupposed','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentsupposed' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'paymentsupposed',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'paymentsupposed' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','paymentsupposed','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentsupposed' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentsupposed',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'paymentsupposed' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','paymentsupposed','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentsupposed' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'paymentsupposed',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'paymentsupposed' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','paymentsupposed','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentsupposed' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'paymentsupposed',denynull = 'S',format = '',col_len = '50',field = 'description',col_precision = '' where tablename = 'paymentsupposed' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','paymentsupposed','S','','50','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentsupposed' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentsupposed',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'paymentsupposed' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentsupposed','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentsupposed' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentsupposed',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'paymentsupposed' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentsupposed','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentsupposed' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentsupposed',denynull = 'N',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'paymentsupposed' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentsupposed','N','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentsupposed' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentsupposed',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'paymentsupposed' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','paymentsupposed','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentsupposed' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentsupposed',denynull = 'N',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'paymentsupposed' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentsupposed','N','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentsupposed' AND field = 'npaymenttransmission')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymentsupposed',denynull = 'N',format = '',col_len = '4',field = 'npaymenttransmission',col_precision = '' where tablename = 'paymentsupposed' AND field = 'npaymenttransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','paymentsupposed','N','','4','npaymenttransmission','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentsupposed' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'paymentsupposed',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'paymentsupposed' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','paymentsupposed','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentsupposed' AND field = 'paymentadate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentsupposed',denynull = 'N',format = '',col_len = '4',field = 'paymentadate',col_precision = '' where tablename = 'paymentsupposed' AND field = 'paymentadate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentsupposed','N','','4','paymentadate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentsupposed' AND field = 'transmissiondate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymentsupposed',denynull = 'N',format = '',col_len = '4',field = 'transmissiondate',col_precision = '' where tablename = 'paymentsupposed' AND field = 'transmissiondate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymentsupposed','N','','4','transmissiondate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentsupposed' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentsupposed',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'paymentsupposed' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','paymentsupposed','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentsupposed' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentsupposed',denynull = 'N',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'paymentsupposed' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','paymentsupposed','N','','2','ypay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymentsupposed' AND field = 'ypaymenttransmission')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymentsupposed',denynull = 'N',format = '',col_len = '2',field = 'ypaymenttransmission',col_precision = '' where tablename = 'paymentsupposed' AND field = 'ypaymenttransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','paymentsupposed','N','','2','ypaymenttransmission','')
GO

-- VERIFICA DI paymentsupposed IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'paymentsupposed')
UPDATE customobject set isreal = 'N' where objectname = 'paymentsupposed'
ELSE
INSERT INTO customobject (objectname, isreal) values('paymentsupposed', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA paymenttransmissionview
IF EXISTS(select * from sysobjects where id = object_id(N'[paymenttransmissionview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [paymenttransmissionview]
GO


CREATE  VIEW paymenttransmissionview 
	(
	kpaymenttransmission,
	ypaymenttransmission,
  	npaymenttransmission,
	idman,
	manager,
	idtreasurer,
	codetreasurer,
  	transmissiondate,
	total,
 	cu,
  	ct,
  	lu,
  	lt
	)
	AS SELECT
	paymenttransmission.kpaymenttransmission,
	paymenttransmission.ypaymenttransmission,
  	paymenttransmission.npaymenttransmission,
	paymenttransmission.idman,
	manager.title,
	paymenttransmission.idtreasurer,
	treasurer.codetreasurer,
 	paymenttransmission.transmissiondate,
	ISNULL((SELECT SUM(ISNULL(total,0)) FROM paymentview d 
	WHERE d.kpaymenttransmission = paymenttransmission.kpaymenttransmission ),0),
 	paymenttransmission.cu,
  	paymenttransmission.ct,
  	paymenttransmission.lu,
  	paymenttransmission.lt
	FROM paymenttransmission
	LEFT OUTER JOIN manager
	ON manager.idman = paymenttransmission.idman
	LEFT OUTER JOIN treasurer 
	ON treasurer.idtreasurer = paymenttransmission.idtreasurer



GO

-- VERIFICA DI paymenttransmissionview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'paymenttransmissionview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'paymenttransmissionview' AND field = 'codetreasurer')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'paymenttransmissionview',denynull = 'N',format = '',col_len = '20',field = 'codetreasurer',col_precision = '' where tablename = 'paymenttransmissionview' AND field = 'codetreasurer'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','varchar','','S','System.String','varchar(20)','N','paymenttransmissionview','N','','20','codetreasurer','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymenttransmissionview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymenttransmissionview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'paymenttransmissionview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','datetime','','N','System.DateTime','datetime','N','paymenttransmissionview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymenttransmissionview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'paymenttransmissionview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'paymenttransmissionview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','varchar','','N','System.String','varchar(64)','N','paymenttransmissionview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymenttransmissionview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymenttransmissionview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'paymenttransmissionview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','int','','S','System.Int32','int','N','paymenttransmissionview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymenttransmissionview' AND field = 'idtreasurer')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymenttransmissionview',denynull = 'N',format = '',col_len = '4',field = 'idtreasurer',col_precision = '' where tablename = 'paymenttransmissionview' AND field = 'idtreasurer'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','int','','S','System.Int32','int','N','paymenttransmissionview','N','','4','idtreasurer','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymenttransmissionview' AND field = 'kpaymenttransmission')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymenttransmissionview',denynull = 'S',format = '',col_len = '4',field = 'kpaymenttransmission',col_precision = '' where tablename = 'paymenttransmissionview' AND field = 'kpaymenttransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','N','System.Int32','int','N','paymenttransmissionview','S','','4','kpaymenttransmission','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymenttransmissionview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'paymenttransmissionview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'paymenttransmissionview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','datetime','','N','System.DateTime','datetime','N','paymenttransmissionview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymenttransmissionview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'paymenttransmissionview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'paymenttransmissionview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','varchar','','N','System.String','varchar(64)','N','paymenttransmissionview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymenttransmissionview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'paymenttransmissionview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'paymenttransmissionview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','varchar','','S','System.String','varchar(150)','N','paymenttransmissionview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymenttransmissionview' AND field = 'npaymenttransmission')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'paymenttransmissionview',denynull = 'S',format = '',col_len = '4',field = 'npaymenttransmission',col_precision = '' where tablename = 'paymenttransmissionview' AND field = 'npaymenttransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','int','','N','System.Int32','int','N','paymenttransmissionview','S','','4','npaymenttransmission','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymenttransmissionview' AND field = 'total')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'paymenttransmissionview',denynull = 'S',format = '',col_len = '17',field = 'total',col_precision = '38' where tablename = 'paymenttransmissionview' AND field = 'total'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','N','System.Decimal','decimal(38,2)','N','paymenttransmissionview','S','','17','total','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymenttransmissionview' AND field = 'transmissiondate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'paymenttransmissionview',denynull = 'N',format = '',col_len = '4',field = 'transmissiondate',col_precision = '' where tablename = 'paymenttransmissionview' AND field = 'transmissiondate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','smalldatetime','','S','System.DateTime','smalldatetime','N','paymenttransmissionview','N','','4','transmissiondate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'paymenttransmissionview' AND field = 'ypaymenttransmission')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'paymenttransmissionview',denynull = 'S',format = '',col_len = '2',field = 'ypaymenttransmission',col_precision = '' where tablename = 'paymenttransmissionview' AND field = 'ypaymenttransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','smallint','','N','System.Int16','smallint','N','paymenttransmissionview','S','','2','ypaymenttransmission','')
GO

-- VERIFICA DI paymenttransmissionview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'paymenttransmissionview')
UPDATE customobject set isreal = 'N' where objectname = 'paymenttransmissionview'
ELSE
INSERT INTO customobject (objectname, isreal) values('paymenttransmissionview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --




-- CREAZIONE VISTA payment_bankview
IF EXISTS(select * from sysobjects where id = object_id(N'[payment_bankview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [payment_bankview]
GO




CREATE  VIEW payment_bankview
(
	kpay,
	ypay,
	npay,
	idpay,
	idreg,
	registry,
	description,
	amount,
	ct,
	cu,
	lt,
	lu
)
AS SELECT
	payment.kpay,
	payment.ypay,
	payment.npay,
	PB.idpay,
	PB.idreg,
	R.title,
	PB.description,
	PB.amount,
	PB.ct,
	PB.cu,
	PB.lt,
	PB.lu
FROM payment_bank PB
JOIN payment
	ON PB.kpay = payment.kpay
JOIN registry R
	ON R.idreg = PB.idreg






GO

-- VERIFICA DI payment_bankview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'payment_bankview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'payment_bankview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'payment_bankview',denynull = 'S',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'payment_bankview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','N','System.Decimal','decimal(19,2)','N','payment_bankview','S','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payment_bankview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'payment_bankview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'payment_bankview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','datetime','','N','System.DateTime','datetime','N','payment_bankview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payment_bankview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'payment_bankview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'payment_bankview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','varchar','','N','System.String','varchar(64)','N','payment_bankview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payment_bankview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(200)',iskey = 'N',tablename = 'payment_bankview',denynull = 'N',format = '',col_len = '200',field = 'description',col_precision = '' where tablename = 'payment_bankview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','varchar','','S','System.String','varchar(200)','N','payment_bankview','N','','200','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payment_bankview' AND field = 'idpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'payment_bankview',denynull = 'S',format = '',col_len = '4',field = 'idpay',col_precision = '' where tablename = 'payment_bankview' AND field = 'idpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','int','','N','System.Int32','int','N','payment_bankview','S','','4','idpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payment_bankview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'payment_bankview',denynull = 'S',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'payment_bankview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','int','','N','System.Int32','int','N','payment_bankview','S','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payment_bankview' AND field = 'kpay')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'payment_bankview',denynull = 'S',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'payment_bankview' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','N','System.Int32','int','N','payment_bankview','S','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payment_bankview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'payment_bankview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'payment_bankview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','datetime','','N','System.DateTime','datetime','N','payment_bankview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payment_bankview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'payment_bankview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'payment_bankview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','varchar','','N','System.String','varchar(64)','N','payment_bankview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payment_bankview' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'payment_bankview',denynull = 'S',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'payment_bankview' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','int','','N','System.Int32','int','N','payment_bankview','S','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payment_bankview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'payment_bankview',denynull = 'S',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'payment_bankview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','varchar','','N','System.String','varchar(100)','N','payment_bankview','S','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'payment_bankview' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''SARA''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'payment_bankview',denynull = 'S',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'payment_bankview' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''SARA''','','smallint','','N','System.Int16','smallint','N','payment_bankview','S','','2','ypay','')
GO

-- VERIFICA DI payment_bankview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'payment_bankview')
UPDATE customobject set isreal = 'N' where objectname = 'payment_bankview'
ELSE
INSERT INTO customobject (objectname, isreal) values('payment_bankview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --



-- CREAZIONE VISTA pettycashexpenseview
IF EXISTS(select * from sysobjects where id = object_id(N'[pettycashexpenseview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [pettycashexpenseview]
GO


CREATE   VIEW pettycashexpenseview 
(
	yoperation,
	noperation,
	idpettycash,
	pettycode,
	pettycash,
	idexp,
	nphase,
	phase,
	ymov,
	nmov,
	parentidexp,
	parentymov,
	parentnmov,
	ayear,
	idfin,
	codefin,
	finance,
	idupb,
	codeupb,
	upb,
	idreg,
	registry,
	idman,
	manager,
	kpay,
	ypay,
	npay,
	doc,
	docdate,
	description,
	amount,
	ayearstartamount,
	curramount,
	available,
	idpaymethod,
	iban,
	cin,
	idbank,
	idcab,
	cc,
	paymentdescr,
	idser,
	service,
	servicestart,
	servicestop,
	ivaamount,
	flag,
	autokind,
	idpayment,
	totflag,
	flagarrear,
	expiration,
	adate,
	cu,
	ct,
	lu,
	lt
)
	AS SELECT
	pettycashexpense.yoperation,
	pettycashexpense.noperation,
	pettycashexpense.idpettycash,
	pettycash.pettycode,
	pettycash.description,
	expense.idexp,
	expense.nphase,
	expensephase.description,
	expense.ymov,
	expense.nmov,
	expense.parentidexp,
	parentexpense.ymov,
	parentexpense.nmov,
	expenseyear.ayear,
	expenseyear.idfin,
	fin.codefin,
	fin.title,
	expenseyear.idupb,
	upb.codeupb,
	upb.title,
	expense.idreg,
	registry.title,
	expense.idman,
	manager.title,
	payment.kpay,
	payment.ypay,
	payment.npay,
	expense.doc,
	expense.docdate,
	expense.description,
	expenseyear_starting.amount,
	expenseyear.amount,
	expensetotal.curramount,
	expensetotal.available,
	expenselast.idpaymethod,
	expenselast.iban,
	expenselast.cin,
	expenselast.idbank,
	expenselast.idcab,
	expenselast.cc,
	expenselast.paymentdescr,
	expenselast.idser,
	service.description,
	expenselast.servicestart,
	expenselast.servicestop,
	expenselast.ivaamount,
	expenselast.flag,
	expense.autokind,
	expense.idpayment,
	expensetotal.flag,
	CASE
		when ((expensetotal.flag & 1)=0) then 'C'
		when ((expensetotal.flag & 1)=1) then 'R'
	End,
	expense.expiration,
	expense.adate,
	pettycashexpense.cu,
	pettycashexpense.ct,
	pettycashexpense.lu,
	pettycashexpense.lt
FROM pettycashexpense
JOIN pettycash
	ON pettycash.idpettycash = pettycashexpense.idpettycash
JOIN expense
	ON pettycashexpense.idexp = expense.idexp
JOIN expensephase
	ON expensephase.nphase = expense.nphase
JOIN expenseyear
	ON expenseyear.idexp = expense.idexp
JOIN expensetotal
	ON expensetotal.idexp = expenseyear.idexp
	AND expensetotal.ayear = expenseyear.ayear
LEFT OUTER JOIN expense parentexpense
	ON parentexpense.idexp = expense.parentidexp
LEFT OUTER JOIN expenselast
	ON expense.idexp = expenselast.idexp
LEFT OUTER JOIN payment
	ON payment.kpay = expenselast.kpay
LEFT OUTER JOIN expensetotal expensetotal_firstyear
	ON expensetotal_firstyear.idexp = expense.idexp
	AND ((expensetotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN expenseyear expenseyear_starting
	ON expenseyear_starting.idexp =expensetotal_firstyear.idexp
	AND expenseyear_starting.ayear =expensetotal_firstyear.ayear
LEFT OUTER JOIN fin 
	ON fin.idfin = expenseyear.idfin
LEFT OUTER JOIN registry 
	ON registry.idreg = expense.idreg
LEFT OUTER JOIN manager 
	ON manager.idman = expense.idman
LEFT OUTER JOIN service 
	ON service.idser = expenselast.idser
LEFT OUTER JOIN upb
	ON upb.idupb = expenseyear.idupb




GO

-- VERIFICA DI pettycashexpenseview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'pettycashexpenseview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','pettycashexpenseview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'pettycashexpenseview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','pettycashexpenseview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','pettycashexpenseview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'pettycashexpenseview' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','pettycashexpenseview','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','pettycashexpenseview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'ayearstartamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '9',field = 'ayearstartamount',col_precision = '19' where tablename = 'pettycashexpenseview' AND field = 'ayearstartamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','pettycashexpenseview','N','','9','ayearstartamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'cc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(30)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '30',field = 'cc',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'cc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(30)','N','pettycashexpenseview','N','','30','cc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'cin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(2)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '2',field = 'cin',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'cin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(2)','N','pettycashexpenseview','N','','2','cin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','pettycashexpenseview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','pettycashexpenseview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','pettycashexpenseview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','pettycashexpenseview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'pettycashexpenseview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','pettycashexpenseview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','pettycashexpenseview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','pettycashexpenseview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','pettycashexpenseview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','pettycashexpenseview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','pettycashexpenseview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','pettycashexpenseview','N','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','pettycashexpenseview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'iban')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '50',field = 'iban',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'iban'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','pettycashexpenseview','N','','50','iban','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'idbank')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '20',field = 'idbank',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'idbank'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','pettycashexpenseview','N','','20','idbank','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'idcab')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '20',field = 'idcab',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'idcab'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','pettycashexpenseview','N','','20','idcab','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','pettycashexpenseview','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashexpenseview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashexpenseview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashexpenseview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'idpaymethod')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idpaymethod',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'idpaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashexpenseview','N','','4','idpaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'idpettycash')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'S',format = '',col_len = '4',field = 'idpettycash',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'idpettycash'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','pettycashexpenseview','S','','4','idpettycash','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashexpenseview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashexpenseview','N','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','pettycashexpenseview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'ivaamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '9',field = 'ivaamount',col_precision = '19' where tablename = 'pettycashexpenseview' AND field = 'ivaamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','pettycashexpenseview','N','','9','ivaamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashexpenseview','N','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','pettycashexpenseview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','pettycashexpenseview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','pettycashexpenseview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','pettycashexpenseview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'noperation')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'S',format = '',col_len = '4',field = 'noperation',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'noperation'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','pettycashexpenseview','S','','4','noperation','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashexpenseview','N','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','pettycashexpenseview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'parentidexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '4',field = 'parentidexp',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'parentidexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashexpenseview','N','','4','parentidexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashexpenseview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','pettycashexpenseview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'paymentdescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '150',field = 'paymentdescr',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'paymentdescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','pettycashexpenseview','N','','150','paymentdescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'pettycash')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'S',format = '',col_len = '50',field = 'pettycash',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'pettycash'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','pettycashexpenseview','S','','50','pettycash','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'pettycode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '20',field = 'pettycode',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'pettycode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','pettycashexpenseview','N','','20','pettycode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','pettycashexpenseview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','pettycashexpenseview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','pettycashexpenseview','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'servicestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '8',field = 'servicestart',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','pettycashexpenseview','N','','8','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'servicestop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '8',field = 'servicestop',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','pettycashexpenseview','N','','8','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','pettycashexpenseview','N','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','pettycashexpenseview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','pettycashexpenseview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'yoperation')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'S',format = '',col_len = '2',field = 'yoperation',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'yoperation'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','pettycashexpenseview','S','','2','yoperation','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashexpenseview' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'pettycashexpenseview',denynull = 'N',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'pettycashexpenseview' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','pettycashexpenseview','N','','2','ypay','')
GO

-- VERIFICA DI pettycashexpenseview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'pettycashexpenseview')
UPDATE customobject set isreal = 'N' where objectname = 'pettycashexpenseview'
ELSE
INSERT INTO customobject (objectname, isreal) values('pettycashexpenseview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA pettycashincomeview
IF EXISTS(select * from sysobjects where id = object_id(N'[pettycashincomeview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [pettycashincomeview]
GO





CREATE   VIEW pettycashincomeview 
(
	yoperation,
	noperation,
	idpettycash,
	pettycode,
	pettycash,
	idinc,
	nphase,
	phase,
	ymov,
	nmov,
	parentidinc,
	parentymov,
	parentnmov,
	ayear,
	idfin,
	codefin,
	finance,
	idupb,
	codeupb,
	upb,
	idreg,
	registry,
	idman,
	manager,
	kpro,
	ypro,
	npro,
	doc,
	docdate,
	description,
	amount,
	ayearstartamount,
	curramount,
	available,
	flag,
	idpayment,
	totflag,
	flagarrear,
	expiration,
	adate,
	cu,
	ct,
	lu,
	lt
)
AS SELECT
	pettycashincome.yoperation,
	pettycashincome.noperation,
	pettycashincome.idpettycash,
	pettycash.pettycode,
	pettycash.description,
	income.idinc,
	income.nphase,
	incomephase.description,
	income.ymov,
	income.nmov,
	income.parentidinc,
	parentincome.ymov,
	parentincome.nmov,
	incomeyear.ayear,
	incomeyear.idfin,
	fin.codefin,
	fin.title,
	incomeyear.idupb,
	upb.codeupb,
	upb.title,
	income.idreg,
	registry.title,
	income.idman,
	manager.title,
	proceeds.kpro,
	proceeds.ypro,
	proceeds.npro,
	income.doc,
	income.docdate,
	income.description,
	incomeyear_starting.amount,
	incomeyear.amount,
	incometotal.curramount,
	incometotal.available,
	incomelast.flag, 
	income.idpayment,
	incometotal.flag,
	CASE
		when ((incometotal.flag & 1)=0) then 'C'
		when ((incometotal.flag & 1)=1) then 'R'
	End,
	income.expiration,
	income.adate,
	pettycashincome.cu,
	pettycashincome.ct,
	pettycashincome.lu,
	pettycashincome.lt
FROM pettycashincome
JOIN pettycash
	ON pettycash.idpettycash = pettycashincome.idpettycash
JOIN income
	ON pettycashincome.idinc = income.idinc
JOIN incomephase
	ON incomephase.nphase = income.nphase
JOIN incomeyear
	ON incomeyear.idinc = income.idinc
JOIN incometotal
	ON incometotal.idinc = incomeyear.idinc
	AND incometotal.ayear = incomeyear.ayear
LEFT OUTER JOIN income parentincome
	ON parentincome.idinc = income.parentidinc
LEFT OUTER JOIN incomelast
	ON income.idinc = incomelast.idinc
LEFT OUTER JOIN proceeds
	ON proceeds.kpro = incomelast.kpro
LEFT OUTER JOIN incometotal incometotal_firstyear
	ON incometotal_firstyear.idinc = income.idinc
	AND ((incometotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN incomeyear incomeyear_starting
	ON incomeyear_starting.idinc =incometotal_firstyear.idinc
	AND incomeyear_starting.ayear =incometotal_firstyear.ayear
LEFT OUTER JOIN fin
	ON fin.idfin = incomeyear.idfin
LEFT OUTER JOIN registry
	ON registry.idreg = income.idreg
LEFT OUTER JOIN manager
	ON manager.idman = income.idman
LEFT OUTER JOIN upb
	ON upb.idupb = incomeyear.idupb





GO

-- VERIFICA DI pettycashincomeview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'pettycashincomeview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','pettycashincomeview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'pettycashincomeview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','pettycashincomeview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'pettycashincomeview' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','pettycashincomeview','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','pettycashincomeview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'ayearstartamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '9',field = 'ayearstartamount',col_precision = '19' where tablename = 'pettycashincomeview' AND field = 'ayearstartamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','pettycashincomeview','N','','9','ayearstartamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','pettycashincomeview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','pettycashincomeview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','pettycashincomeview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','pettycashincomeview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'pettycashincomeview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','pettycashincomeview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','pettycashincomeview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','pettycashincomeview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','pettycashincomeview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','pettycashincomeview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','pettycashincomeview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','pettycashincomeview','N','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','pettycashincomeview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashincomeview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'idinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'S',format = '',col_len = '4',field = 'idinc',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'idinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','pettycashincomeview','S','','4','idinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashincomeview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashincomeview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'idpettycash')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'S',format = '',col_len = '4',field = 'idpettycash',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'idpettycash'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','pettycashincomeview','S','','4','idpettycash','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashincomeview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','pettycashincomeview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'kpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '4',field = 'kpro',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'kpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashincomeview','N','','4','kpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','pettycashincomeview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','pettycashincomeview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','pettycashincomeview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','pettycashincomeview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'noperation')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'S',format = '',col_len = '4',field = 'noperation',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'noperation'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','pettycashincomeview','S','','4','noperation','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','pettycashincomeview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'npro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '4',field = 'npro',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'npro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashincomeview','N','','4','npro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'parentidinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '4',field = 'parentidinc',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'parentidinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashincomeview','N','','4','parentidinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashincomeview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','pettycashincomeview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'pettycash')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'S',format = '',col_len = '50',field = 'pettycash',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'pettycash'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','pettycashincomeview','S','','50','pettycash','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'pettycode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '20',field = 'pettycode',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'pettycode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','pettycashincomeview','N','','20','pettycode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','pettycashincomeview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','pettycashincomeview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'S',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','pettycashincomeview','S','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','pettycashincomeview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','pettycashincomeview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'yoperation')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'S',format = '',col_len = '2',field = 'yoperation',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'yoperation'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','pettycashincomeview','S','','2','yoperation','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashincomeview' AND field = 'ypro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'pettycashincomeview',denynull = 'N',format = '',col_len = '2',field = 'ypro',col_precision = '' where tablename = 'pettycashincomeview' AND field = 'ypro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','pettycashincomeview','N','','2','ypro','')
GO

-- VERIFICA DI pettycashincomeview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'pettycashincomeview')
UPDATE customobject set isreal = 'N' where objectname = 'pettycashincomeview'
ELSE
INSERT INTO customobject (objectname, isreal) values('pettycashincomeview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA pettycashopitinerationview
IF EXISTS(select * from sysobjects where id = object_id(N'[pettycashopitinerationview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [pettycashopitinerationview]
GO



CREATE  VIEW [pettycashopitinerationview]
(
	iditineration,
	yitineration,
	nitineration,
	movkind,
	idpettycash,
	pettycash,
	pettycode,
	yoperation,
	noperation,
	idaccmotive_cost,
	codemotive_cost,
	motive_cost,
	idaccmotive_debit,
	codemotive_debit,
	motive_debit,
	idfin,
	codefin,
	finance,
	idupb,
	codeupb,
	upb,
	idreg,
	registry,
	idman,
	manager,
	doc,
	docdate,
	description,
	amount,
	idser,
	service,
	codeser,
	servicestart,
	servicestop,
	adate,
	idsor1,
	idsor2,
	idsor3,
	cu,
	ct,
	lu,
	lt
)
AS SELECT
	itineration.iditineration,
	itineration.yitineration,
	itineration.nitineration,
	PCOI.movkind,
	PCO.idpettycash,
	pettycash.description,
	pettycash.pettycode,
	PCO.yoperation,
	PCO.noperation,
	PCO.idaccmotive_cost,
	AMC.codemotive,
	AMC.title,
	PCO.idaccmotive_debit,
	AMD.codemotive,
	AMD.title,
	PCO.idfin,
	fin.codefin,
	fin.title,
	PCO.idupb,
	upb.codeupb,
	upb.title,
	PCO.idreg,
	registry.title,
	PCO.idman,
	manager.title,
	PCO.doc,
	PCO.docdate,
	PCO.description,
	PCO.amount,
	itineration.idser,
	service.description,
	service.codeser,
	itineration.start,
	itineration.stop,
	itineration.adate,
	PCO.idsor1,
	PCO.idsor2,
	PCO.idsor3,
	PCOI.cu,
	PCOI.ct,
	PCOI.lu,
	PCOI.lt
FROM pettycashoperationitineration PCOI
JOIN pettycash
	ON pettycash.idpettycash = PCOI.idpettycash
JOIN pettycashoperation PCO
	ON PCO.idpettycash = PCOI.idpettycash
	AND PCO.yoperation = PCOI.yoperation
	AND PCO.noperation = PCOI.noperation
JOIN itineration
	ON itineration.iditineration = PCOI.iditineration
LEFT OUTER JOIN fin
	ON fin.idfin = PCO.idfin
LEFT OUTER JOIN upb
	ON upb.idupb = PCO.idupb
LEFT OUTER JOIN registry
	ON registry.idreg = PCO.idreg
LEFT OUTER JOIN manager
	ON manager.idman = PCO.idman
LEFT OUTER JOIN service
	ON service.idser = itineration.idser
LEFT OUTER JOIN accmotive AMC
	ON AMC.idaccmotive = PCO.idaccmotive_cost
LEFT OUTER JOIN accmotive AMD
	ON AMD.idaccmotive = PCO.idaccmotive_debit




GO

-- VERIFICA DI pettycashopitinerationview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'pettycashopitinerationview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','pettycashopitinerationview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'pettycashopitinerationview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','pettycashopitinerationview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','pettycashopitinerationview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'codemotive_cost')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '50',field = 'codemotive_cost',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'codemotive_cost'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','pettycashopitinerationview','N','','50','codemotive_cost','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'codemotive_debit')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '50',field = 'codemotive_debit',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'codemotive_debit'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','pettycashopitinerationview','N','','50','codemotive_debit','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'codeser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '20',field = 'codeser',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'codeser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','pettycashopitinerationview','N','','20','codeser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','pettycashopitinerationview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','pettycashopitinerationview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','pettycashopitinerationview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(200)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'S',format = '',col_len = '200',field = 'description',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(200)','N','pettycashopitinerationview','S','','200','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','pettycashopitinerationview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','pettycashopitinerationview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','pettycashopitinerationview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'idaccmotive_cost')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '36',field = 'idaccmotive_cost',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'idaccmotive_cost'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','pettycashopitinerationview','N','','36','idaccmotive_cost','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'idaccmotive_debit')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '36',field = 'idaccmotive_debit',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'idaccmotive_debit'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','pettycashopitinerationview','N','','36','idaccmotive_debit','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashopitinerationview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'iditineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'S',format = '',col_len = '4',field = 'iditineration',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'iditineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','pettycashopitinerationview','S','','4','iditineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashopitinerationview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'idpettycash')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'S',format = '',col_len = '4',field = 'idpettycash',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'idpettycash'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','pettycashopitinerationview','S','','4','idpettycash','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashopitinerationview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'S',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','pettycashopitinerationview','S','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'idsor1')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '4',field = 'idsor1',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'idsor1'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashopitinerationview','N','','4','idsor1','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'idsor2')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '4',field = 'idsor2',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'idsor2'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashopitinerationview','N','','4','idsor2','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'idsor3')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '4',field = 'idsor3',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'idsor3'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','pettycashopitinerationview','N','','4','idsor3','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','pettycashopitinerationview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','pettycashopitinerationview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','pettycashopitinerationview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','pettycashopitinerationview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'motive_cost')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '150',field = 'motive_cost',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'motive_cost'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','pettycashopitinerationview','N','','150','motive_cost','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'motive_debit')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '150',field = 'motive_debit',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'motive_debit'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','pettycashopitinerationview','N','','150','motive_debit','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'movkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'S',format = '',col_len = '2',field = 'movkind',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'movkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','pettycashopitinerationview','S','','2','movkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'nitineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'S',format = '',col_len = '4',field = 'nitineration',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'nitineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','pettycashopitinerationview','S','','4','nitineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'noperation')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'S',format = '',col_len = '4',field = 'noperation',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'noperation'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','pettycashopitinerationview','S','','4','noperation','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'pettycash')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'S',format = '',col_len = '50',field = 'pettycash',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'pettycash'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','pettycashopitinerationview','S','','50','pettycash','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'pettycode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '20',field = 'pettycode',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'pettycode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','pettycashopitinerationview','N','','20','pettycode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','pettycashopitinerationview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','pettycashopitinerationview','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'servicestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'S',format = '',col_len = '4',field = 'servicestart',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','pettycashopitinerationview','S','','4','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'servicestop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'S',format = '',col_len = '4',field = 'servicestop',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','pettycashopitinerationview','S','','4','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','pettycashopitinerationview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'yitineration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'S',format = '',col_len = '2',field = 'yitineration',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'yitineration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','pettycashopitinerationview','S','','2','yitineration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'pettycashopitinerationview' AND field = 'yoperation')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'pettycashopitinerationview',denynull = 'S',format = '',col_len = '2',field = 'yoperation',col_precision = '' where tablename = 'pettycashopitinerationview' AND field = 'yoperation'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','pettycashopitinerationview','S','','2','yoperation','')
GO

-- VERIFICA DI pettycashopitinerationview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'pettycashopitinerationview')
UPDATE customobject set isreal = 'N' where objectname = 'pettycashopitinerationview'
ELSE
INSERT INTO customobject (objectname, isreal) values('pettycashopitinerationview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA proceedscommunicated
IF EXISTS(select * from sysobjects where id = object_id(N'[proceedscommunicated]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [proceedscommunicated]
GO





CREATE   VIEW [proceedscommunicated]
(
	idinc,
	nphase,
	ymov,
	nmov,
	parentidinc,
	parentymov,
	parentnmov,
	idreg,
	idman,
	kpro,
	ypro,
	npro,
	kproceedstransmission,
	yproceedstransmission,
	nproceedstransmission,
	doc,
	docdate,
	description,
	amount,
	curramount,
	totflag,
	flagarrear,
	flag,	
	autokind,
	idpayment,
	expiration,
	adate,
	printdate,
	competencydate,
	cu,
	ct,
	lu,
	lt,idfin,idupb
)
AS SELECT
	income.idinc,
	income.nphase,
	income.ymov,
	income.nmov,
	income.parentidinc,
	parentincome.ymov,
	parentincome.nmov,
	income.idreg,
	income.idman,
	proceeds.kpro,
	proceeds.ypro,
	proceeds.npro, 
	proceedstransmission.kproceedstransmission,
	proceedstransmission.yproceedstransmission,
	proceedstransmission.nproceedstransmission,
	income.doc,
	income.docdate,
	income.description,
	incomeyear_starting.amount,
	incometotal.curramount,
	incometotal.flag, 
	CASE
		WHEN ((incometotal.flag&1)=0) THEN 'C'
		WHEN ((incometotal.flag&1)=1) THEN 'R'
	END, 	
	incomelast.flag,
	income.autokind,
	income.idpayment,
	income.expiration,
	income.adate,
	proceeds.printdate,
	proceedstransmission.transmissiondate,
	income.cu,
	income.ct,
	income.lu,
	income.lt,
	incomeyear.idfin,
	incomeyear.idupb
FROM income
JOIN incomelast
	ON incomelast.idinc = income.idinc
JOIN proceeds
	ON proceeds.kpro = incomelast.kpro 
JOIN proceedstransmission
	ON proceedstransmission.kproceedstransmission = proceeds.kproceedstransmission
JOIN incomeyear
	ON income.idinc = incomeyear.idinc
	AND income.ymov = incomeyear.ayear
JOIN incometotal
	ON incometotal.idinc = incomeyear.idinc
	AND incometotal.ayear = incomeyear.ayear
LEFT OUTER JOIN income parentincome
	ON income.parentidinc = parentincome.idinc
LEFT OUTER JOIN incometotal incometotal_firstyear(NOLOCK)
	ON incometotal_firstyear.idinc = income.idinc
	AND ((incometotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN incomeyear incomeyear_starting(NOLOCK) 
	ON incomeyear_starting.idinc = incometotal_firstyear.idinc
	AND incomeyear_starting.ayear = incometotal_firstyear.ayear




GO

-- VERIFICA DI proceedscommunicated IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'proceedscommunicated'
IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','proceedscommunicated','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'proceedscommunicated' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','proceedscommunicated','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','proceedscommunicated','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'competencydate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'N',format = '',col_len = '4',field = 'competencydate',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'competencydate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedscommunicated','N','','4','competencydate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','proceedscommunicated','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','proceedscommunicated','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'proceedscommunicated' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','proceedscommunicated','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','proceedscommunicated','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','proceedscommunicated','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedscommunicated','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedscommunicated','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','proceedscommunicated','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','proceedscommunicated','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedscommunicated','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'idinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'S',format = '',col_len = '4',field = 'idinc',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'idinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedscommunicated','S','','4','idinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedscommunicated','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedscommunicated','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedscommunicated','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','proceedscommunicated','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'kpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'S',format = '',col_len = '4',field = 'kpro',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'kpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedscommunicated','S','','4','kpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'kproceedstransmission')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'S',format = '',col_len = '4',field = 'kproceedstransmission',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'kproceedstransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedscommunicated','S','','4','kproceedstransmission','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','proceedscommunicated','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','proceedscommunicated','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedscommunicated','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','proceedscommunicated','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'npro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'S',format = '',col_len = '4',field = 'npro',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'npro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedscommunicated','S','','4','npro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'nproceedstransmission')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'S',format = '',col_len = '4',field = 'nproceedstransmission',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'nproceedstransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedscommunicated','S','','4','nproceedstransmission','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'parentidinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'N',format = '',col_len = '4',field = 'parentidinc',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'parentidinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedscommunicated','N','','4','parentidinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedscommunicated','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','proceedscommunicated','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'printdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'N',format = '',col_len = '4',field = 'printdate',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'printdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedscommunicated','N','','4','printdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'S',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','proceedscommunicated','S','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','proceedscommunicated','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'ypro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'S',format = '',col_len = '2',field = 'ypro',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'ypro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','proceedscommunicated','S','','2','ypro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedscommunicated' AND field = 'yproceedstransmission')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedscommunicated',denynull = 'S',format = '',col_len = '2',field = 'yproceedstransmission',col_precision = '' where tablename = 'proceedscommunicated' AND field = 'yproceedstransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','proceedscommunicated','S','','2','yproceedstransmission','')
GO

-- VERIFICA DI proceedscommunicated IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'proceedscommunicated')
UPDATE customobject set isreal = 'N' where objectname = 'proceedscommunicated'
ELSE
INSERT INTO customobject (objectname, isreal) values('proceedscommunicated', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA proceedsemitted
IF EXISTS(select * from sysobjects where id = object_id(N'[proceedsemitted]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [proceedsemitted]
GO






CREATE   VIEW [proceedsemitted]
(
	idinc,
	nphase,
	ymov,
	nmov,
	--ycreation,
	parentidinc,
	parentymov,
	parentnmov,
	idreg,
	idman,
	kpro,
	ypro,
	npro,
	doc,
	docdate,
	description,
	amount,
	curramount,
	totflag,
	flagarrear,
	flag,
	autokind,
	--idproceeds,
	idpayment,
	expiration,
	adate,
	competencydate,
	cu,
	ct,
	lu,
	lt,
	idfin,idupb
)
AS SELECT
	income.idinc,
	income.nphase,
	income.ymov,
	income.nmov,
	--income.ycreation,
	income.parentidinc,
	parentincome.ymov,
	parentincome.nmov,
	income.idreg,
	income.idman,
	proceeds.kpro,
	proceeds.ypro,
	proceeds.npro,
	income.doc,
	income.docdate,
	income.description,
	incomeyear_starting.amount, --income.amount,
	incometotal.curramount,
	incometotal.flag,
	CASE
		WHEN ((incometotal.flag&1)=0) THEN 'C'
		WHEN ((incometotal.flag&1)=1) THEN 'R'
	END, 
	incomelast.flag,
	income.autokind,
	--income.idproceeds,
	income.idpayment,
	income.expiration,
	income.adate,
	proceeds.adate, 
	income.cu,
	income.ct,
	income.lu,
	income.lt,
	incomeyear.idfin,
	incomeyear.idupb
FROM income
JOIN incomelast
	ON incomelast.idinc = income.idinc
JOIN proceeds
	ON proceeds.kpro = incomelast.kpro 
JOIN incomeyear
	ON income.idinc = incomeyear.idinc
	AND income.ymov = incomeyear.ayear
JOIN incometotal
	ON incometotal.idinc = incomeyear.idinc
	AND incometotal.ayear = incomeyear.ayear
LEFT OUTER JOIN income parentincome
	ON income.parentidinc = parentincome.idinc
LEFT OUTER JOIN incometotal incometotal_firstyear(NOLOCK)
	ON incometotal_firstyear.idinc = income.idinc
	AND ((incometotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN incomeyear incomeyear_starting(NOLOCK) 
	ON incomeyear_starting.idinc = incometotal_firstyear.idinc
	AND incomeyear_starting.ayear = incometotal_firstyear.ayear




GO

-- VERIFICA DI proceedsemitted IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'proceedsemitted'
IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedsemitted',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'proceedsemitted' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','proceedsemitted','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'proceedsemitted',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'proceedsemitted' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','proceedsemitted','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'proceedsemitted',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'proceedsemitted' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','proceedsemitted','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'competencydate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedsemitted',denynull = 'S',format = '',col_len = '4',field = 'competencydate',col_precision = '' where tablename = 'proceedsemitted' AND field = 'competencydate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','proceedsemitted','S','','4','competencydate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'proceedsemitted',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'proceedsemitted' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','proceedsemitted','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'proceedsemitted',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'proceedsemitted' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','proceedsemitted','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'proceedsemitted',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'proceedsemitted' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','proceedsemitted','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'proceedsemitted',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'proceedsemitted' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','proceedsemitted','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'proceedsemitted',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'proceedsemitted' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','proceedsemitted','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedsemitted',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'proceedsemitted' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedsemitted','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedsemitted',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'proceedsemitted' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedsemitted','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'proceedsemitted',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'proceedsemitted' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','proceedsemitted','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'proceedsemitted',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'proceedsemitted' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','proceedsemitted','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsemitted',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'proceedsemitted' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsemitted','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'idinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsemitted',denynull = 'S',format = '',col_len = '4',field = 'idinc',col_precision = '' where tablename = 'proceedsemitted' AND field = 'idinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedsemitted','S','','4','idinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsemitted',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'proceedsemitted' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsemitted','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsemitted',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'proceedsemitted' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsemitted','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsemitted',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'proceedsemitted' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsemitted','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'proceedsemitted',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'proceedsemitted' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','proceedsemitted','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'kpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsemitted',denynull = 'S',format = '',col_len = '4',field = 'kpro',col_precision = '' where tablename = 'proceedsemitted' AND field = 'kpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedsemitted','S','','4','kpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'proceedsemitted',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'proceedsemitted' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','proceedsemitted','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'proceedsemitted',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'proceedsemitted' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','proceedsemitted','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsemitted',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'proceedsemitted' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedsemitted','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'proceedsemitted',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'proceedsemitted' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','proceedsemitted','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'npro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsemitted',denynull = 'S',format = '',col_len = '4',field = 'npro',col_precision = '' where tablename = 'proceedsemitted' AND field = 'npro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedsemitted','S','','4','npro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'parentidinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsemitted',denynull = 'N',format = '',col_len = '4',field = 'parentidinc',col_precision = '' where tablename = 'proceedsemitted' AND field = 'parentidinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsemitted','N','','4','parentidinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsemitted',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'proceedsemitted' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsemitted','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedsemitted',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'proceedsemitted' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','proceedsemitted','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'proceedsemitted',denynull = 'S',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'proceedsemitted' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','proceedsemitted','S','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedsemitted',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'proceedsemitted' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','proceedsemitted','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsemitted' AND field = 'ypro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedsemitted',denynull = 'S',format = '',col_len = '2',field = 'ypro',col_precision = '' where tablename = 'proceedsemitted' AND field = 'ypro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','proceedsemitted','S','','2','ypro','')
GO

-- VERIFICA DI proceedsemitted IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'proceedsemitted')
UPDATE customobject set isreal = 'N' where objectname = 'proceedsemitted'
ELSE
INSERT INTO customobject (objectname, isreal) values('proceedsemitted', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA proceedslogview
IF EXISTS(select * from sysobjects where id = object_id(N'[proceedslogview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [proceedslogview]
GO


CREATE VIEW proceedslogview
(
	idinc,
	nphase,
	ymov,
	nmov,
	parentidinc,
	parentymov,
	parentnmov,
	idreg,
	idman,
	kpro,
	ypro,
	npro,
	doc,
	docdate,
	description,
	amount,
	flag, 
	idpayment,
	expiration,
	adate,
	competencydate,
	cu,
	ct,
	lu,
	lt
)
AS SELECT
  income.idinc,
  income.nphase,
  income.ymov,
  income.nmov,
  --income.ycreation,
  income.parentidinc,
 parentincome.ymov,
 parentincome.nmov,
  income.idreg,
  income.idman,
  proceeds.kpro,
  proceeds.ypro,
  proceeds.npro,
  income.doc,
  income.docdate,
  income.description,
 incomeyear_starting.amount,-- income.amount,
   incomelast.flag,--income.fulfilled, income.autokind,
  --- income.idproceeds,
  income.idpayment,
  income.expiration,
  income.adate,
	CASE config.cashvaliditykind  
		WHEN 1 THEN proceeds.adate 
		WHEN 2 THEN proceeds.printdate
		WHEN 4 THEN	( SELECT MIN(banktransaction.transactiondate)
				FROM banktransaction
				WHERE banktransaction.kpro=incomelast.kpro
				)
		ELSE proceedstransmission.transmissiondate --3
	END,
  income.cu,
  income.ct,
  income.lu,
  income.lt
FROM income
JOIN incomelast
	ON income.idinc = incomelast.idinc
LEFT OUTER JOIN config
	ON config.ayear = income.ymov
LEFT OUTER JOIN income parentincome (NOLOCK)
	ON parentincome.idinc = income.parentidinc
LEFT OUTER JOIN proceeds(NOLOCK) 
	ON proceeds.kpro = incomelast.kpro
LEFT OUTER JOIN proceedstransmission(NOLOCK) 
	ON proceedstransmission.kproceedstransmission =  proceeds.kproceedstransmission 
LEFT OUTER JOIN incometotal incometotal_firstyear(NOLOCK)
		ON incometotal_firstyear.idinc = income.idinc
		AND ((incometotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN incomeyear incomeyear_starting(NOLOCK) 
	ON incomeyear_starting.idinc = incometotal_firstyear.idinc
		AND incomeyear_starting.ayear = incometotal_firstyear.ayear
--WHERE income.nphase = (SELECT MAX(nphase) FROM incomephase)












GO

-- VERIFICA DI proceedslogview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'proceedslogview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedslogview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'proceedslogview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','proceedslogview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'proceedslogview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'proceedslogview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','proceedslogview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'competencydate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedslogview',denynull = 'N',format = '',col_len = '4',field = 'competencydate',col_precision = '' where tablename = 'proceedslogview' AND field = 'competencydate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedslogview','N','','4','competencydate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'proceedslogview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'proceedslogview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','proceedslogview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'proceedslogview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'proceedslogview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','proceedslogview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'proceedslogview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'proceedslogview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','proceedslogview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'proceedslogview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'proceedslogview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','proceedslogview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedslogview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'proceedslogview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedslogview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedslogview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'proceedslogview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedslogview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'proceedslogview',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'proceedslogview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','proceedslogview','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'idinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedslogview',denynull = 'S',format = '',col_len = '4',field = 'idinc',col_precision = '' where tablename = 'proceedslogview' AND field = 'idinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedslogview','S','','4','idinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedslogview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'proceedslogview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedslogview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedslogview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'proceedslogview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedslogview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedslogview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'proceedslogview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedslogview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'kpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedslogview',denynull = 'N',format = '',col_len = '4',field = 'kpro',col_precision = '' where tablename = 'proceedslogview' AND field = 'kpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedslogview','N','','4','kpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'proceedslogview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'proceedslogview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','proceedslogview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'proceedslogview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'proceedslogview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','proceedslogview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedslogview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'proceedslogview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedslogview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'proceedslogview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'proceedslogview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','proceedslogview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'npro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedslogview',denynull = 'N',format = '',col_len = '4',field = 'npro',col_precision = '' where tablename = 'proceedslogview' AND field = 'npro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedslogview','N','','4','npro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'parentidinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedslogview',denynull = 'N',format = '',col_len = '4',field = 'parentidinc',col_precision = '' where tablename = 'proceedslogview' AND field = 'parentidinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedslogview','N','','4','parentidinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedslogview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'proceedslogview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedslogview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedslogview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'proceedslogview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','proceedslogview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedslogview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'proceedslogview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','proceedslogview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedslogview' AND field = 'ypro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedslogview',denynull = 'N',format = '',col_len = '2',field = 'ypro',col_precision = '' where tablename = 'proceedslogview' AND field = 'ypro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','proceedslogview','N','','2','ypro','')
GO

-- VERIFICA DI proceedslogview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'proceedslogview')
UPDATE customobject set isreal = 'N' where objectname = 'proceedslogview'
ELSE
INSERT INTO customobject (objectname, isreal) values('proceedslogview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA proceedsperformed
IF EXISTS(select * from sysobjects where id = object_id(N'[proceedsperformed]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [proceedsperformed]
GO


CREATE  VIEW [proceedsperformed]
(
	idinc,
	nphase,
	ymov,
	nmov,
	--ycreation,
	parentidinc,
	parentymov,
	parentnmov,
	idreg,
	idman,
	kpro,
	ypro,
	npro,
	doc,
	docdate,
	description,
	amount,
	curramount,
	flagarrear,
	totflag,
	flag, --fulfilled,autokind,
	--idproceeds,
	idpayment,
	expiration,
	adate,
	competencydate,
	cu,
	ct,
	lu,
	lt,
	idfin,idupb
)
	AS SELECT DISTINCT
	income.idinc,
	income.nphase,
	income.ymov,
	income.nmov,
	--income.ycreation,
	income.parentidinc,
	parentincome.ymov,
	parentincome.nmov,
	income.idreg,
	income.idman,
	proceeds.kpro,
	proceeds.ypro,
	proceeds.npro,
	income.doc,
	income.docdate,
	income.description,
	banktransaction.amount,
	banktransaction.amount,

 	CASE
		when (( incometotal.flag & 1)=0) then 'C'
		when (( incometotal.flag & 1)=1) then 'R'
	End,
	incometotal.flag,
	incomelast.flag, --income.fulfilled,income.autokind,
	--income.idproceeds,
	income.idpayment,
	income.expiration,
	income.adate,
	banktransaction.transactiondate,
	income.cu,
	income.ct,
	income.lu,
	income.lt,
	incomeyear.idfin,incomeyear.idupb
	FROM income
	JOIN incomeyear
		ON income.idinc = incomeyear.idinc
		AND income.ymov = incomeyear.ayear
	JOIN incometotal
		ON incometotal.idinc = incomeyear.idinc
		AND incometotal.ayear = incomeyear.ayear
	JOIN incomelast
		on income.idinc = incomelast.idinc
	JOIN proceeds
		ON incomelast.kpro = proceeds.kpro
	JOIN banktransaction
		ON banktransaction.idinc = income.idinc
	LEFT OUTER JOIN income parentincome 
		ON parentincome.idinc = income.parentidinc


GO

-- VERIFICA DI proceedsperformed IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'proceedsperformed'
IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedsperformed',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'proceedsperformed' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','proceedsperformed','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'proceedsperformed',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'proceedsperformed' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','proceedsperformed','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'competencydate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedsperformed',denynull = 'N',format = '',col_len = '4',field = 'competencydate',col_precision = '' where tablename = 'proceedsperformed' AND field = 'competencydate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedsperformed','N','','4','competencydate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'proceedsperformed',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'proceedsperformed' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','proceedsperformed','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'proceedsperformed',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'proceedsperformed' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','proceedsperformed','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'proceedsperformed',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'proceedsperformed' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','proceedsperformed','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'proceedsperformed',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'proceedsperformed' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','proceedsperformed','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'proceedsperformed',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'proceedsperformed' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','proceedsperformed','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedsperformed',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'proceedsperformed' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedsperformed','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedsperformed',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'proceedsperformed' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedsperformed','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'proceedsperformed',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'proceedsperformed' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','proceedsperformed','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'proceedsperformed',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'proceedsperformed' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','proceedsperformed','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsperformed',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'proceedsperformed' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsperformed','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'idinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsperformed',denynull = 'S',format = '',col_len = '4',field = 'idinc',col_precision = '' where tablename = 'proceedsperformed' AND field = 'idinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedsperformed','S','','4','idinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsperformed',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'proceedsperformed' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsperformed','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsperformed',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'proceedsperformed' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsperformed','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsperformed',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'proceedsperformed' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsperformed','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'proceedsperformed',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'proceedsperformed' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','proceedsperformed','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'kpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsperformed',denynull = 'S',format = '',col_len = '4',field = 'kpro',col_precision = '' where tablename = 'proceedsperformed' AND field = 'kpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedsperformed','S','','4','kpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'proceedsperformed',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'proceedsperformed' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','proceedsperformed','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'proceedsperformed',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'proceedsperformed' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','proceedsperformed','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsperformed',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'proceedsperformed' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedsperformed','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'proceedsperformed',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'proceedsperformed' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','proceedsperformed','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'npro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsperformed',denynull = 'S',format = '',col_len = '4',field = 'npro',col_precision = '' where tablename = 'proceedsperformed' AND field = 'npro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedsperformed','S','','4','npro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'parentidinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsperformed',denynull = 'N',format = '',col_len = '4',field = 'parentidinc',col_precision = '' where tablename = 'proceedsperformed' AND field = 'parentidinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsperformed','N','','4','parentidinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsperformed',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'proceedsperformed' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsperformed','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedsperformed',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'proceedsperformed' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','proceedsperformed','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'proceedsperformed',denynull = 'S',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'proceedsperformed' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','proceedsperformed','S','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedsperformed',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'proceedsperformed' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','proceedsperformed','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsperformed' AND field = 'ypro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedsperformed',denynull = 'S',format = '',col_len = '2',field = 'ypro',col_precision = '' where tablename = 'proceedsperformed' AND field = 'ypro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','proceedsperformed','S','','2','ypro','')
GO

-- VERIFICA DI proceedsperformed IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'proceedsperformed')
UPDATE customobject set isreal = 'N' where objectname = 'proceedsperformed'
ELSE
INSERT INTO customobject (objectname, isreal) values('proceedsperformed', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA proceedsprinted
IF EXISTS(select * from sysobjects where id = object_id(N'[proceedsprinted]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [proceedsprinted]
GO




CREATE VIEW [proceedsprinted]
(
	idinc,
	nphase,
	ymov,
	nmov,
	parentidinc,
	parentymov,
	parentnmov,
	idreg,
	idman,
	kpro,
	ypro,
	npro,
	doc,
	docdate,
	description,
	amount,
	curramount,
	flagarrear,
	totflag,
	flag,
	idpayment,
	expiration,
	adate,
	competencydate,
	cu,
	ct,
	lu,
	lt,
	idfin,idupb
)
AS SELECT
	income.idinc,
	income.nphase,
	income.ymov,
	income.nmov,
	income.parentidinc,
	parentincome.ymov,
	parentincome.nmov,
	income.idreg,
	income.idman,
	proceeds.kpro,
	proceeds.ypro,
	proceeds.npro,
	income.doc,
	income.docdate,
	income.description,
	incomeyear_starting.amount,
	incometotal.curramount,
 	CASE
		when (( incometotal.flag & 1)=0) then 'C'
		when (( incometotal.flag & 1)=1) then 'R'
	End,
	incometotal.flag,
	incomelast.flag,
	income.idpayment,
	income.expiration,
	income.adate,
	proceeds.printdate,
	income.cu,
	income.ct,
	income.lu,
	income.lt,
	incomeyear.idfin,incomeyear.idupb
FROM income
JOIN incomelast
	ON income.idinc = incomelast.idinc
JOIN proceeds
	ON proceeds.kpro = incomelast.kpro 
JOIN incomeyear
	ON income.idinc = incomeyear.idinc
	AND income.ymov = incomeyear.ayear
JOIN incometotal
	ON incometotal.idinc = incomeyear.idinc
	AND incometotal.ayear = incomeyear.ayear
LEFT OUTER JOIN income parentincome
	ON parentincome.idinc = income.parentidinc
LEFT OUTER JOIN incometotal incometotal_firstyear
	ON incometotal_firstyear.idinc = income.idinc
	AND ((incometotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN incomeyear incomeyear_starting
	ON incomeyear_starting.idinc = incometotal_firstyear.idinc
	AND incomeyear_starting.ayear = incometotal_firstyear.ayear











GO

-- VERIFICA DI proceedsprinted IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'proceedsprinted'
IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedsprinted',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'proceedsprinted' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','proceedsprinted','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'proceedsprinted',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'proceedsprinted' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','proceedsprinted','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'competencydate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedsprinted',denynull = 'N',format = '',col_len = '4',field = 'competencydate',col_precision = '' where tablename = 'proceedsprinted' AND field = 'competencydate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedsprinted','N','','4','competencydate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'proceedsprinted',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'proceedsprinted' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','proceedsprinted','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'proceedsprinted',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'proceedsprinted' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','proceedsprinted','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'proceedsprinted',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'proceedsprinted' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','proceedsprinted','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'proceedsprinted',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'proceedsprinted' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','proceedsprinted','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'proceedsprinted',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'proceedsprinted' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','proceedsprinted','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedsprinted',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'proceedsprinted' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedsprinted','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedsprinted',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'proceedsprinted' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedsprinted','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'proceedsprinted',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'proceedsprinted' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','proceedsprinted','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'proceedsprinted',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'proceedsprinted' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','proceedsprinted','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsprinted',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'proceedsprinted' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsprinted','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'idinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsprinted',denynull = 'S',format = '',col_len = '4',field = 'idinc',col_precision = '' where tablename = 'proceedsprinted' AND field = 'idinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedsprinted','S','','4','idinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsprinted',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'proceedsprinted' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsprinted','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsprinted',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'proceedsprinted' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsprinted','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsprinted',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'proceedsprinted' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsprinted','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'proceedsprinted',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'proceedsprinted' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','proceedsprinted','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'kpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsprinted',denynull = 'S',format = '',col_len = '4',field = 'kpro',col_precision = '' where tablename = 'proceedsprinted' AND field = 'kpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedsprinted','S','','4','kpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'proceedsprinted',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'proceedsprinted' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','proceedsprinted','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'proceedsprinted',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'proceedsprinted' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','proceedsprinted','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsprinted',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'proceedsprinted' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedsprinted','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'proceedsprinted',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'proceedsprinted' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','proceedsprinted','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'npro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsprinted',denynull = 'S',format = '',col_len = '4',field = 'npro',col_precision = '' where tablename = 'proceedsprinted' AND field = 'npro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedsprinted','S','','4','npro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'parentidinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsprinted',denynull = 'N',format = '',col_len = '4',field = 'parentidinc',col_precision = '' where tablename = 'proceedsprinted' AND field = 'parentidinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsprinted','N','','4','parentidinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedsprinted',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'proceedsprinted' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedsprinted','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedsprinted',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'proceedsprinted' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','proceedsprinted','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'proceedsprinted',denynull = 'S',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'proceedsprinted' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','proceedsprinted','S','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedsprinted',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'proceedsprinted' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','proceedsprinted','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedsprinted' AND field = 'ypro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedsprinted',denynull = 'S',format = '',col_len = '2',field = 'ypro',col_precision = '' where tablename = 'proceedsprinted' AND field = 'ypro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','proceedsprinted','S','','2','ypro','')
GO

-- VERIFICA DI proceedsprinted IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'proceedsprinted')
UPDATE customobject set isreal = 'N' where objectname = 'proceedsprinted'
ELSE
INSERT INTO customobject (objectname, isreal) values('proceedsprinted', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA proceedssupposed
IF EXISTS(select * from sysobjects where id = object_id(N'[proceedssupposed]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [proceedssupposed]
GO




CREATE  VIEW [proceedssupposed]
(
	ayear,
	idinc,
	nphase,
	description,
	ymov,
	nmov,
	curramount,
	available,
	adate,
	expiration,
	kpro,
	ypro,
	npro,
	proceedsadate,
	kyproceedstransmission,
	yproceedstransmission,
	nproceedstransmission,
	transmissiondate
)
AS
-- Incassi trasmessi
	SELECT i1.ayear,
	e1.idinc,
	e1.nphase,
	f1.description,
	e1.ymov,
	e1.nmov,
	i1.curramount,
	NULL,
	e1.adate,
	e1.expiration,
	d1.kpro,
	d1.ypro,
	d1.npro,
	d1.adate,
	t1.kproceedstransmission,
	t1.yproceedstransmission,
	t1.nproceedstransmission,
	t1.transmissiondate
	FROM income e1
	JOIN incometotal i1
		ON e1.idinc = i1.idinc
	JOIN incomeyear i2
		ON i1.idinc = i2.idinc
		AND i1.ayear = i2.ayear
	join incomelast ls
		on e1.idinc = ls.idinc
	JOIN incomephase f1
		ON f1.nphase = e1.nphase
	LEFT OUTER JOIN proceeds d1
		ON ls.kpro = d1.kpro
	LEFT OUTER JOIN proceedstransmission t1
		ON d1.kproceedstransmission = t1.kproceedstransmission
	UNION
	SELECT 
	i1.ayear,
	e1.idinc,
	e1.nphase,
	f1.description,
	e1.ymov,
	e1.nmov,
	NULL,
	i1.available,
	e1.adate,
	e1.expiration,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL,
	NULL
	FROM income e1
	JOIN incometotal i1
		ON e1.idinc = i1.idinc
	JOIN incomeyear i2
		ON i1.idinc = i2.idinc
		AND i1.ayear = i2.ayear
	JOIN incomephase f1
		ON f1.nphase = e1.nphase
	WHERE i1.available <> 0
	AND f1.nphase >= (SELECT assessmentphasecode FROM config WHERE ayear = i2.ayear)
	AND f1.nphase < (SELECT MAX(nphase) FROM incomephase)



GO

-- VERIFICA DI proceedssupposed IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'proceedssupposed'
IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedssupposed' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedssupposed',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'proceedssupposed' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','proceedssupposed','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedssupposed' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'proceedssupposed',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'proceedssupposed' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','proceedssupposed','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedssupposed' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedssupposed',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'proceedssupposed' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','proceedssupposed','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedssupposed' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'proceedssupposed',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'proceedssupposed' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','proceedssupposed','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedssupposed' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'proceedssupposed',denynull = 'S',format = '',col_len = '50',field = 'description',col_precision = '' where tablename = 'proceedssupposed' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','proceedssupposed','S','','50','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedssupposed' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedssupposed',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'proceedssupposed' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedssupposed','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedssupposed' AND field = 'idinc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedssupposed',denynull = 'S',format = '',col_len = '4',field = 'idinc',col_precision = '' where tablename = 'proceedssupposed' AND field = 'idinc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedssupposed','S','','4','idinc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedssupposed' AND field = 'kpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedssupposed',denynull = 'N',format = '',col_len = '4',field = 'kpro',col_precision = '' where tablename = 'proceedssupposed' AND field = 'kpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedssupposed','N','','4','kpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedssupposed' AND field = 'kyproceedstransmission')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedssupposed',denynull = 'N',format = '',col_len = '4',field = 'kyproceedstransmission',col_precision = '' where tablename = 'proceedssupposed' AND field = 'kyproceedstransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedssupposed','N','','4','kyproceedstransmission','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedssupposed' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedssupposed',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'proceedssupposed' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceedssupposed','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedssupposed' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'proceedssupposed',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'proceedssupposed' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','proceedssupposed','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedssupposed' AND field = 'npro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedssupposed',denynull = 'N',format = '',col_len = '4',field = 'npro',col_precision = '' where tablename = 'proceedssupposed' AND field = 'npro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedssupposed','N','','4','npro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedssupposed' AND field = 'nproceedstransmission')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedssupposed',denynull = 'N',format = '',col_len = '4',field = 'nproceedstransmission',col_precision = '' where tablename = 'proceedssupposed' AND field = 'nproceedstransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','proceedssupposed','N','','4','nproceedstransmission','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedssupposed' AND field = 'proceedsadate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedssupposed',denynull = 'N',format = '',col_len = '4',field = 'proceedsadate',col_precision = '' where tablename = 'proceedssupposed' AND field = 'proceedsadate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedssupposed','N','','4','proceedsadate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedssupposed' AND field = 'transmissiondate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedssupposed',denynull = 'N',format = '',col_len = '4',field = 'transmissiondate',col_precision = '' where tablename = 'proceedssupposed' AND field = 'transmissiondate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedssupposed','N','','4','transmissiondate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedssupposed' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedssupposed',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'proceedssupposed' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','proceedssupposed','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedssupposed' AND field = 'ypro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedssupposed',denynull = 'N',format = '',col_len = '2',field = 'ypro',col_precision = '' where tablename = 'proceedssupposed' AND field = 'ypro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','proceedssupposed','N','','2','ypro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedssupposed' AND field = 'yproceedstransmission')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedssupposed',denynull = 'N',format = '',col_len = '2',field = 'yproceedstransmission',col_precision = '' where tablename = 'proceedssupposed' AND field = 'yproceedstransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','proceedssupposed','N','','2','yproceedstransmission','')
GO

-- VERIFICA DI proceedssupposed IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'proceedssupposed')
UPDATE customobject set isreal = 'N' where objectname = 'proceedssupposed'
ELSE
INSERT INTO customobject (objectname, isreal) values('proceedssupposed', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA proceedstransmissionview
IF EXISTS(select * from sysobjects where id = object_id(N'[proceedstransmissionview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [proceedstransmissionview]
GO

CREATE  VIEW proceedstransmissionview 
	(
	kproceedstransmission,
	yproceedstransmission,
	nproceedstransmission,
	idman,
	manager,
	idtreasurer,
	codetreasurer,
	transmissiondate,
	total,
	cu,
	ct,
	lu,
	lt
	)
	AS SELECT
	proceedstransmission.kproceedstransmission,
	proceedstransmission.yproceedstransmission,
 	proceedstransmission.nproceedstransmission,
	proceedstransmission.idman,
	manager.title,
	proceedstransmission.idtreasurer,
	treasurer.codetreasurer,
 	 proceedstransmission.transmissiondate,
	ISNULL((SELECT SUM(ISNULL(total,0)) FROM proceedsview d 
	WHERE d.kproceedstransmission = proceedstransmission.kproceedstransmission),0),
	  proceedstransmission.cu,
	  proceedstransmission.ct,
	  proceedstransmission.lu,
	  proceedstransmission.lt
	FROM proceedstransmission 
	LEFT OUTER JOIN manager 
	ON manager.idman = proceedstransmission.idman
	LEFT OUTER JOIN treasurer 
	ON treasurer.idtreasurer = proceedstransmission.idtreasurer


GO

-- VERIFICA DI proceedstransmissionview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'proceedstransmissionview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedstransmissionview' AND field = 'codetreasurer')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'proceedstransmissionview',denynull = 'N',format = '',col_len = '20',field = 'codetreasurer',col_precision = '' where tablename = 'proceedstransmissionview' AND field = 'codetreasurer'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(20)','N','proceedstransmissionview','N','','20','codetreasurer','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedstransmissionview' AND field = 'ct')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'proceedstransmissionview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'proceedstransmissionview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','datetime','','N','System.DateTime','datetime','N','proceedstransmissionview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedstransmissionview' AND field = 'cu')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'proceedstransmissionview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'proceedstransmissionview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(64)','N','proceedstransmissionview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedstransmissionview' AND field = 'idman')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedstransmissionview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'proceedstransmissionview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','proceedstransmissionview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedstransmissionview' AND field = 'idtreasurer')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedstransmissionview',denynull = 'N',format = '',col_len = '4',field = 'idtreasurer',col_precision = '' where tablename = 'proceedstransmissionview' AND field = 'idtreasurer'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','proceedstransmissionview','N','','4','idtreasurer','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedstransmissionview' AND field = 'kproceedstransmission')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedstransmissionview',denynull = 'S',format = '',col_len = '4',field = 'kproceedstransmission',col_precision = '' where tablename = 'proceedstransmissionview' AND field = 'kproceedstransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','N','System.Int32','int','N','proceedstransmissionview','S','','4','kproceedstransmission','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedstransmissionview' AND field = 'lt')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'proceedstransmissionview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'proceedstransmissionview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','datetime','','N','System.DateTime','datetime','N','proceedstransmissionview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedstransmissionview' AND field = 'lu')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'proceedstransmissionview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'proceedstransmissionview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(64)','N','proceedstransmissionview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedstransmissionview' AND field = 'manager')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'proceedstransmissionview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'proceedstransmissionview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(150)','N','proceedstransmissionview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedstransmissionview' AND field = 'nproceedstransmission')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceedstransmissionview',denynull = 'S',format = '',col_len = '4',field = 'nproceedstransmission',col_precision = '' where tablename = 'proceedstransmissionview' AND field = 'nproceedstransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','N','System.Int32','int','N','proceedstransmissionview','S','','4','nproceedstransmission','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedstransmissionview' AND field = 'total')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'proceedstransmissionview',denynull = 'S',format = '',col_len = '17',field = 'total',col_precision = '38' where tablename = 'proceedstransmissionview' AND field = 'total'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','N','System.Decimal','decimal(38,2)','N','proceedstransmissionview','S','','17','total','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedstransmissionview' AND field = 'transmissiondate')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'proceedstransmissionview',denynull = 'N',format = '',col_len = '4',field = 'transmissiondate',col_precision = '' where tablename = 'proceedstransmissionview' AND field = 'transmissiondate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','smalldatetime','','S','System.DateTime','smalldatetime','N','proceedstransmissionview','N','','4','transmissiondate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceedstransmissionview' AND field = 'yproceedstransmission')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceedstransmissionview',denynull = 'S',format = '',col_len = '2',field = 'yproceedstransmission',col_precision = '' where tablename = 'proceedstransmissionview' AND field = 'yproceedstransmission'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','smallint','','N','System.Int16','smallint','N','proceedstransmissionview','S','','2','yproceedstransmission','')
GO

-- VERIFICA DI proceedstransmissionview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'proceedstransmissionview')
UPDATE customobject set isreal = 'N' where objectname = 'proceedstransmissionview'
ELSE
INSERT INTO customobject (objectname, isreal) values('proceedstransmissionview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --


-- CREAZIONE VISTA proceeds_bankview
IF EXISTS(select * from sysobjects where id = object_id(N'[proceeds_bankview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [proceeds_bankview]
GO




CREATE  VIEW proceeds_bankview
(
	kpro,
	ypro,
	npro,
	idpro,
	idreg,
	registry,
	description,
	amount,
	ct,
	cu,
	lt,
	lu
)
AS SELECT
	proceeds.kpro,
	proceeds.ypro,
	proceeds.npro,
	PB.idpro,
	PB.idreg,
	R.title,
	PB.description,
	PB.amount,
	PB.ct,
	PB.cu,
	PB.lt,
	PB.lu
FROM proceeds_bank PB
JOIN proceeds 
	ON proceeds.kpro = PB.kpro
JOIN registry R
	ON R.idreg = PB.idreg







GO

-- VERIFICA DI proceeds_bankview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'proceeds_bankview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'proceeds_bankview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'proceeds_bankview',denynull = 'S',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'proceeds_bankview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','N','System.Decimal','decimal(19,2)','N','proceeds_bankview','S','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceeds_bankview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'proceeds_bankview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'proceeds_bankview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','proceeds_bankview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceeds_bankview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'proceeds_bankview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'proceeds_bankview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','proceeds_bankview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceeds_bankview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(200)',iskey = 'N',tablename = 'proceeds_bankview',denynull = 'N',format = '',col_len = '200',field = 'description',col_precision = '' where tablename = 'proceeds_bankview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(200)','N','proceeds_bankview','N','','200','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceeds_bankview' AND field = 'idpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceeds_bankview',denynull = 'S',format = '',col_len = '4',field = 'idpro',col_precision = '' where tablename = 'proceeds_bankview' AND field = 'idpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceeds_bankview','S','','4','idpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceeds_bankview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceeds_bankview',denynull = 'S',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'proceeds_bankview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceeds_bankview','S','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceeds_bankview' AND field = 'kpro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceeds_bankview',denynull = 'S',format = '',col_len = '4',field = 'kpro',col_precision = '' where tablename = 'proceeds_bankview' AND field = 'kpro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceeds_bankview','S','','4','kpro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceeds_bankview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'proceeds_bankview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'proceeds_bankview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','proceeds_bankview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceeds_bankview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'proceeds_bankview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'proceeds_bankview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','proceeds_bankview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceeds_bankview' AND field = 'npro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'proceeds_bankview',denynull = 'S',format = '',col_len = '4',field = 'npro',col_precision = '' where tablename = 'proceeds_bankview' AND field = 'npro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','proceeds_bankview','S','','4','npro','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceeds_bankview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'proceeds_bankview',denynull = 'S',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'proceeds_bankview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(100)','N','proceeds_bankview','S','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'proceeds_bankview' AND field = 'ypro')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'proceeds_bankview',denynull = 'S',format = '',col_len = '2',field = 'ypro',col_precision = '' where tablename = 'proceeds_bankview' AND field = 'ypro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','proceeds_bankview','S','','2','ypro','')
GO

-- VERIFICA DI proceeds_bankview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'proceeds_bankview')
UPDATE customobject set isreal = 'N' where objectname = 'proceeds_bankview'
ELSE
INSERT INTO customobject (objectname, isreal) values('proceeds_bankview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA profserviceresidual
IF EXISTS(select * from sysobjects where id = object_id(N'[profserviceresidual]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [profserviceresidual]
GO



CREATE   VIEW [profserviceresidual]
(
	ycon,
	ncon,
	description,
	idreg,
	registry,
	start,
	stop,
	feegross,
	totalcost,
	taxabletotal,
	ivatotal,
	residual,
	linkedimpon,
	linkedimpos,
	linkeddocum,
	linkedtotal,
	linkedtotalexpense,
	idupb,
	codeupb,
	upb
)
AS SELECT
profservice.ycon,
profservice.ncon,
profservice.description,
profservice.idreg,
registry.title,
profservice.start,
profservice.stop,
profservice.feegross,
profservice.totalcost,
-- TOTALEIMPONIBILE = costototale - importoiva
CONVERT(decimal(19,2),
	ROUND(profservice.totalcost - ISNULL(profservice.ivaamount,0),2)
),
profservice.ivaamount,
-- Calcolo del RESIDUO
CONVERT(decimal(19,2),
	ROUND(
--select top 1 totflag,flagarrear from historypaymentview
		profservice.totalcost -
		(
			ISNULL(
				(SELECT SUM(expenseyear_starting.amount)
				FROM expenseprofservice mov
				JOIN expense s
					ON s.idexp = mov.idexp
				LEFT OUTER JOIN expensetotal expensetotal_firstyear
					ON expensetotal_firstyear.idexp = s.idexp
					AND ((expensetotal_firstyear.flag & 2) <> 0 )
				LEFT OUTER JOIN expenseyear expenseyear_starting 
					ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
					AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
				WHERE mov.ycon = profservice.ycon
					AND mov.ncon = profservice.ncon
					--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
				)
			,0) +
			ISNULL(
				(SELECT ISNULL(SUM(v.amount), 0.0)
				FROM expenseprofservice mov
				JOIN expense s
					ON s.idexp = mov.idexp
				LEFT OUTER JOIN expensevar v
					ON (v.idexp = mov.idexp)
				WHERE mov.ycon = profservice.ycon 
					AND mov.ncon = profservice.ncon
					AND (ISNULL(v.autokind,0)<>4)
					--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
				)
			,0) +
			ISNULL(
				(SELECT SUM(p.amount)
				FROM pettycashoperationprofservice mov
				JOIN pettycashoperation p
					ON mov.idpettycash = p.idpettycash
					AND mov.yoperation = p.yoperation
					AND mov.noperation = p.noperation
				WHERE mov.ycon = profservice.ycon
					AND mov.ncon = profservice.ncon)
			,0)
		)
	,2)
),
-- Calcolo del CONTIMPON (imponibile contabilizzato)
CONVERT(decimal(19,2),
	(
		(SELECT ISNULL(SUM(expenseyear_starting.amount), 0.0) 
		FROM expenseprofservice mov  
		JOIN expense s
			ON s.idexp = mov.idexp
		LEFT OUTER JOIN expensetotal expensetotal_firstyear
			ON expensetotal_firstyear.idexp = s.idexp
			AND ((expensetotal_firstyear.flag & 2) <> 0 )
		LEFT OUTER JOIN expenseyear expenseyear_starting 
			ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
			AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
		WHERE mov.ycon = profservice.ycon
			AND mov.ncon = profservice.ncon
			AND (mov.movkind = 3)
			--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
		) +
		(SELECT ISNULL(SUM(v.amount), 0.0)
		FROM expenseprofservice mov
		JOIN expense s
			ON s.idexp = mov.idexp
		LEFT OUTER JOIN expensevar v
			ON v.idexp = mov.idexp
		WHERE mov.ycon = profservice.ycon
			AND mov.ncon = profservice.ncon
			AND mov.movkind = 3
			AND (ISNULL(v.autokind,0)<>4)
			--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
			)
	)
),
-- Calcolo del CONTIMPOS (imposta contabilizzata)
CONVERT(decimal(19,2),
	(
		(SELECT ISNULL(SUM(expenseyear_starting.amount), 0.0) 
		FROM expenseprofservice mov
		JOIN expense s
			ON s.idexp = mov.idexp
		LEFT OUTER JOIN expensetotal expensetotal_firstyear
			ON expensetotal_firstyear.idexp = s.idexp
			AND ((expensetotal_firstyear.flag & 2) <> 0 )
		LEFT OUTER JOIN expenseyear expenseyear_starting 
			ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
			AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
		WHERE mov.ycon = profservice.ycon
			AND mov.ncon = profservice.ncon
			AND (mov.movkind = 2)
			--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
		) +
		(SELECT ISNULL(SUM(v.amount), 0.0)
		FROM expenseprofservice mov
		JOIN expense s
			ON s.idexp = mov.idexp
		LEFT OUTER JOIN expensevar v
			ON v.idexp = mov.idexp
		WHERE mov.ycon = profservice.ycon
			AND mov.ncon = profservice.ncon
			AND mov.movkind = 2
			AND (ISNULL(v.autokind,0)<>4)
			--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
			)
	)
),
-- Calcolo del CONTDOCUM (totale del documento contabilizzato)
CONVERT(decimal(19,2),
	(
		ISNULL(
			(SELECT SUM(expenseyear_starting.amount)
			FROM expenseprofservice mov
			JOIN expense s
				ON s.idexp = mov.idexp
			LEFT OUTER JOIN expensetotal expensetotal_firstyear
				ON expensetotal_firstyear.idexp = s.idexp
				AND ((expensetotal_firstyear.flag & 2) <> 0 )
			LEFT OUTER JOIN expenseyear expenseyear_starting 
				ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
				AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
			WHERE mov.ycon = profservice.ycon
				AND mov.ncon = profservice.ncon
				AND (mov.movkind = 1)
				--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
			)
		,0) +
		ISNULL(
			(SELECT SUM(v.amount)
			FROM expenseprofservice mov
			JOIN expense s
				ON s.idexp = mov.idexp
			LEFT OUTER JOIN expensevar v
				ON v.idexp = mov.idexp
			WHERE mov.ycon = profservice.ycon
				AND mov.ncon = profservice.ncon
				AND mov.movkind = 1
				AND (ISNULL(v.autokind,0)<>4)
			--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
			)
		,0)
		+
		ISNULL(
			(SELECT SUM(p.amount)
			FROM pettycashoperationprofservice mov
			JOIN pettycashoperation p
				ON mov.idpettycash = p.idpettycash
				AND mov.yoperation = p.yoperation
				AND mov.noperation = p.noperation
			WHERE mov.ycon = profservice.ycon
				AND mov.ncon = profservice.ncon)
		,0)
	)
),
-- Calcolo di TOTCONTABILIZZATO
CONVERT(decimal(19,2),
	(
		ISNULL(
			(SELECT SUM(expenseyear_starting.amount) 
			FROM expenseprofservice mov
			JOIN expense s
				ON s.idexp = mov.idexp
			LEFT OUTER JOIN expensetotal expensetotal_firstyear
				ON expensetotal_firstyear.idexp = s.idexp
				AND ((expensetotal_firstyear.flag & 2) <> 0 )
			LEFT OUTER JOIN expenseyear expenseyear_starting 
				ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
				AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
			WHERE mov.ycon = profservice.ycon
				AND mov.ncon = profservice.ncon
				--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
			)
		,0) +
		ISNULL(	
			(SELECT SUM(v.amount)
			FROM expenseprofservice mov
			JOIN expense s
				ON s.idexp = mov.idexp
			LEFT OUTER JOIN expensevar v
				ON v.idexp = mov.idexp
			WHERE mov.ycon = profservice.ycon 
				AND mov.ncon = profservice.ncon
				AND (ISNULL(v.autokind,0)<>4)
				--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
			)
		,0) +
		ISNULL(
			(SELECT SUM(p.amount)
			FROM pettycashoperationprofservice mov
			JOIN pettycashoperation p
			ON mov.idpettycash = p.idpettycash
			AND mov.yoperation = p.yoperation
			AND mov.noperation = p.noperation
			WHERE mov.ycon = profservice.ycon
			AND mov.ncon = profservice.ncon)
		,0)
	)
),
-- TOTCONTABILIZZATOSPESA
CONVERT(decimal(19,2),
	(
		ISNULL(
			(SELECT SUM(expenseyear_starting.amount) 
			FROM expenseprofservice mov
			JOIN expense s
				ON s.idexp = mov.idexp
			LEFT OUTER JOIN expensetotal expensetotal_firstyear
				ON expensetotal_firstyear.idexp = s.idexp
				AND ((expensetotal_firstyear.flag & 2) <> 0 )
			LEFT OUTER JOIN expenseyear expenseyear_starting 
				ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
				AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
			WHERE mov.ycon = profservice.ycon
				AND mov.ncon = profservice.ncon
			--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
			)
		,0) +
		ISNULL(	
			(SELECT SUM(v.amount)
			FROM expenseprofservice mov
			JOIN expense s
			ON s.idexp = mov.idexp
			LEFT OUTER JOIN expensevar v
			ON v.idexp = mov.idexp
			WHERE mov.ycon = profservice.ycon 
			AND mov.ncon = profservice.ncon
			AND (ISNULL(v.autokind,0)<>4)
			--AND s.nphase = (SELECT expensephase FROM expensesetup WHERE ayear=s.ycreation)
			)
		,0)
	)
),
	upb.idupb,
	upb.codeupb,
	upb.title
FROM profservice 
JOIN registry 
ON registry.idreg = profservice.idreg
LEFT OUTER JOIN upb
	ON upb.idupb = profservice.idupb










GO

-- VERIFICA DI profserviceresidual IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'profserviceresidual'
IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'profserviceresidual',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'profserviceresidual' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','profserviceresidual','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'profserviceresidual',denynull = 'N',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'profserviceresidual' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','profserviceresidual','N','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'feegross')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'profserviceresidual',denynull = 'S',format = '',col_len = '9',field = 'feegross',col_precision = '19' where tablename = 'profserviceresidual' AND field = 'feegross'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','N','System.Decimal','decimal(19,2)','N','profserviceresidual','S','','9','feegross','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'profserviceresidual',denynull = 'S',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'profserviceresidual' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','profserviceresidual','S','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'profserviceresidual',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'profserviceresidual' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','profserviceresidual','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'ivatotal')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'profserviceresidual',denynull = 'N',format = '',col_len = '9',field = 'ivatotal',col_precision = '19' where tablename = 'profserviceresidual' AND field = 'ivatotal'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','profserviceresidual','N','','9','ivatotal','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'linkeddocum')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'profserviceresidual',denynull = 'N',format = '',col_len = '9',field = 'linkeddocum',col_precision = '19' where tablename = 'profserviceresidual' AND field = 'linkeddocum'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','profserviceresidual','N','','9','linkeddocum','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'linkedimpon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'profserviceresidual',denynull = 'N',format = '',col_len = '9',field = 'linkedimpon',col_precision = '19' where tablename = 'profserviceresidual' AND field = 'linkedimpon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','profserviceresidual','N','','9','linkedimpon','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'linkedimpos')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'profserviceresidual',denynull = 'N',format = '',col_len = '9',field = 'linkedimpos',col_precision = '19' where tablename = 'profserviceresidual' AND field = 'linkedimpos'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','profserviceresidual','N','','9','linkedimpos','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'linkedtotal')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'profserviceresidual',denynull = 'N',format = '',col_len = '9',field = 'linkedtotal',col_precision = '19' where tablename = 'profserviceresidual' AND field = 'linkedtotal'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','profserviceresidual','N','','9','linkedtotal','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'linkedtotalexpense')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'profserviceresidual',denynull = 'N',format = '',col_len = '9',field = 'linkedtotalexpense',col_precision = '19' where tablename = 'profserviceresidual' AND field = 'linkedtotalexpense'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','profserviceresidual','N','','9','linkedtotalexpense','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'ncon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'profserviceresidual',denynull = 'S',format = '',col_len = '4',field = 'ncon',col_precision = '' where tablename = 'profserviceresidual' AND field = 'ncon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','profserviceresidual','S','','4','ncon','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'profserviceresidual',denynull = 'S',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'profserviceresidual' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(100)','N','profserviceresidual','S','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'residual')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'profserviceresidual',denynull = 'N',format = '',col_len = '9',field = 'residual',col_precision = '19' where tablename = 'profserviceresidual' AND field = 'residual'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','profserviceresidual','N','','9','residual','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'start')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'profserviceresidual',denynull = 'S',format = '',col_len = '8',field = 'start',col_precision = '' where tablename = 'profserviceresidual' AND field = 'start'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','profserviceresidual','S','','8','start','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'stop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'profserviceresidual',denynull = 'S',format = '',col_len = '8',field = 'stop',col_precision = '' where tablename = 'profserviceresidual' AND field = 'stop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','profserviceresidual','S','','8','stop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'taxabletotal')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'profserviceresidual',denynull = 'N',format = '',col_len = '9',field = 'taxabletotal',col_precision = '19' where tablename = 'profserviceresidual' AND field = 'taxabletotal'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','profserviceresidual','N','','9','taxabletotal','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'totalcost')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'profserviceresidual',denynull = 'N',format = '',col_len = '9',field = 'totalcost',col_precision = '19' where tablename = 'profserviceresidual' AND field = 'totalcost'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','profserviceresidual','N','','9','totalcost','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'profserviceresidual',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'profserviceresidual' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','profserviceresidual','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profserviceresidual' AND field = 'ycon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'profserviceresidual',denynull = 'S',format = '',col_len = '4',field = 'ycon',col_precision = '' where tablename = 'profserviceresidual' AND field = 'ycon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','profserviceresidual','S','','4','ycon','')
GO

-- VERIFICA DI profserviceresidual IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'profserviceresidual')
UPDATE customobject set isreal = 'N' where objectname = 'profserviceresidual'
ELSE
INSERT INTO customobject (objectname, isreal) values('profserviceresidual', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA profservicetaxview
IF EXISTS(select * from sysobjects where id = object_id(N'[profservicetaxview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [profservicetaxview]
GO





CREATE VIEW [profservicetaxview]
(
	taxcode,
	description,
	taxref,
	ycon,
	ncon,
	adminrate,
	employrate,
	taxablegross,
	taxablenet,
	admindenominator,
	employdenominator,
	taxabledenominator,
	adminnumerator,
	employnumerator,
	taxablenumerator,
	admintax,
	employtax,
	employtaxgross,
	taxkind
)
AS SELECT
	COPR.taxcode,
	TR.description,
	TR.taxref,
	COPR.ycon,
	COPR.ncon,
	COPR.adminrate,
	COPR.employrate,
	COPR.taxablegross,
	COPR.taxablenet,
	COPR.admindenominator,
	COPR.employdenominator,
	COPR.taxabledenominator,
	COPR.adminnumerator,
	COPR.employnumerator,
	COPR.taxablenumerator,
	COPR.admintax,
	COPR.employtax,
	COPR.employtaxgross,
	TR.taxkind
FROM profservicetax COPR
JOIN tax TR
	ON COPR.taxcode = TR.taxcode









GO

-- VERIFICA DI profservicetaxview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'profservicetaxview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'profservicetaxview' AND field = 'admindenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'profservicetaxview',denynull = 'N',format = '',col_len = '9',field = 'admindenominator',col_precision = '19' where tablename = 'profservicetaxview' AND field = 'admindenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','profservicetaxview','N','','9','admindenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profservicetaxview' AND field = 'adminnumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'profservicetaxview',denynull = 'N',format = '',col_len = '9',field = 'adminnumerator',col_precision = '19' where tablename = 'profservicetaxview' AND field = 'adminnumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','profservicetaxview','N','','9','adminnumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profservicetaxview' AND field = 'adminrate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'profservicetaxview',denynull = 'N',format = '',col_len = '9',field = 'adminrate',col_precision = '19' where tablename = 'profservicetaxview' AND field = 'adminrate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','profservicetaxview','N','','9','adminrate','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profservicetaxview' AND field = 'admintax')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'profservicetaxview',denynull = 'N',format = '',col_len = '9',field = 'admintax',col_precision = '19' where tablename = 'profservicetaxview' AND field = 'admintax'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','profservicetaxview','N','','9','admintax','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profservicetaxview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'profservicetaxview',denynull = 'S',format = '',col_len = '50',field = 'description',col_precision = '' where tablename = 'profservicetaxview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','profservicetaxview','S','','50','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profservicetaxview' AND field = 'employdenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'profservicetaxview',denynull = 'N',format = '',col_len = '9',field = 'employdenominator',col_precision = '19' where tablename = 'profservicetaxview' AND field = 'employdenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','profservicetaxview','N','','9','employdenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profservicetaxview' AND field = 'employnumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'profservicetaxview',denynull = 'N',format = '',col_len = '9',field = 'employnumerator',col_precision = '19' where tablename = 'profservicetaxview' AND field = 'employnumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','profservicetaxview','N','','9','employnumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profservicetaxview' AND field = 'employrate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'profservicetaxview',denynull = 'N',format = '',col_len = '9',field = 'employrate',col_precision = '19' where tablename = 'profservicetaxview' AND field = 'employrate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','profservicetaxview','N','','9','employrate','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profservicetaxview' AND field = 'employtax')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'profservicetaxview',denynull = 'N',format = '',col_len = '9',field = 'employtax',col_precision = '19' where tablename = 'profservicetaxview' AND field = 'employtax'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','profservicetaxview','N','','9','employtax','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profservicetaxview' AND field = 'employtaxgross')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'profservicetaxview',denynull = 'N',format = '',col_len = '9',field = 'employtaxgross',col_precision = '19' where tablename = 'profservicetaxview' AND field = 'employtaxgross'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','profservicetaxview','N','','9','employtaxgross','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profservicetaxview' AND field = 'ncon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'profservicetaxview',denynull = 'S',format = '',col_len = '4',field = 'ncon',col_precision = '' where tablename = 'profservicetaxview' AND field = 'ncon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','profservicetaxview','S','','4','ncon','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profservicetaxview' AND field = 'taxabledenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'profservicetaxview',denynull = 'N',format = '',col_len = '9',field = 'taxabledenominator',col_precision = '19' where tablename = 'profservicetaxview' AND field = 'taxabledenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','profservicetaxview','N','','9','taxabledenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profservicetaxview' AND field = 'taxablegross')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'profservicetaxview',denynull = 'N',format = '',col_len = '9',field = 'taxablegross',col_precision = '19' where tablename = 'profservicetaxview' AND field = 'taxablegross'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','profservicetaxview','N','','9','taxablegross','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profservicetaxview' AND field = 'taxablenet')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'profservicetaxview',denynull = 'N',format = '',col_len = '9',field = 'taxablenet',col_precision = '19' where tablename = 'profservicetaxview' AND field = 'taxablenet'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','profservicetaxview','N','','9','taxablenet','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profservicetaxview' AND field = 'taxablenumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'profservicetaxview',denynull = 'N',format = '',col_len = '9',field = 'taxablenumerator',col_precision = '19' where tablename = 'profservicetaxview' AND field = 'taxablenumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(19,6)','N','profservicetaxview','N','','9','taxablenumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profservicetaxview' AND field = 'taxcode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'profservicetaxview',denynull = 'S',format = '',col_len = '4',field = 'taxcode',col_precision = '' where tablename = 'profservicetaxview' AND field = 'taxcode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','profservicetaxview','S','','4','taxcode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profservicetaxview' AND field = 'taxkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'profservicetaxview',denynull = 'S',format = '',col_len = '2',field = 'taxkind',col_precision = '' where tablename = 'profservicetaxview' AND field = 'taxkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','profservicetaxview','S','','2','taxkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profservicetaxview' AND field = 'taxref')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'profservicetaxview',denynull = 'S',format = '',col_len = '20',field = 'taxref',col_precision = '' where tablename = 'profservicetaxview' AND field = 'taxref'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','profservicetaxview','S','','20','taxref','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'profservicetaxview' AND field = 'ycon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'profservicetaxview',denynull = 'S',format = '',col_len = '4',field = 'ycon',col_precision = '' where tablename = 'profservicetaxview' AND field = 'ycon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','profservicetaxview','S','','4','ycon','')
GO

-- VERIFICA DI profservicetaxview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'profservicetaxview')
UPDATE customobject set isreal = 'N' where objectname = 'profservicetaxview'
ELSE
INSERT INTO customobject (objectname, isreal) values('profservicetaxview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA revenuearrears
IF EXISTS(select * from sysobjects where id = object_id(N'[revenuearrears]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [revenuearrears]
GO


CREATE  VIEW [revenuearrears]
(
	ayear,
	idinc,
	ymov,
	nmov,
	adate,
	residualamount,
	flagarrear
)
AS
SELECT
i1.ayear,
e1.idinc,
e1.ymov,
e1.nmov,
e1.adate,
ISNULL(i2.curramount,0.0) - ISNULL(
	(SELECT SUM(ISNULL(i3.curramount,0.0)) 
	FROM income e3
	 JOIN incometotal i3
		 ON e3.idinc = i3.idinc
	JOIN incomelast ls
		ON e3.idinc = ls.idinc
	 JOIN proceeds d1
		 ON d1.kpro = ls.kpro
	 JOIN proceedstransmission t1
		 ON t1.kproceedstransmission = d1.kproceedstransmission
	JOIN incomelink ilk
		ON ilk.idchild = i3.idinc
	 WHERE  ilk.idparent = e1.idinc--i3.idinc LIKE e1.idinc + '%'
	 	--AND e3.nphase = (SELECT MAX(nphase) FROM incomephase)
	 AND i3.ayear = i1.ayear),0.0),
--i1.flagarrear
   	CASE
		when (( i2.flag & 1)=0) then 'C'
		when (( i2.flag & 1)=1) then 'R'
	End AS flagarrear
FROM income e1
INNER JOIN incomeyear i1 
	ON e1.idinc = i1.idinc 
INNER JOIN incometotal i2
	ON i1.idinc = i2.idinc
	AND i1.ayear = i2.ayear
INNER JOIN config p1			
	ON p1.assessmentphasecode = e1.nphase
	AND p1.ayear = i1.ayear
WHERE --i1.flagarrear IS NOT NULL AND
	 i2.curramount >
	ISNULL((SELECT SUM(ISNULL(i3.curramount,0.0)) 
		FROM income e3
		 JOIN incometotal i3
			 ON e3.idinc = i3.idinc
		 	AND e3.ymov = i3.ayear
		JOIN incomelast ls
			ON e3.idinc = ls.idinc
		JOIN proceeds d1
		 	ON d1.kpro = ls.kpro
	 	JOIN proceedstransmission t1
	 		ON t1.kproceedstransmission = d1.kproceedstransmission
		JOIN incomelink ilk
			ON ilk.idchild = i3.idinc
	 	WHERE ilk.idparent = e1.idinc --i3.idinc LIKE e1.idinc + '%'
		-- AND e3.nphase = (SELECT MAX(nphase) FROM incomephase)
	 	AND i3.ayear = i1.ayear),0.0)






GO

-- VERIFICA DI revenuearrears IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'revenuearrears'
-- VERIFICA DI revenuearrears IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'revenuearrears')
UPDATE customobject set isreal = 'N' where objectname = 'revenuearrears'
ELSE
INSERT INTO customobject (objectname, isreal) values('revenuearrears', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA servicetaxview
IF EXISTS(select * from sysobjects where id = object_id(N'[dbo].[servicetaxview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [dbo].[servicetaxview]
GO



CREATE VIEW [DBO].servicetaxview
(
	taxcode,
	tax,
	taxref,
	idser, 
	servicedescription,
	codeser,
	cu,
	ct,
	lu, 
	lt,
	appliancebasis,
	geoappliance, 
	taxablecode,
	taxkind,
	module
)
AS
SELECT
	servicetax.taxcode,
	tax.description,
	tax.taxref,
	servicetax.idser, 
	service.description,
	service.codeser,
	servicetax.cu,
	servicetax.ct,
	servicetax.lu, 
	servicetax.lt,
	tax.appliancebasis,
	tax.geoappliance, 
	tax.taxablecode,
	tax.taxkind,
	service.module
FROM servicetax
JOIN tax
	ON tax.taxcode = servicetax.taxcode
JOIN service
	ON service.idser = servicetax.idser


GO

-- VERIFICA DI servicetaxview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'servicetaxview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'servicetaxview' AND field = 'appliancebasis')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'servicetaxview',denynull = 'N',format = '',col_len = '1',field = 'appliancebasis',col_precision = '' where tablename = 'servicetaxview' AND field = 'appliancebasis'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','servicetaxview','N','','1','appliancebasis','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'servicetaxview' AND field = 'codeser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'servicetaxview',denynull = 'S',format = '',col_len = '20',field = 'codeser',col_precision = '' where tablename = 'servicetaxview' AND field = 'codeser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','servicetaxview','S','','20','codeser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'servicetaxview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'servicetaxview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'servicetaxview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','servicetaxview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'servicetaxview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'servicetaxview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'servicetaxview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','servicetaxview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'servicetaxview' AND field = 'geoappliance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'servicetaxview',denynull = 'N',format = '',col_len = '1',field = 'geoappliance',col_precision = '' where tablename = 'servicetaxview' AND field = 'geoappliance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','servicetaxview','N','','1','geoappliance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'servicetaxview' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'servicetaxview',denynull = 'S',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'servicetaxview' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','servicetaxview','S','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'servicetaxview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'servicetaxview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'servicetaxview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','servicetaxview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'servicetaxview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'servicetaxview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'servicetaxview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','servicetaxview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'servicetaxview' AND field = 'module')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(15)',iskey = 'N',tablename = 'servicetaxview',denynull = 'N',format = '',col_len = '15',field = 'module',col_precision = '' where tablename = 'servicetaxview' AND field = 'module'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(15)','N','servicetaxview','N','','15','module','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'servicetaxview' AND field = 'servicedescription')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'servicetaxview',denynull = 'S',format = '',col_len = '50',field = 'servicedescription',col_precision = '' where tablename = 'servicetaxview' AND field = 'servicedescription'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','servicetaxview','S','','50','servicedescription','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'servicetaxview' AND field = 'tax')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'servicetaxview',denynull = 'S',format = '',col_len = '50',field = 'tax',col_precision = '' where tablename = 'servicetaxview' AND field = 'tax'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','servicetaxview','S','','50','tax','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'servicetaxview' AND field = 'taxablecode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'servicetaxview',denynull = 'N',format = '',col_len = '20',field = 'taxablecode',col_precision = '' where tablename = 'servicetaxview' AND field = 'taxablecode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','servicetaxview','N','','20','taxablecode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'servicetaxview' AND field = 'taxcode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'servicetaxview',denynull = 'S',format = '',col_len = '4',field = 'taxcode',col_precision = '' where tablename = 'servicetaxview' AND field = 'taxcode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','servicetaxview','S','','4','taxcode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'servicetaxview' AND field = 'taxkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'servicetaxview',denynull = 'S',format = '',col_len = '2',field = 'taxkind',col_precision = '' where tablename = 'servicetaxview' AND field = 'taxkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','servicetaxview','S','','2','taxkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'servicetaxview' AND field = 'taxref')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'servicetaxview',denynull = 'S',format = '',col_len = '20',field = 'taxref',col_precision = '' where tablename = 'servicetaxview' AND field = 'taxref'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','servicetaxview','S','','20','taxref','')
GO

-- VERIFICA DI servicetaxview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'servicetaxview')
UPDATE customobject set isreal = 'N' where objectname = 'servicetaxview'
ELSE
INSERT INTO customobject (objectname, isreal) values('servicetaxview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA sortingapplicabilityview
IF EXISTS(select * from sysobjects where id = object_id(N'[sortingapplicabilityview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [sortingapplicabilityview]
GO



CREATE VIEW  sortingapplicabilityview
(
	idsorkind,
	codesorkind,
	description,
	nphaseincome,
	incomephase,
	nphaseexpense,
	expensephase,
	flagcheckavailability,
	flagforced,
	active,
	cu,
	ct,
	lu,
	lt,
	tablename
)
AS SELECT
	sortingkind.idsorkind,
	sortingkind.codesorkind,
	sortingkind.description,
	sortingkind.nphaseincome,
	incomephase.description,
	sortingkind.nphaseexpense,
	expensephase.description,
	CASE 
		WHEN  ((sortingkind.flag&2)<> 0) THEN 'S'
		ELSE  'N'
	END,
	CASE 
		WHEN  ((sortingkind.flag&1)<> 0) THEN 'S'
		ELSE 'N'
	END,
	sortingkind.active,
	sortingkind.cu,
	sortingkind.ct,
	sortingkind.lu,
	sortingkind.lt,
	sortingapplicability.tablename
FROM sortingkind 
LEFT OUTER JOIN incomephase 
	ON incomephase.nphase = sortingkind.nphaseincome
LEFT OUTER JOIN expensephase 
	ON expensephase.nphase = sortingkind.nphaseexpense
JOIN sortingapplicability
	ON sortingapplicability.idsorkind = sortingkind.idsorkind


GO

-- VERIFICA DI sortingapplicabilityview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'sortingapplicabilityview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingapplicabilityview' AND field = 'active')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'sortingapplicabilityview',denynull = 'N',format = '',col_len = '1',field = 'active',col_precision = '' where tablename = 'sortingapplicabilityview' AND field = 'active'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','sortingapplicabilityview','N','','1','active','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingapplicabilityview' AND field = 'codesorkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'sortingapplicabilityview',denynull = 'S',format = '',col_len = '20',field = 'codesorkind',col_precision = '' where tablename = 'sortingapplicabilityview' AND field = 'codesorkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','sortingapplicabilityview','S','','20','codesorkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingapplicabilityview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'sortingapplicabilityview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'sortingapplicabilityview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','sortingapplicabilityview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingapplicabilityview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'sortingapplicabilityview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'sortingapplicabilityview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','sortingapplicabilityview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingapplicabilityview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'sortingapplicabilityview',denynull = 'S',format = '',col_len = '50',field = 'description',col_precision = '' where tablename = 'sortingapplicabilityview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','sortingapplicabilityview','S','','50','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingapplicabilityview' AND field = 'expensephase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'sortingapplicabilityview',denynull = 'N',format = '',col_len = '50',field = 'expensephase',col_precision = '' where tablename = 'sortingapplicabilityview' AND field = 'expensephase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','sortingapplicabilityview','N','','50','expensephase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingapplicabilityview' AND field = 'flagcheckavailability')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'sortingapplicabilityview',denynull = 'S',format = '',col_len = '1',field = 'flagcheckavailability',col_precision = '' where tablename = 'sortingapplicabilityview' AND field = 'flagcheckavailability'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(1)','N','sortingapplicabilityview','S','','1','flagcheckavailability','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingapplicabilityview' AND field = 'flagforced')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'sortingapplicabilityview',denynull = 'S',format = '',col_len = '1',field = 'flagforced',col_precision = '' where tablename = 'sortingapplicabilityview' AND field = 'flagforced'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(1)','N','sortingapplicabilityview','S','','1','flagforced','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingapplicabilityview' AND field = 'idsorkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'sortingapplicabilityview',denynull = 'S',format = '',col_len = '4',field = 'idsorkind',col_precision = '' where tablename = 'sortingapplicabilityview' AND field = 'idsorkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','sortingapplicabilityview','S','','4','idsorkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingapplicabilityview' AND field = 'incomephase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'sortingapplicabilityview',denynull = 'N',format = '',col_len = '50',field = 'incomephase',col_precision = '' where tablename = 'sortingapplicabilityview' AND field = 'incomephase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','sortingapplicabilityview','N','','50','incomephase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingapplicabilityview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'sortingapplicabilityview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'sortingapplicabilityview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','sortingapplicabilityview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingapplicabilityview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'sortingapplicabilityview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'sortingapplicabilityview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','sortingapplicabilityview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingapplicabilityview' AND field = 'nphaseexpense')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'sortingapplicabilityview',denynull = 'N',format = '',col_len = '1',field = 'nphaseexpense',col_precision = '' where tablename = 'sortingapplicabilityview' AND field = 'nphaseexpense'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','sortingapplicabilityview','N','','1','nphaseexpense','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingapplicabilityview' AND field = 'nphaseincome')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'sortingapplicabilityview',denynull = 'N',format = '',col_len = '1',field = 'nphaseincome',col_precision = '' where tablename = 'sortingapplicabilityview' AND field = 'nphaseincome'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','sortingapplicabilityview','N','','1','nphaseincome','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingapplicabilityview' AND field = 'tablename')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'sortingapplicabilityview',denynull = 'S',format = '',col_len = '150',field = 'tablename',col_precision = '' where tablename = 'sortingapplicabilityview' AND field = 'tablename'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','sortingapplicabilityview','S','','150','tablename','')
GO

-- VERIFICA DI sortingapplicabilityview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'sortingapplicabilityview')
UPDATE customobject set isreal = 'N' where objectname = 'sortingapplicabilityview'
ELSE
INSERT INTO customobject (objectname, isreal) values('sortingapplicabilityview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA sortingkindview
IF EXISTS(select * from sysobjects where id = object_id(N'[sortingkindview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [sortingkindview]
GO




CREATE VIEW sortingkindview
(
	idsorkind,
	codesorkind,
	description,
	nphaseincome,
	incomephase,
	nphaseexpense,
	expensephase,
	flagcheckavailability,
	flagforced,
	cu,
	ct,
	lu,
	lt
)
AS SELECT
	sortingkind.idsorkind,
	sortingkind.codesorkind,
	sortingkind.description,
	sortingkind.nphaseincome,
	incomephase.description,
	sortingkind.nphaseexpense,
	expensephase.description,
	CASE 
		WHEN  ((sortingkind.flag&2)<> 0) THEN 'S'
		ELSE  'N'
	END,
	CASE 
		WHEN  ((sortingkind.flag&1)<> 0) THEN 'S'
		ELSE 'N'
	END,
	sortingkind.cu,
	sortingkind.ct,
	sortingkind.lu,
	sortingkind.lt
FROM sortingkind 
LEFT OUTER JOIN incomephase 
	ON incomephase.nphase = sortingkind.nphaseincome
LEFT OUTER JOIN expensephase 
	ON expensephase.nphase = sortingkind.nphaseexpense



GO

-- VERIFICA DI sortingkindview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'sortingkindview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingkindview' AND field = 'codesorkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'sortingkindview',denynull = 'S',format = '',col_len = '20',field = 'codesorkind',col_precision = '' where tablename = 'sortingkindview' AND field = 'codesorkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','sortingkindview','S','','20','codesorkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingkindview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'sortingkindview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'sortingkindview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','sortingkindview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingkindview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'sortingkindview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'sortingkindview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','sortingkindview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingkindview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'sortingkindview',denynull = 'S',format = '',col_len = '50',field = 'description',col_precision = '' where tablename = 'sortingkindview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','sortingkindview','S','','50','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingkindview' AND field = 'expensephase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'sortingkindview',denynull = 'N',format = '',col_len = '50',field = 'expensephase',col_precision = '' where tablename = 'sortingkindview' AND field = 'expensephase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','sortingkindview','N','','50','expensephase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingkindview' AND field = 'flagcheckavailability')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'sortingkindview',denynull = 'S',format = '',col_len = '1',field = 'flagcheckavailability',col_precision = '' where tablename = 'sortingkindview' AND field = 'flagcheckavailability'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(1)','N','sortingkindview','S','','1','flagcheckavailability','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingkindview' AND field = 'flagforced')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'sortingkindview',denynull = 'S',format = '',col_len = '1',field = 'flagforced',col_precision = '' where tablename = 'sortingkindview' AND field = 'flagforced'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(1)','N','sortingkindview','S','','1','flagforced','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingkindview' AND field = 'idsorkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'sortingkindview',denynull = 'S',format = '',col_len = '4',field = 'idsorkind',col_precision = '' where tablename = 'sortingkindview' AND field = 'idsorkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','sortingkindview','S','','4','idsorkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingkindview' AND field = 'incomephase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'sortingkindview',denynull = 'N',format = '',col_len = '50',field = 'incomephase',col_precision = '' where tablename = 'sortingkindview' AND field = 'incomephase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','sortingkindview','N','','50','incomephase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingkindview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'sortingkindview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'sortingkindview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','sortingkindview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingkindview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'sortingkindview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'sortingkindview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','sortingkindview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingkindview' AND field = 'nphaseexpense')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'sortingkindview',denynull = 'N',format = '',col_len = '1',field = 'nphaseexpense',col_precision = '' where tablename = 'sortingkindview' AND field = 'nphaseexpense'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','sortingkindview','N','','1','nphaseexpense','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingkindview' AND field = 'nphaseincome')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'sortingkindview',denynull = 'N',format = '',col_len = '1',field = 'nphaseincome',col_precision = '' where tablename = 'sortingkindview' AND field = 'nphaseincome'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','sortingkindview','N','','1','nphaseincome','')
GO

-- VERIFICA DI sortingkindview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'sortingkindview')
UPDATE customobject set isreal = 'N' where objectname = 'sortingkindview'
ELSE
INSERT INTO customobject (objectname, isreal) values('sortingkindview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA sortingunusable
IF EXISTS(select * from sysobjects where id = object_id(N'[sortingunusable]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [sortingunusable]
GO




CREATE VIEW [sortingunusable]
(
	codesorkind,
	idsorkind,
	idsor,
	sortcode,
	nlevel,
	leveldescr,
	paridsor,
	description,
	cu, 
	ct, 
	lu, 
	lt,
	movkind
)
AS SELECT
	sortingkind.codesorkind,
	sorting.idsorkind,
	sorting.idsor,
	sorting.sortcode,
	sorting.nlevel,
	sortinglevel.description,
	sorting.paridsor,
	sorting.description,
	sorting.cu, 
	sorting.ct, 
	sorting.lu,
	sorting.lt,
	sorting.movkind
FROM sorting
JOIN sortinglevel
	ON sortinglevel.nlevel = sorting.nlevel
	AND sortinglevel.idsorkind = sorting.idsorkind
JOIN sortingkind
	ON sortingkind.idsorkind = sorting.idsorkind
WHERE (sortinglevel.flag & 2 = 0)
OR sorting.idsor IN
	(SELECT c1.paridsor FROM sorting c1
	WHERE c1.paridsor IS NOT NULL)



GO

-- VERIFICA DI sortingunusable IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'sortingunusable'
IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingunusable' AND field = 'codesorkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'sortingunusable',denynull = 'S',format = '',col_len = '20',field = 'codesorkind',col_precision = '' where tablename = 'sortingunusable' AND field = 'codesorkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','sortingunusable','S','','20','codesorkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingunusable' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'sortingunusable',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'sortingunusable' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','sortingunusable','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingunusable' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'sortingunusable',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'sortingunusable' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','sortingunusable','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingunusable' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(200)',iskey = 'N',tablename = 'sortingunusable',denynull = 'S',format = '',col_len = '200',field = 'description',col_precision = '' where tablename = 'sortingunusable' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(200)','N','sortingunusable','S','','200','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingunusable' AND field = 'idsor')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'sortingunusable',denynull = 'S',format = '',col_len = '4',field = 'idsor',col_precision = '' where tablename = 'sortingunusable' AND field = 'idsor'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','sortingunusable','S','','4','idsor','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingunusable' AND field = 'idsorkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'sortingunusable',denynull = 'S',format = '',col_len = '4',field = 'idsorkind',col_precision = '' where tablename = 'sortingunusable' AND field = 'idsorkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','sortingunusable','S','','4','idsorkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingunusable' AND field = 'leveldescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'sortingunusable',denynull = 'S',format = '',col_len = '50',field = 'leveldescr',col_precision = '' where tablename = 'sortingunusable' AND field = 'leveldescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','sortingunusable','S','','50','leveldescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingunusable' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'sortingunusable',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'sortingunusable' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','sortingunusable','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingunusable' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'sortingunusable',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'sortingunusable' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','sortingunusable','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingunusable' AND field = 'movkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'sortingunusable',denynull = 'N',format = '',col_len = '1',field = 'movkind',col_precision = '' where tablename = 'sortingunusable' AND field = 'movkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','sortingunusable','N','','1','movkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingunusable' AND field = 'nlevel')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'sortingunusable',denynull = 'S',format = '',col_len = '1',field = 'nlevel',col_precision = '' where tablename = 'sortingunusable' AND field = 'nlevel'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','sortingunusable','S','','1','nlevel','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingunusable' AND field = 'paridsor')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'sortingunusable',denynull = 'N',format = '',col_len = '4',field = 'paridsor',col_precision = '' where tablename = 'sortingunusable' AND field = 'paridsor'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','sortingunusable','N','','4','paridsor','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingunusable' AND field = 'sortcode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'sortingunusable',denynull = 'S',format = '',col_len = '50',field = 'sortcode',col_precision = '' where tablename = 'sortingunusable' AND field = 'sortcode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','sortingunusable','S','','50','sortcode','')
GO

-- VERIFICA DI sortingunusable IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'sortingunusable')
UPDATE customobject set isreal = 'N' where objectname = 'sortingunusable'
ELSE
INSERT INTO customobject (objectname, isreal) values('sortingunusable', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA sortingusable
IF EXISTS(select * from sysobjects where id = object_id(N'[sortingusable]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [sortingusable]
GO




CREATE VIEW [sortingusable]
(
	codesorkind,
	idsorkind,
	idsor,
	sortcode,
	nlevel,
	leveldescr,
	paridsor,
	description,
	cu, 
	ct, 
	lu, 
	lt,
	movkind
)
AS SELECT
	sortingkind.codesorkind,
	sorting.idsorkind,
	sorting.idsor,
	sorting.sortcode,
	sorting.nlevel,
	sortinglevel.description,
	sorting.paridsor,
	sorting.description,
	sorting.cu, 
	sorting.ct, 
	sorting.lu,
	sorting.lt,
	sorting.movkind
FROM sorting
JOIN sortinglevel
	ON sortinglevel.nlevel = sorting.nlevel
	AND sortinglevel.idsorkind = sorting.idsorkind
JOIN sortingkind
	ON sortingkind.idsorkind = sorting.idsorkind
WHERE ((sortinglevel.flag & 2) <> 0)
	AND sorting.idsor NOT IN
		(SELECT c1.paridsor FROM sorting c1
		WHERE c1.paridsor IS NOT NULL)



GO

-- VERIFICA DI sortingusable IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'sortingusable'
IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingusable' AND field = 'codesorkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'sortingusable',denynull = 'S',format = '',col_len = '20',field = 'codesorkind',col_precision = '' where tablename = 'sortingusable' AND field = 'codesorkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','sortingusable','S','','20','codesorkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingusable' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'sortingusable',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'sortingusable' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','sortingusable','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingusable' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'sortingusable',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'sortingusable' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','sortingusable','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingusable' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(200)',iskey = 'N',tablename = 'sortingusable',denynull = 'S',format = '',col_len = '200',field = 'description',col_precision = '' where tablename = 'sortingusable' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(200)','N','sortingusable','S','','200','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingusable' AND field = 'idsor')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'sortingusable',denynull = 'S',format = '',col_len = '4',field = 'idsor',col_precision = '' where tablename = 'sortingusable' AND field = 'idsor'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','sortingusable','S','','4','idsor','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingusable' AND field = 'idsorkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'sortingusable',denynull = 'S',format = '',col_len = '4',field = 'idsorkind',col_precision = '' where tablename = 'sortingusable' AND field = 'idsorkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','sortingusable','S','','4','idsorkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingusable' AND field = 'leveldescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'sortingusable',denynull = 'S',format = '',col_len = '50',field = 'leveldescr',col_precision = '' where tablename = 'sortingusable' AND field = 'leveldescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','sortingusable','S','','50','leveldescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingusable' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'sortingusable',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'sortingusable' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','sortingusable','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingusable' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'sortingusable',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'sortingusable' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','sortingusable','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingusable' AND field = 'movkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'sortingusable',denynull = 'N',format = '',col_len = '1',field = 'movkind',col_precision = '' where tablename = 'sortingusable' AND field = 'movkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','sortingusable','N','','1','movkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingusable' AND field = 'nlevel')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'sortingusable',denynull = 'S',format = '',col_len = '1',field = 'nlevel',col_precision = '' where tablename = 'sortingusable' AND field = 'nlevel'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','sortingusable','S','','1','nlevel','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingusable' AND field = 'paridsor')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'sortingusable',denynull = 'N',format = '',col_len = '4',field = 'paridsor',col_precision = '' where tablename = 'sortingusable' AND field = 'paridsor'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','sortingusable','N','','4','paridsor','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingusable' AND field = 'sortcode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'sortingusable',denynull = 'S',format = '',col_len = '50',field = 'sortcode',col_precision = '' where tablename = 'sortingusable' AND field = 'sortcode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','sortingusable','S','','50','sortcode','')
GO

-- VERIFICA DI sortingusable IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'sortingusable')
UPDATE customobject set isreal = 'N' where objectname = 'sortingusable'
ELSE
INSERT INTO customobject (objectname, isreal) values('sortingusable', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA sortingview
IF EXISTS(select * from sysobjects where id = object_id(N'[sortingview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [sortingview]
GO





CREATE VIEW [sortingview]
(
	codesorkind,
	idsorkind,
	sortingkind,
	idsor,
	sortcode,
	nlevel,
	leveldescr,
	paridsor,
	description,
	ayear,
	incomeprevision,
	expenseprevision,
	cu, 
	ct, 
	lu, 
	lt,
	defaultn1, 
	defaultn2,
	defaultn3, 
	defaultn4, 
	defaultn5, 
	defaults1, 
	defaults2, 
	defaults3, 
	defaults4, 
	defaults5, 
	flagnodate,
	movkind
)
AS SELECT
	sortingkind.codesorkind,
  	sorting.idsorkind,
	sortingkind.description,
	sorting.idsor,
	sorting.sortcode,
	sorting.nlevel,
	sortinglevel.description,
	sorting.paridsor,
	sorting.description,
	accountingyear.ayear,
	sortingprev.incomeprevision,
	sortingprev.expenseprevision,
	sorting.cu, 
	sorting.ct, 
	sorting.lu,
	sorting.lt, 
	sorting.defaultn1, 
	sorting.defaultn2,
	sorting.defaultn3, 
	sorting.defaultn4, 
	sorting.defaultn5, 
	sorting.defaults1, 
	sorting.defaults2, 
	sorting.defaults3, 
	sorting.defaults4, 
	sorting.defaults5, 
	sorting.flagnodate,
	sorting.movkind
FROM sorting
JOIN sortingkind
	ON sortingkind.idsorkind = sorting.idsorkind
CROSS JOIN accountingyear
JOIN sortinglevel
	ON sortinglevel.nlevel = sorting.nlevel
	AND sortinglevel.idsorkind = sorting.idsorkind
LEFT OUTER JOIN sortingprev
	ON sortingprev.idsor = sorting.idsor
	AND sortingprev.ayear = accountingyear.ayear




GO

-- VERIFICA DI sortingview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'sortingview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'sortingview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'sortingview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','sortingview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'codesorkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'sortingview',denynull = 'S',format = '',col_len = '20',field = 'codesorkind',col_precision = '' where tablename = 'sortingview' AND field = 'codesorkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','sortingview','S','','20','codesorkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'sortingview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'sortingview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','sortingview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'sortingview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'sortingview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','sortingview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'defaultn1')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(23,6)',iskey = 'N',tablename = 'sortingview',denynull = 'N',format = '',col_len = '13',field = 'defaultn1',col_precision = '23' where tablename = 'sortingview' AND field = 'defaultn1'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(23,6)','N','sortingview','N','','13','defaultn1','23')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'defaultn2')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(23,6)',iskey = 'N',tablename = 'sortingview',denynull = 'N',format = '',col_len = '13',field = 'defaultn2',col_precision = '23' where tablename = 'sortingview' AND field = 'defaultn2'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(23,6)','N','sortingview','N','','13','defaultn2','23')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'defaultn3')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(23,6)',iskey = 'N',tablename = 'sortingview',denynull = 'N',format = '',col_len = '13',field = 'defaultn3',col_precision = '23' where tablename = 'sortingview' AND field = 'defaultn3'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(23,6)','N','sortingview','N','','13','defaultn3','23')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'defaultn4')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(23,6)',iskey = 'N',tablename = 'sortingview',denynull = 'N',format = '',col_len = '13',field = 'defaultn4',col_precision = '23' where tablename = 'sortingview' AND field = 'defaultn4'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(23,6)','N','sortingview','N','','13','defaultn4','23')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'defaultn5')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(23,6)',iskey = 'N',tablename = 'sortingview',denynull = 'N',format = '',col_len = '13',field = 'defaultn5',col_precision = '23' where tablename = 'sortingview' AND field = 'defaultn5'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','6','decimal','','S','System.Decimal','decimal(23,6)','N','sortingview','N','','13','defaultn5','23')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'defaults1')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'sortingview',denynull = 'N',format = '',col_len = '20',field = 'defaults1',col_precision = '' where tablename = 'sortingview' AND field = 'defaults1'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','sortingview','N','','20','defaults1','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'defaults2')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'sortingview',denynull = 'N',format = '',col_len = '20',field = 'defaults2',col_precision = '' where tablename = 'sortingview' AND field = 'defaults2'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','sortingview','N','','20','defaults2','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'defaults3')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'sortingview',denynull = 'N',format = '',col_len = '20',field = 'defaults3',col_precision = '' where tablename = 'sortingview' AND field = 'defaults3'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','sortingview','N','','20','defaults3','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'defaults4')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'sortingview',denynull = 'N',format = '',col_len = '20',field = 'defaults4',col_precision = '' where tablename = 'sortingview' AND field = 'defaults4'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','sortingview','N','','20','defaults4','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'defaults5')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'sortingview',denynull = 'N',format = '',col_len = '20',field = 'defaults5',col_precision = '' where tablename = 'sortingview' AND field = 'defaults5'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','sortingview','N','','20','defaults5','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(200)',iskey = 'N',tablename = 'sortingview',denynull = 'S',format = '',col_len = '200',field = 'description',col_precision = '' where tablename = 'sortingview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(200)','N','sortingview','S','','200','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'expenseprevision')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'sortingview',denynull = 'N',format = '',col_len = '9',field = 'expenseprevision',col_precision = '19' where tablename = 'sortingview' AND field = 'expenseprevision'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','sortingview','N','','9','expenseprevision','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'flagnodate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'sortingview',denynull = 'N',format = '',col_len = '1',field = 'flagnodate',col_precision = '' where tablename = 'sortingview' AND field = 'flagnodate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','sortingview','N','','1','flagnodate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'idsor')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'sortingview',denynull = 'S',format = '',col_len = '4',field = 'idsor',col_precision = '' where tablename = 'sortingview' AND field = 'idsor'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','sortingview','S','','4','idsor','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'idsorkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'sortingview',denynull = 'S',format = '',col_len = '4',field = 'idsorkind',col_precision = '' where tablename = 'sortingview' AND field = 'idsorkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','sortingview','S','','4','idsorkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'incomeprevision')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'sortingview',denynull = 'N',format = '',col_len = '9',field = 'incomeprevision',col_precision = '19' where tablename = 'sortingview' AND field = 'incomeprevision'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','sortingview','N','','9','incomeprevision','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'leveldescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'sortingview',denynull = 'S',format = '',col_len = '50',field = 'leveldescr',col_precision = '' where tablename = 'sortingview' AND field = 'leveldescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','sortingview','S','','50','leveldescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'sortingview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'sortingview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','sortingview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'sortingview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'sortingview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','sortingview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'movkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'sortingview',denynull = 'N',format = '',col_len = '1',field = 'movkind',col_precision = '' where tablename = 'sortingview' AND field = 'movkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','sortingview','N','','1','movkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'nlevel')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'sortingview',denynull = 'S',format = '',col_len = '1',field = 'nlevel',col_precision = '' where tablename = 'sortingview' AND field = 'nlevel'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','sortingview','S','','1','nlevel','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'paridsor')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'sortingview',denynull = 'N',format = '',col_len = '4',field = 'paridsor',col_precision = '' where tablename = 'sortingview' AND field = 'paridsor'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','sortingview','N','','4','paridsor','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'sortcode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'sortingview',denynull = 'S',format = '',col_len = '50',field = 'sortcode',col_precision = '' where tablename = 'sortingview' AND field = 'sortcode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','sortingview','S','','50','sortcode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'sortingview' AND field = 'sortingkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'sortingview',denynull = 'S',format = '',col_len = '50',field = 'sortingkind',col_precision = '' where tablename = 'sortingview' AND field = 'sortingkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','sortingview','S','','50','sortingkind','')
GO

-- VERIFICA DI sortingview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'sortingview')
UPDATE customobject set isreal = 'N' where objectname = 'sortingview'
ELSE
INSERT INTO customobject (objectname, isreal) values('sortingview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA taxpayexpenseview
IF EXISTS(select * from sysobjects where id = object_id(N'[taxpayexpenseview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [taxpayexpenseview]
GO


CREATE   VIEW taxpayexpenseview 
(
	ytaxpay,
	ntaxpay,
	taxcode,
	taxref,
	taxdescription,
	idexp,
	nphase,
	phase,
	ymov,
	nmov,
	parentidexp,
	parentymov,
	parentnmov,
	ayear,
	idfin,
	codefin,
	finance,
	idupb,
	codeupb,
	upb,
	idreg,
	registry,
	idman,
	manager,
	kpay,
	ypay,
	npay,
	doc,
	docdate,
	description,
	amount,
	ayearstartamount,
	curramount,
	available,
	idpaymethod,
	iban,
	cin,
	idbank,
	idcab,
	cc,
	paymentdescr,
	idser,
	service,
	servicestart,
	servicestop,
	ivaamount,
	flag,
	autokind,
	idpayment,
	totflag,
	flagarrear,
	expiration,
	adate,
	txt,
	cu,
	ct,
	lu,
	lt
)
AS SELECT
	taxpayexpense.ytaxpay,
	taxpayexpense.ntaxpay,
	taxpayexpense.taxcode,
	tax.taxref,
	tax.description,
	expense.idexp,
	expense.nphase,
	expensephase.description,
	expense.ymov,
	expense.nmov,
	expense.parentidexp,
	parentexpense.ymov,
	parentexpense.nmov,
	expenseyear.ayear,
	expenseyear.idfin,
	fin.codefin,
	fin.title,
	expenseyear.idupb,
	upb.codeupb,
	upb.title,
	expense.idreg,
	registry.title,
	expense.idman, 
	manager.title,
	payment.kpay,
	payment.ypay,
	payment.npay,
	expense.doc,
	expense.docdate,
	expense.description,
	expenseyear_starting.amount,
	expenseyear.amount,
	expensetotal.curramount,
	expensetotal.available,
	expenselast.idpaymethod,
	expenselast.iban,
	expenselast.cin,
	expenselast.idbank,
	expenselast.idcab,
	expenselast.cc,
	expenselast.paymentdescr,
	expenselast.idser,
	service.description,
	expenselast.servicestart,
	expenselast.servicestop,
	expenselast.ivaamount,
	expenselast.flag,
  	expense.autokind,
	expense.idpayment,
	expensetotal.flag,
	CASE
		WHEN ((expensetotal.flag&1)=0) THEN 'C'
		WHEN ((expensetotal.flag&1)=1) THEN 'R'
	END, 
	expense.expiration,
	expense.adate,
	expense.txt,
	taxpayexpense.cu,
	taxpayexpense.ct,
	taxpayexpense.lu,
	taxpayexpense.lt
FROM taxpayexpense
JOIN expense 
	ON taxpayexpense.idexp = expense.idexp
JOIN expensephase
	ON expensephase.nphase = expense.nphase
JOIN expenseyear 
	ON expenseyear.idexp = expense.idexp
JOIN expensetotal
	ON expensetotal.idexp = expenseyear.idexp
	AND expensetotal.ayear = expenseyear.ayear
LEFT OUTER JOIN expenselast
	ON expense.idexp = expenselast.idexp
LEFT OUTER JOIN payment
	ON payment.kpay = expenselast.kpay
LEFT OUTER JOIN expense parentexpense
	ON expense.parentidexp = parentexpense.idexp
LEFT OUTER JOIN expensetotal expensetotal_firstyear
	ON expensetotal_firstyear.idexp = expense.idexp
	AND ((expensetotal_firstyear.flag & 2) <> 0 )
LEFT OUTER JOIN expenseyear expenseyear_starting
	ON expenseyear_starting.idexp = expensetotal_firstyear.idexp
	AND expenseyear_starting.ayear = expensetotal_firstyear.ayear
LEFT OUTER JOIN fin
	ON fin.idfin = expenseyear.idfin
LEFT OUTER JOIN upb
	ON upb.idupb = expenseyear.idupb
LEFT OUTER JOIN registry
	ON registry.idreg = expense.idreg
LEFT OUTER JOIN manager
	ON manager.idman = expense.idman
LEFT OUTER JOIN service
	ON service.idser = expenselast.idser
LEFT OUTER JOIN tax
	ON tax.taxcode = taxpayexpense.taxcode



GO

-- VERIFICA DI taxpayexpenseview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'taxpayexpenseview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','taxpayexpenseview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'taxpayexpenseview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','taxpayexpenseview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'autokind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '1',field = 'autokind',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'autokind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','taxpayexpenseview','N','','1','autokind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'available')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '9',field = 'available',col_precision = '19' where tablename = 'taxpayexpenseview' AND field = 'available'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','taxpayexpenseview','N','','9','available','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','taxpayexpenseview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'ayearstartamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '9',field = 'ayearstartamount',col_precision = '19' where tablename = 'taxpayexpenseview' AND field = 'ayearstartamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','taxpayexpenseview','N','','9','ayearstartamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'cc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(30)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '30',field = 'cc',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'cc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(30)','N','taxpayexpenseview','N','','30','cc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'cin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(2)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '2',field = 'cin',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'cin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(2)','N','taxpayexpenseview','N','','2','cin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'codefin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','taxpayexpenseview','N','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','taxpayexpenseview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','taxpayexpenseview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','taxpayexpenseview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'curramount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '9',field = 'curramount',col_precision = '19' where tablename = 'taxpayexpenseview' AND field = 'curramount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','taxpayexpenseview','N','','9','curramount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','taxpayexpenseview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'doc')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(35)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '35',field = 'doc',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'doc'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(35)','N','taxpayexpenseview','N','','35','doc','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'docdate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'docdate',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'docdate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','taxpayexpenseview','N','','4','docdate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'expiration')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'expiration',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','S','System.DateTime','smalldatetime','N','taxpayexpenseview','N','','4','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'finance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '150',field = 'finance',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'finance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','taxpayexpenseview','N','','150','finance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'flag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','taxpayexpenseview','N','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'flagarrear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '1',field = 'flagarrear',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'flagarrear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(1)','N','taxpayexpenseview','N','','1','flagarrear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'iban')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '50',field = 'iban',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'iban'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','taxpayexpenseview','N','','50','iban','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'idbank')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '20',field = 'idbank',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'idbank'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','taxpayexpenseview','N','','20','idbank','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'idcab')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '20',field = 'idcab',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'idcab'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','taxpayexpenseview','N','','20','idcab','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'idexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'S',format = '',col_len = '4',field = 'idexp',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'idexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','taxpayexpenseview','S','','4','idexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'idfin')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','taxpayexpenseview','N','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'idman')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','taxpayexpenseview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'idpayment')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idpayment',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'idpayment'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','taxpayexpenseview','N','','4','idpayment','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'idpaymethod')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idpaymethod',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'idpaymethod'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','taxpayexpenseview','N','','4','idpaymethod','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','taxpayexpenseview','N','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','taxpayexpenseview','N','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','taxpayexpenseview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'ivaamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '9',field = 'ivaamount',col_precision = '19' where tablename = 'taxpayexpenseview' AND field = 'ivaamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','taxpayexpenseview','N','','9','ivaamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'kpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'kpay',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'kpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','taxpayexpenseview','N','','4','kpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','taxpayexpenseview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','taxpayexpenseview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'manager')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','taxpayexpenseview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'nmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'S',format = '',col_len = '4',field = 'nmov',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'nmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','taxpayexpenseview','S','','4','nmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'npay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'npay',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'npay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','taxpayexpenseview','N','','4','npay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'nphase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'S',format = '',col_len = '1',field = 'nphase',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'nphase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','N','System.Byte','tinyint','N','taxpayexpenseview','S','','1','nphase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'ntaxpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'S',format = '',col_len = '4',field = 'ntaxpay',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'ntaxpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','taxpayexpenseview','S','','4','ntaxpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'parentidexp')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'parentidexp',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'parentidexp'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','taxpayexpenseview','N','','4','parentidexp','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'parentnmov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '4',field = 'parentnmov',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'parentnmov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','taxpayexpenseview','N','','4','parentnmov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'parentymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '2',field = 'parentymov',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'parentymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','taxpayexpenseview','N','','2','parentymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'paymentdescr')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '150',field = 'paymentdescr',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'paymentdescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','taxpayexpenseview','N','','150','paymentdescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'phase')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'S',format = '',col_len = '50',field = 'phase',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'phase'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','taxpayexpenseview','S','','50','phase','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(100)','N','taxpayexpenseview','N','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','taxpayexpenseview','N','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'servicestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '8',field = 'servicestart',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'servicestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','taxpayexpenseview','N','','8','servicestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'servicestop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '8',field = 'servicestop',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'servicestop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','S','System.DateTime','datetime','N','taxpayexpenseview','N','','8','servicestop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'taxcode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'S',format = '',col_len = '4',field = 'taxcode',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'taxcode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','taxpayexpenseview','S','','4','taxcode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'taxdescription')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '50',field = 'taxdescription',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'taxdescription'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','taxpayexpenseview','N','','50','taxdescription','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'taxref')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '20',field = 'taxref',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'taxref'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','taxpayexpenseview','N','','20','taxref','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'totflag')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'S',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '1',field = 'totflag',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'totflag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','tinyint','','S','System.Byte','tinyint','N','taxpayexpenseview','N','','1','totflag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'txt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'text',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'text',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '16',field = 'txt',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'txt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','text','','S','System.String','text','N','taxpayexpenseview','N','','16','txt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','taxpayexpenseview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'ymov')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'S',format = '',col_len = '2',field = 'ymov',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'ymov'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','taxpayexpenseview','S','','2','ymov','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'ypay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'N',format = '',col_len = '2',field = 'ypay',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'ypay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','S','System.Int16','smallint','N','taxpayexpenseview','N','','2','ypay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayexpenseview' AND field = 'ytaxpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'taxpayexpenseview',denynull = 'S',format = '',col_len = '2',field = 'ytaxpay',col_precision = '' where tablename = 'taxpayexpenseview' AND field = 'ytaxpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','taxpayexpenseview','S','','2','ytaxpay','')
GO

-- VERIFICA DI taxpayexpenseview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'taxpayexpenseview')
UPDATE customobject set isreal = 'N' where objectname = 'taxpayexpenseview'
ELSE
INSERT INTO customobject (objectname, isreal) values('taxpayexpenseview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA taxpaymentpartsetupview
IF EXISTS(select * from sysobjects where id = object_id(N'[taxpaymentpartsetupview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [taxpaymentpartsetupview]
GO





CREATE VIEW taxpaymentpartsetupview 
	(
  taxcode,
  taxref,
  taxkind,
  ayear,
  idreg,
  registry,
  percentage,
	cu,
	ct,
	lu,
	lt
  )
  AS SELECT
  taxpaymentpartsetup.taxcode,
  tax.taxref,
  tax.description,
  taxpaymentpartsetup.ayear,
  taxpaymentpartsetup.idreg,
  registry.title,
	taxpaymentpartsetup.percentage,
  taxpaymentpartsetup.cu,
  taxpaymentpartsetup.ct,
  taxpaymentpartsetup.lu,
  taxpaymentpartsetup.lt
  FROM taxpaymentpartsetup (NOLOCK)
JOIN tax (NOLOCK)
  ON tax.taxcode = taxpaymentpartsetup.taxcode
  JOIN registry (NOLOCK)
  ON registry.idreg = taxpaymentpartsetup.idreg










GO

-- VERIFICA DI taxpaymentpartsetupview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'taxpaymentpartsetupview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpaymentpartsetupview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'taxpaymentpartsetupview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'taxpaymentpartsetupview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','taxpaymentpartsetupview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpaymentpartsetupview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'taxpaymentpartsetupview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'taxpaymentpartsetupview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','taxpaymentpartsetupview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpaymentpartsetupview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'taxpaymentpartsetupview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'taxpaymentpartsetupview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','taxpaymentpartsetupview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpaymentpartsetupview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxpaymentpartsetupview',denynull = 'S',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'taxpaymentpartsetupview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','taxpaymentpartsetupview','S','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpaymentpartsetupview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'taxpaymentpartsetupview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'taxpaymentpartsetupview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','taxpaymentpartsetupview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpaymentpartsetupview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'taxpaymentpartsetupview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'taxpaymentpartsetupview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','taxpaymentpartsetupview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpaymentpartsetupview' AND field = 'percentage')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '8',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,8)',iskey = 'N',tablename = 'taxpaymentpartsetupview',denynull = 'N',format = '',col_len = '9',field = 'percentage',col_precision = '19' where tablename = 'taxpaymentpartsetupview' AND field = 'percentage'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','8','decimal','','S','System.Decimal','decimal(19,8)','N','taxpaymentpartsetupview','N','','9','percentage','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpaymentpartsetupview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'taxpaymentpartsetupview',denynull = 'S',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'taxpaymentpartsetupview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(100)','N','taxpaymentpartsetupview','S','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpaymentpartsetupview' AND field = 'taxcode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxpaymentpartsetupview',denynull = 'S',format = '',col_len = '4',field = 'taxcode',col_precision = '' where tablename = 'taxpaymentpartsetupview' AND field = 'taxcode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','taxpaymentpartsetupview','S','','4','taxcode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpaymentpartsetupview' AND field = 'taxkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'taxpaymentpartsetupview',denynull = 'S',format = '',col_len = '50',field = 'taxkind',col_precision = '' where tablename = 'taxpaymentpartsetupview' AND field = 'taxkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','taxpaymentpartsetupview','S','','50','taxkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpaymentpartsetupview' AND field = 'taxref')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'taxpaymentpartsetupview',denynull = 'S',format = '',col_len = '20',field = 'taxref',col_precision = '' where tablename = 'taxpaymentpartsetupview' AND field = 'taxref'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','taxpaymentpartsetupview','S','','20','taxref','')
GO

-- VERIFICA DI taxpaymentpartsetupview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'taxpaymentpartsetupview')
UPDATE customobject set isreal = 'N' where objectname = 'taxpaymentpartsetupview'
ELSE
INSERT INTO customobject (objectname, isreal) values('taxpaymentpartsetupview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA taxpayview
IF EXISTS(select * from sysobjects where id = object_id(N'[taxpayview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [taxpayview]
GO





CREATE VIEW taxpayview 
(
	taxcode,
	taxref,
	taxkind,
	ytaxpay,
	ntaxpay,
	start,
	stop,
	description,
	amount,
	adate,
	cu,
	ct,
	lu,
	lt
)
AS SELECT
	taxpay.taxcode,
	tax.taxref,
	tax.description,
	taxpay.ytaxpay,
	taxpay.ntaxpay,
	taxpay.start,
	taxpay.stop,
	taxpay.description,
	taxpay.amount,
	taxpay.adate,
	taxpay.cu,
	taxpay.ct,
	taxpay.lu,
	taxpay.lt
FROM taxpay
JOIN tax
	ON tax.taxcode = taxpay.taxcode




GO

-- VERIFICA DI taxpayview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'taxpayview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'taxpayview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'taxpayview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','taxpayview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayview' AND field = 'amount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'taxpayview',denynull = 'N',format = '',col_len = '9',field = 'amount',col_precision = '19' where tablename = 'taxpayview' AND field = 'amount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','taxpayview','N','','9','amount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'taxpayview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'taxpayview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','taxpayview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'taxpayview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'taxpayview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','taxpayview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'taxpayview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'taxpayview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','taxpayview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'taxpayview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'taxpayview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','taxpayview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'taxpayview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'taxpayview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','taxpayview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayview' AND field = 'ntaxpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxpayview',denynull = 'S',format = '',col_len = '4',field = 'ntaxpay',col_precision = '' where tablename = 'taxpayview' AND field = 'ntaxpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','taxpayview','S','','4','ntaxpay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayview' AND field = 'start')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'taxpayview',denynull = 'S',format = '',col_len = '4',field = 'start',col_precision = '' where tablename = 'taxpayview' AND field = 'start'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','taxpayview','S','','4','start','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayview' AND field = 'stop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'taxpayview',denynull = 'S',format = '',col_len = '4',field = 'stop',col_precision = '' where tablename = 'taxpayview' AND field = 'stop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','taxpayview','S','','4','stop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayview' AND field = 'taxcode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxpayview',denynull = 'S',format = '',col_len = '4',field = 'taxcode',col_precision = '' where tablename = 'taxpayview' AND field = 'taxcode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','taxpayview','S','','4','taxcode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayview' AND field = 'taxkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'taxpayview',denynull = 'S',format = '',col_len = '50',field = 'taxkind',col_precision = '' where tablename = 'taxpayview' AND field = 'taxkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','taxpayview','S','','50','taxkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayview' AND field = 'taxref')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'taxpayview',denynull = 'S',format = '',col_len = '20',field = 'taxref',col_precision = '' where tablename = 'taxpayview' AND field = 'taxref'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','taxpayview','S','','20','taxref','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxpayview' AND field = 'ytaxpay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'taxpayview',denynull = 'S',format = '',col_len = '2',field = 'ytaxpay',col_precision = '' where tablename = 'taxpayview' AND field = 'ytaxpay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','taxpayview','S','','2','ytaxpay','')
GO

-- VERIFICA DI taxpayview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'taxpayview')
UPDATE customobject set isreal = 'N' where objectname = 'taxpayview'
ELSE
INSERT INTO customobject (objectname, isreal) values('taxpayview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA taxratebracketview
IF EXISTS(select * from sysobjects where id = object_id(N'[dbo].[taxratebracketview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [dbo].[taxratebracketview]
GO





CREATE     VIEW [DBO].taxratebracketview 
(
	taxcode,
	tax,
	taxref,
	idtaxratestart,
	nbracket,
	start,
	taxkind,
	minamount,
	maxamount,
	taxablenumerator,
	taxabledenominator,
	adminrate,
	adminnumerator,
	admindenominator,
	employrate,
	employnumerator,
	employdenominator,
	lu,
	lt
)
AS SELECT
	B.taxcode,
	T.description,
	T.taxref,
	B.idtaxratestart,
	B.nbracket,
	S.start,
	T.taxkind,
	B.minamount,
	B.maxamount,
	B.taxablenumerator,
	B.taxabledenominator,
	B.adminrate,
	B.adminnumerator,
	B.admindenominator,
	B.employrate,
	B.employnumerator,
	B.employdenominator,
	B.lu,
	B.lt
FROM taxratebracket B
JOIN taxratestart S
	ON B.taxcode = S.taxcode
	AND B.idtaxratestart = S.idtaxratestart
JOIN tax T
	ON T.taxcode = B.taxcode






GO

-- VERIFICA DI taxratebracketview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'taxratebracketview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'taxratebracketview' AND field = 'admindenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '8',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,8)',iskey = 'N',tablename = 'taxratebracketview',denynull = 'S',format = '',col_len = '9',field = 'admindenominator',col_precision = '19' where tablename = 'taxratebracketview' AND field = 'admindenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','8','decimal','','N','System.Decimal','decimal(19,8)','N','taxratebracketview','S','','9','admindenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxratebracketview' AND field = 'adminnumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '8',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,8)',iskey = 'N',tablename = 'taxratebracketview',denynull = 'S',format = '',col_len = '9',field = 'adminnumerator',col_precision = '19' where tablename = 'taxratebracketview' AND field = 'adminnumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','8','decimal','','N','System.Decimal','decimal(19,8)','N','taxratebracketview','S','','9','adminnumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxratebracketview' AND field = 'adminrate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '8',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,8)',iskey = 'N',tablename = 'taxratebracketview',denynull = 'S',format = '',col_len = '9',field = 'adminrate',col_precision = '19' where tablename = 'taxratebracketview' AND field = 'adminrate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','8','decimal','','N','System.Decimal','decimal(19,8)','N','taxratebracketview','S','','9','adminrate','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxratebracketview' AND field = 'employdenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '8',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,8)',iskey = 'N',tablename = 'taxratebracketview',denynull = 'S',format = '',col_len = '9',field = 'employdenominator',col_precision = '19' where tablename = 'taxratebracketview' AND field = 'employdenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','8','decimal','','N','System.Decimal','decimal(19,8)','N','taxratebracketview','S','','9','employdenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxratebracketview' AND field = 'employnumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '8',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,8)',iskey = 'N',tablename = 'taxratebracketview',denynull = 'S',format = '',col_len = '9',field = 'employnumerator',col_precision = '19' where tablename = 'taxratebracketview' AND field = 'employnumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','8','decimal','','N','System.Decimal','decimal(19,8)','N','taxratebracketview','S','','9','employnumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxratebracketview' AND field = 'employrate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '8',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,8)',iskey = 'N',tablename = 'taxratebracketview',denynull = 'S',format = '',col_len = '9',field = 'employrate',col_precision = '19' where tablename = 'taxratebracketview' AND field = 'employrate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','8','decimal','','N','System.Decimal','decimal(19,8)','N','taxratebracketview','S','','9','employrate','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxratebracketview' AND field = 'idtaxratestart')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxratebracketview',denynull = 'S',format = '',col_len = '4',field = 'idtaxratestart',col_precision = '' where tablename = 'taxratebracketview' AND field = 'idtaxratestart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','taxratebracketview','S','','4','idtaxratestart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxratebracketview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'taxratebracketview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'taxratebracketview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','taxratebracketview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxratebracketview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'taxratebracketview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'taxratebracketview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','taxratebracketview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxratebracketview' AND field = 'maxamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'taxratebracketview',denynull = 'N',format = '',col_len = '9',field = 'maxamount',col_precision = '19' where tablename = 'taxratebracketview' AND field = 'maxamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','taxratebracketview','N','','9','maxamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxratebracketview' AND field = 'minamount')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'taxratebracketview',denynull = 'N',format = '',col_len = '9',field = 'minamount',col_precision = '19' where tablename = 'taxratebracketview' AND field = 'minamount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','taxratebracketview','N','','9','minamount','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxratebracketview' AND field = 'nbracket')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'taxratebracketview',denynull = 'S',format = '',col_len = '2',field = 'nbracket',col_precision = '' where tablename = 'taxratebracketview' AND field = 'nbracket'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','taxratebracketview','S','','2','nbracket','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxratebracketview' AND field = 'start')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'taxratebracketview',denynull = 'S',format = '',col_len = '8',field = 'start',col_precision = '' where tablename = 'taxratebracketview' AND field = 'start'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','taxratebracketview','S','','8','start','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxratebracketview' AND field = 'tax')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'taxratebracketview',denynull = 'S',format = '',col_len = '50',field = 'tax',col_precision = '' where tablename = 'taxratebracketview' AND field = 'tax'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','taxratebracketview','S','','50','tax','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxratebracketview' AND field = 'taxabledenominator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '8',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,8)',iskey = 'N',tablename = 'taxratebracketview',denynull = 'S',format = '',col_len = '9',field = 'taxabledenominator',col_precision = '19' where tablename = 'taxratebracketview' AND field = 'taxabledenominator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','8','decimal','','N','System.Decimal','decimal(19,8)','N','taxratebracketview','S','','9','taxabledenominator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxratebracketview' AND field = 'taxablenumerator')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '8',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,8)',iskey = 'N',tablename = 'taxratebracketview',denynull = 'S',format = '',col_len = '9',field = 'taxablenumerator',col_precision = '19' where tablename = 'taxratebracketview' AND field = 'taxablenumerator'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','8','decimal','','N','System.Decimal','decimal(19,8)','N','taxratebracketview','S','','9','taxablenumerator','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxratebracketview' AND field = 'taxcode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxratebracketview',denynull = 'S',format = '',col_len = '4',field = 'taxcode',col_precision = '' where tablename = 'taxratebracketview' AND field = 'taxcode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','taxratebracketview','S','','4','taxcode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxratebracketview' AND field = 'taxkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'taxratebracketview',denynull = 'S',format = '',col_len = '2',field = 'taxkind',col_precision = '' where tablename = 'taxratebracketview' AND field = 'taxkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','taxratebracketview','S','','2','taxkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxratebracketview' AND field = 'taxref')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'taxratebracketview',denynull = 'S',format = '',col_len = '20',field = 'taxref',col_precision = '' where tablename = 'taxratebracketview' AND field = 'taxref'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','taxratebracketview','S','','20','taxref','')
GO

-- VERIFICA DI taxratebracketview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'taxratebracketview')
UPDATE customobject set isreal = 'N' where objectname = 'taxratebracketview'
ELSE
INSERT INTO customobject (objectname, isreal) values('taxratebracketview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA taxview
IF EXISTS(select * from sysobjects where id = object_id(N'[taxview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [taxview]
GO









CREATE   VIEW taxview 
(
	taxcode,
	taxref,
	active,
	appliancebasis,
	description,
	fiscaltaxcode,
	flagunabatable,
	geoappliance,
	idaccmotive_cost,
	idaccmotive_debit,
	idaccmotive_pay,
	taxablecode,
	taxkind,
	maintaxcode,
	ct,
	cu,
	lt,
	lu
)
AS SELECT
	taxcode,
	taxref,
	active,
	appliancebasis,
	description,
	fiscaltaxcode,
	flagunabatable,
	geoappliance,
	idaccmotive_cost,
	idaccmotive_debit,
	idaccmotive_pay,
	taxablecode,
	taxkind,
	maintaxcode,
	ct,
	cu,
	lt,
	lu
FROM tax





GO

-- VERIFICA DI taxview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'taxview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'taxview' AND field = 'active')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'taxview',denynull = 'N',format = '',col_len = '1',field = 'active',col_precision = '' where tablename = 'taxview' AND field = 'active'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','taxview','N','','1','active','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxview' AND field = 'appliancebasis')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'taxview',denynull = 'N',format = '',col_len = '1',field = 'appliancebasis',col_precision = '' where tablename = 'taxview' AND field = 'appliancebasis'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','taxview','N','','1','appliancebasis','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'taxview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'taxview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','taxview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'taxview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'taxview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','taxview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'taxview',denynull = 'S',format = '',col_len = '50',field = 'description',col_precision = '' where tablename = 'taxview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','taxview','S','','50','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxview' AND field = 'fiscaltaxcode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'taxview',denynull = 'N',format = '',col_len = '20',field = 'fiscaltaxcode',col_precision = '' where tablename = 'taxview' AND field = 'fiscaltaxcode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','taxview','N','','20','fiscaltaxcode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxview' AND field = 'flagunabatable')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'taxview',denynull = 'N',format = '',col_len = '1',field = 'flagunabatable',col_precision = '' where tablename = 'taxview' AND field = 'flagunabatable'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','taxview','N','','1','flagunabatable','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxview' AND field = 'geoappliance')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'taxview',denynull = 'N',format = '',col_len = '1',field = 'geoappliance',col_precision = '' where tablename = 'taxview' AND field = 'geoappliance'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','taxview','N','','1','geoappliance','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxview' AND field = 'idaccmotive_cost')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'taxview',denynull = 'N',format = '',col_len = '36',field = 'idaccmotive_cost',col_precision = '' where tablename = 'taxview' AND field = 'idaccmotive_cost'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','taxview','N','','36','idaccmotive_cost','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxview' AND field = 'idaccmotive_debit')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'taxview',denynull = 'N',format = '',col_len = '36',field = 'idaccmotive_debit',col_precision = '' where tablename = 'taxview' AND field = 'idaccmotive_debit'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','taxview','N','','36','idaccmotive_debit','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxview' AND field = 'idaccmotive_pay')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'taxview',denynull = 'N',format = '',col_len = '36',field = 'idaccmotive_pay',col_precision = '' where tablename = 'taxview' AND field = 'idaccmotive_pay'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','taxview','N','','36','idaccmotive_pay','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'taxview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'taxview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','taxview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'taxview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'taxview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','taxview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxview' AND field = 'maintaxcode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxview',denynull = 'N',format = '',col_len = '4',field = 'maintaxcode',col_precision = '' where tablename = 'taxview' AND field = 'maintaxcode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','taxview','N','','4','maintaxcode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxview' AND field = 'taxablecode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'taxview',denynull = 'N',format = '',col_len = '20',field = 'taxablecode',col_precision = '' where tablename = 'taxview' AND field = 'taxablecode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(20)','N','taxview','N','','20','taxablecode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxview' AND field = 'taxcode')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'taxview',denynull = 'S',format = '',col_len = '4',field = 'taxcode',col_precision = '' where tablename = 'taxview' AND field = 'taxcode'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','taxview','S','','4','taxcode','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxview' AND field = 'taxkind')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'taxview',denynull = 'S',format = '',col_len = '2',field = 'taxkind',col_precision = '' where tablename = 'taxview' AND field = 'taxkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','smallint','','N','System.Int16','smallint','N','taxview','S','','2','taxkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'taxview' AND field = 'taxref')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'taxview',denynull = 'S',format = '',col_len = '20',field = 'taxref',col_precision = '' where tablename = 'taxview' AND field = 'taxref'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','taxview','S','','20','taxref','')
GO

-- VERIFICA DI taxview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'taxview')
UPDATE customobject set isreal = 'N' where objectname = 'taxview'
ELSE
INSERT INTO customobject (objectname, isreal) values('taxview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA wageadditionview
IF EXISTS(select * from sysobjects where id = object_id(N'[wageadditionview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [wageadditionview]
GO




CREATE VIEW [wageadditionview]
(
	ayear,
	ycon,
	ncon,
	start,
	stop,
	adate,
	idreg,
	registry,
	feegross,
	idser,
	service,
	codeser,
	description,
	ndays,
	idposition,
	position,
	idcontractlength,
	contractlength,
	idworkingtime,
	workingtime,
	idaccmotive,
	codemotive,
	idupb,
	codeupb,
	upb,
	idsor1,
	idsor2,
	idsor3,
	cu,
	ct,
	lu,
	lt,
	txt,
	completed
)
AS SELECT 
	ICD.ayear,
	CD.ycon,
	CD.ncon,
	CD.start,
	CD.stop,
	CD.adate,
	CD.idreg,
	registry.title as registry,
	CD.feegross,
	CD.idser,
	service.description,
	service.codeser,
	CD.description,
	CD.ndays,
	ICD.idposition,
	QR.description AS position,
	ICD.idcontractlength,
	DR.description AS contractlength,
	ICD.idworkingtime,
	ORAP.description AS workingtime,
	CD.idaccmotive,
	AM.codemotive,
	CD.idupb,
	upb.codeupb,
	upb.title,
	CD.idsor1,
	CD.idsor2,
	CD.idsor3,
	CD.cu,
	CD.ct,
	CD.lu,
	CD.lt,
	CD.txt,
	CD.completed
FROM wageaddition CD
JOIN wageadditionyear ICD
	ON CD.ycon = ICD.ycon
	AND CD.ncon = ICD.ncon
JOIN registry
	ON registry.idreg = CD.idreg
JOIN service
	ON service.idser = CD.idser
LEFT OUTER JOIN upb
	ON upb.idupb=CD.idupb
LEFT OUTER JOIN positionworkcontract QR
	ON QR.idposition = ICD.idposition
	AND QR.ayear = ICD.ayear
LEFT OUTER JOIN contractlength DR
	ON DR.idcontractlength = ICD.idcontractlength
	AND DR.ayear = ICD.ayear
LEFT OUTER JOIN workingtime ORAP
	ON ORAP.idworkingtime = ICD.idworkingtime
	AND ORAP.ayear = ICD.ayear
LEFT OUTER JOIN accmotive AM
	ON AM.idaccmotive = CD.idaccmotive






GO

-- VERIFICA DI wageadditionview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'wageadditionview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'adate')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'wageadditionview',denynull = 'S',format = '',col_len = '8',field = 'adate',col_precision = '' where tablename = 'wageadditionview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','wageadditionview','S','','8','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'ayear')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'wageadditionview',denynull = 'S',format = '',col_len = '4',field = 'ayear',col_precision = '' where tablename = 'wageadditionview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','wageadditionview','S','','4','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'codemotive')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'wageadditionview',denynull = 'N',format = '',col_len = '50',field = 'codemotive',col_precision = '' where tablename = 'wageadditionview' AND field = 'codemotive'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','wageadditionview','N','','50','codemotive','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'codeser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'wageadditionview',denynull = 'S',format = '',col_len = '20',field = 'codeser',col_precision = '' where tablename = 'wageadditionview' AND field = 'codeser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(20)','N','wageadditionview','S','','20','codeser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'wageadditionview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'wageadditionview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(50)','N','wageadditionview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'completed')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'char',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'char(1)',iskey = 'N',tablename = 'wageadditionview',denynull = 'N',format = '',col_len = '1',field = 'completed',col_precision = '' where tablename = 'wageadditionview' AND field = 'completed'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','char','','S','System.String','char(1)','N','wageadditionview','N','','1','completed','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'contractlength')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'wageadditionview',denynull = 'N',format = '',col_len = '150',field = 'contractlength',col_precision = '' where tablename = 'wageadditionview' AND field = 'contractlength'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','wageadditionview','N','','150','contractlength','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'ct')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'wageadditionview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'wageadditionview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','wageadditionview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'cu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'wageadditionview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'wageadditionview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','wageadditionview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'description')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'wageadditionview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'wageadditionview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(150)','N','wageadditionview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'feegross')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'wageadditionview',denynull = 'S',format = '',col_len = '9',field = 'feegross',col_precision = '19' where tablename = 'wageadditionview' AND field = 'feegross'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','2','decimal','','N','System.Decimal','decimal(19,2)','N','wageadditionview','S','','9','feegross','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'idaccmotive')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'wageadditionview',denynull = 'N',format = '',col_len = '36',field = 'idaccmotive',col_precision = '' where tablename = 'wageadditionview' AND field = 'idaccmotive'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','wageadditionview','N','','36','idaccmotive','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'idcontractlength')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(5)',iskey = 'N',tablename = 'wageadditionview',denynull = 'N',format = '',col_len = '5',field = 'idcontractlength',col_precision = '' where tablename = 'wageadditionview' AND field = 'idcontractlength'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(5)','N','wageadditionview','N','','5','idcontractlength','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'idposition')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(5)',iskey = 'N',tablename = 'wageadditionview',denynull = 'N',format = '',col_len = '5',field = 'idposition',col_precision = '' where tablename = 'wageadditionview' AND field = 'idposition'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(5)','N','wageadditionview','N','','5','idposition','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'idreg')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'wageadditionview',denynull = 'S',format = '',col_len = '4',field = 'idreg',col_precision = '' where tablename = 'wageadditionview' AND field = 'idreg'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','wageadditionview','S','','4','idreg','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'idser')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'wageadditionview',denynull = 'S',format = '',col_len = '4',field = 'idser',col_precision = '' where tablename = 'wageadditionview' AND field = 'idser'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','wageadditionview','S','','4','idser','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'idsor1')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'wageadditionview',denynull = 'N',format = '',col_len = '4',field = 'idsor1',col_precision = '' where tablename = 'wageadditionview' AND field = 'idsor1'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','wageadditionview','N','','4','idsor1','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'idsor2')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'wageadditionview',denynull = 'N',format = '',col_len = '4',field = 'idsor2',col_precision = '' where tablename = 'wageadditionview' AND field = 'idsor2'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','wageadditionview','N','','4','idsor2','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'idsor3')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'wageadditionview',denynull = 'N',format = '',col_len = '4',field = 'idsor3',col_precision = '' where tablename = 'wageadditionview' AND field = 'idsor3'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','S','System.Int32','int','N','wageadditionview','N','','4','idsor3','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'idupb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'wageadditionview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'wageadditionview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(36)','N','wageadditionview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'idworkingtime')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(5)',iskey = 'N',tablename = 'wageadditionview',denynull = 'N',format = '',col_len = '5',field = 'idworkingtime',col_precision = '' where tablename = 'wageadditionview' AND field = 'idworkingtime'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(5)','N','wageadditionview','N','','5','idworkingtime','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'lt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'wageadditionview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'wageadditionview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','wageadditionview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'lu')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'wageadditionview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'wageadditionview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(64)','N','wageadditionview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'ncon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'wageadditionview',denynull = 'S',format = '',col_len = '4',field = 'ncon',col_precision = '' where tablename = 'wageadditionview' AND field = 'ncon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','wageadditionview','S','','4','ncon','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'ndays')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'wageadditionview',denynull = 'S',format = '',col_len = '4',field = 'ndays',col_precision = '' where tablename = 'wageadditionview' AND field = 'ndays'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','wageadditionview','S','','4','ndays','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'position')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'wageadditionview',denynull = 'N',format = '',col_len = '150',field = 'position',col_precision = '' where tablename = 'wageadditionview' AND field = 'position'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','wageadditionview','N','','150','position','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'registry')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(100)',iskey = 'N',tablename = 'wageadditionview',denynull = 'S',format = '',col_len = '100',field = 'registry',col_precision = '' where tablename = 'wageadditionview' AND field = 'registry'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(100)','N','wageadditionview','S','','100','registry','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'service')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'wageadditionview',denynull = 'S',format = '',col_len = '50',field = 'service',col_precision = '' where tablename = 'wageadditionview' AND field = 'service'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','N','System.String','varchar(50)','N','wageadditionview','S','','50','service','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'start')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'wageadditionview',denynull = 'S',format = '',col_len = '8',field = 'start',col_precision = '' where tablename = 'wageadditionview' AND field = 'start'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','wageadditionview','S','','8','start','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'stop')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'wageadditionview',denynull = 'S',format = '',col_len = '8',field = 'stop',col_precision = '' where tablename = 'wageadditionview' AND field = 'stop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','datetime','','N','System.DateTime','datetime','N','wageadditionview','S','','8','stop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'txt')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'text',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'text',iskey = 'N',tablename = 'wageadditionview',denynull = 'N',format = '',col_len = '16',field = 'txt',col_precision = '' where tablename = 'wageadditionview' AND field = 'txt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','text','','S','System.String','text','N','wageadditionview','N','','16','txt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'upb')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'wageadditionview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'wageadditionview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','wageadditionview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'workingtime')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'wageadditionview',denynull = 'N',format = '',col_len = '150',field = 'workingtime',col_precision = '' where tablename = 'wageadditionview' AND field = 'workingtime'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','varchar','','S','System.String','varchar(150)','N','wageadditionview','N','','150','workingtime','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'wageadditionview' AND field = 'ycon')
UPDATE columntypes set createuser = 'PINO',lastmoduser = '''PINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'wageadditionview',denynull = 'S',format = '',col_len = '4',field = 'ycon',col_precision = '' where tablename = 'wageadditionview' AND field = 'ycon'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('PINO','''PINO''','','int','','N','System.Int32','int','N','wageadditionview','S','','4','ycon','')
GO

-- VERIFICA DI wageadditionview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'wageadditionview')
UPDATE customobject set isreal = 'N' where objectname = 'wageadditionview'
ELSE
INSERT INTO customobject (objectname, isreal) values('wageadditionview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA finunified
IF EXISTS(select * from sysobjects where id = object_id(N'[finunified]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [finunified]
GO








CREATE   VIEW [finunified]
(
	idfin,
	ayear,
	flag,
	finpart,
	codefin,
	paridfin,
	nlevel,
--	sortcode,
	idman,
	manager,
	printingorder,
	title,
	prevision,
	currentprevision,		--	+ corrente prev. princ.
	availableprevision,		--	+ disponibile prev. princ.
	previousprevision,
	secondaryprev,
	currentsecondaryprev,		--	+ corrente prev. sec.
	availablesecondaryprev,		--	+ disponibile prev. sec.
	previoussecondaryprev,
	currentarrears,
	previousarrears,
	prevision2,
	prevision3,
	prevision4,
	prevision5,
	expiration,
	cu,
	ct,
	lu,
	lt
)
AS
SELECT
fin.idfin,
fin.ayear,
fin.flag,
CASE
	WHEN ((fin.flag&1)=0) THEN 'E'
	WHEN ((fin.flag&1)=1) THEN 'S'
END,
fin.codefin,
fin.paridfin,
fin.nlevel,
--fin.sortcode,
manager.idman,
manager.title,
fin.printingorder,
fin.title,
-- Previsione Principale Esercizio Corrente
(select sum(ISNULL(currentprev,0)) from upbtotal where idfin=fin.idfin),
--	Previsione Attuale: previsione corrente - variazioni di previsione. SA 
(select isnull(sum(ISNULL(currentprev,0) + ISNULL(previsionvariation,0)),0) 
	from upbtotal where idfin=fin.idfin),
--	Disponibile: previsione corrente + var.di previsione - movimenti di spesa. SA
 	(select isnull(sum( ISNULL(currentprev,0) + ISNULL(previsionvariation,0)),0)
		from upbtotal where idfin=fin.idfin)
	-
 	CASE
	WHEN ((fin.flag&1)=1) THEN
		(				
			CASE 
			WHEN (SELECT fin_kind from config where config.ayear=fin.ayear) IN (1,3) THEN
				(select isnull(sum(ISNULL(totalcompetency,0)),0) 
				from upbexpensetotal JOIN uniconfig 
				ON upbexpensetotal.nphase = uniconfig.expensefinphase
				where idfin = fin.idfin
				)
			ELSE
				(select isnull(sum(ISNULL(totalcompetency,0)+ ISNULL(totalarrears,0)),0) 
				from upbexpensetotal JOIN uniconfig 
				ON upbexpensetotal.nphase = uniconfig.expensefinphase
				where idfin = fin.idfin
				)
			END
		)
	WHEN ((fin.flag&1)=0)THEN
		(
			CASE 
			WHEN (SELECT fin_kind from config where config.ayear=fin.ayear) IN (1,3)  THEN
				(select isnull(sum(ISNULL(totalcompetency,0)),0) 
				from upbincometotal JOIN uniconfig 
				ON upbincometotal.nphase = uniconfig.incomefinphase
				where idfin = fin.idfin
				)
			ELSE
				(select isnull(sum(ISNULL(totalcompetency,0) 
				+ ISNULL(totalarrears,0)),0)
				from upbincometotal JOIN uniconfig 
				ON upbincometotal.nphase = uniconfig.incomefinphase
				where idfin = fin.idfin
				)
			END
		) 
   	END,
-- Previsione Principale Esercizio Precedente
	(select sum(ISNULL(previousprev,0)) from upbtotal where idfin=fin.idfin),
-- Previsione Secondaria Esercizio Corrente
	(select sum(ISNULL(currentsecondaryprev,0)) from upbtotal where idfin=fin.idfin),
-- Calcolo Previsione Secondaria Attuale,	SA
	(select (sum(ISNULL(currentsecondaryprev,0) + ISNULL(secondaryvariation,0))) 
		from upbtotal where idfin=fin.idfin),
-- Calcolo Previsione Secondaria Disponibile  =  Previsione attuale - somma ( totalecompetenza+totaleresidui), SA
	(select isnull(sum(ISNULL(currentsecondaryprev,0) + ISNULL(secondaryvariation,0)),0)
		from upbtotal where idfin=fin.idfin)
   -
    CASE
	WHEN ((fin.flag&1)=1) THEN
		(select isnull(sum(ISNULL(totalcompetency,0)+ ISNULL(totalarrears,0)),0) 
			from upbexpensetotal JOIN uniconfig 
				ON upbexpensetotal.nphase = uniconfig.expensefinphase	
			where idfin = fin.idfin
			)
	WHEN ((fin.flag&1)=0) THEN
		(select isnull(sum(ISNULL(totalcompetency,0) + ISNULL(totalarrears,0)),0)
			from upbincometotal JOIN uniconfig 
				ON upbincometotal.nphase = uniconfig.incomefinphase	
			where idfin = fin.idfin
			)
   END,
-- Previsione Secondaria Esercizio Precedente
(select sum (previoussecondaryprev) from upbtotal where idfin=fin.idfin),
-- Residui Presunti (Correnti)
(select sum(currentarrears) from upbtotal where idfin=fin.idfin),
-- Residui Effettivi (Precendenti)
(select sum(previousarrears) from upbtotal where idfin=fin.idfin),
-- Previsione Anno 2
(select sum(prevision2) from finyear where idfin=fin.idfin),
-- Previsione Anno 3
(select sum(prevision3) from finyear where idfin=fin.idfin),
-- Previsione Anno 4
(select sum(prevision4) from finyear where idfin=fin.idfin),
-- Previsione Anno 5
(select sum(prevision5) from finyear where idfin=fin.idfin),
finlast.expiration,
fin.cu,
fin.ct,
fin.lu,
fin.lt
	FROM fin 
	(NOLOCK) INNER JOIN finlevel
	ON finlevel.ayear = fin.ayear
	AND finlevel.nlevel = fin.nlevel 
	LEFT OUTER JOIN finlast (NOLOCK)
	ON finlast.idfin = fin.idfin
	LEFT OUTER JOIN manager (NOLOCK)
	ON manager.idman = finlast.idman
	--LEFT OUTER JOIN manager managerfin
	--ON managerfin.idman = fin.idman
	





GO

-- VERIFICA DI finunified IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'finunified'
IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'availableprevision')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'finunified',denynull = 'N',format = '',col_len = '17',field = 'availableprevision',col_precision = '38' where tablename = 'finunified' AND field = 'availableprevision'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(38,2)','N','finunified','N','','17','availableprevision','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'availablesecondaryprev')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'finunified',denynull = 'N',format = '',col_len = '17',field = 'availablesecondaryprev',col_precision = '38' where tablename = 'finunified' AND field = 'availablesecondaryprev'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(38,2)','N','finunified','N','','17','availablesecondaryprev','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'ayear')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'finunified',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'finunified' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','smallint','','N','System.Int16','smallint','N','finunified','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'codefin')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'finunified',denynull = 'S',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'finunified' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(50)','N','finunified','S','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'ct')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'finunified',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'finunified' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','datetime','','N','System.DateTime','datetime','N','finunified','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'cu')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'finunified',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'finunified' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(64)','N','finunified','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'currentarrears')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'finunified',denynull = 'N',format = '',col_len = '17',field = 'currentarrears',col_precision = '38' where tablename = 'finunified' AND field = 'currentarrears'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(38,2)','N','finunified','N','','17','currentarrears','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'currentprevision')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'finunified',denynull = 'N',format = '',col_len = '17',field = 'currentprevision',col_precision = '38' where tablename = 'finunified' AND field = 'currentprevision'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(38,2)','N','finunified','N','','17','currentprevision','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'currentsecondaryprev')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'finunified',denynull = 'N',format = '',col_len = '17',field = 'currentsecondaryprev',col_precision = '38' where tablename = 'finunified' AND field = 'currentsecondaryprev'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(38,2)','N','finunified','N','','17','currentsecondaryprev','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'expiration')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'finunified',denynull = 'N',format = '',col_len = '8',field = 'expiration',col_precision = '' where tablename = 'finunified' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','datetime','','S','System.DateTime','datetime','N','finunified','N','','8','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'finpart')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'finunified',denynull = 'N',format = '',col_len = '1',field = 'finpart',col_precision = '' where tablename = 'finunified' AND field = 'finpart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(1)','N','finunified','N','','1','finpart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'flag')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'finunified',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'finunified' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','tinyint','','N','System.Byte','tinyint','N','finunified','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'idfin')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'finunified',denynull = 'S',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'finunified' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','N','System.Int32','int','N','finunified','S','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'idman')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'finunified',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'finunified' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','finunified','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'lt')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'finunified',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'finunified' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','datetime','','N','System.DateTime','datetime','N','finunified','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'lu')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'finunified',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'finunified' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(64)','N','finunified','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'manager')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'finunified',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'finunified' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(150)','N','finunified','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'nlevel')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'finunified',denynull = 'S',format = '',col_len = '1',field = 'nlevel',col_precision = '' where tablename = 'finunified' AND field = 'nlevel'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','tinyint','','N','System.Byte','tinyint','N','finunified','S','','1','nlevel','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'paridfin')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'finunified',denynull = 'N',format = '',col_len = '4',field = 'paridfin',col_precision = '' where tablename = 'finunified' AND field = 'paridfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','finunified','N','','4','paridfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'previousarrears')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'finunified',denynull = 'N',format = '',col_len = '17',field = 'previousarrears',col_precision = '38' where tablename = 'finunified' AND field = 'previousarrears'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(38,2)','N','finunified','N','','17','previousarrears','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'previousprevision')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'finunified',denynull = 'N',format = '',col_len = '17',field = 'previousprevision',col_precision = '38' where tablename = 'finunified' AND field = 'previousprevision'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(38,2)','N','finunified','N','','17','previousprevision','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'previoussecondaryprev')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'finunified',denynull = 'N',format = '',col_len = '17',field = 'previoussecondaryprev',col_precision = '38' where tablename = 'finunified' AND field = 'previoussecondaryprev'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(38,2)','N','finunified','N','','17','previoussecondaryprev','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'prevision')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'finunified',denynull = 'N',format = '',col_len = '17',field = 'prevision',col_precision = '38' where tablename = 'finunified' AND field = 'prevision'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(38,2)','N','finunified','N','','17','prevision','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'prevision2')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'finunified',denynull = 'N',format = '',col_len = '17',field = 'prevision2',col_precision = '38' where tablename = 'finunified' AND field = 'prevision2'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(38,2)','N','finunified','N','','17','prevision2','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'prevision3')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'finunified',denynull = 'N',format = '',col_len = '17',field = 'prevision3',col_precision = '38' where tablename = 'finunified' AND field = 'prevision3'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(38,2)','N','finunified','N','','17','prevision3','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'prevision4')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'finunified',denynull = 'N',format = '',col_len = '17',field = 'prevision4',col_precision = '38' where tablename = 'finunified' AND field = 'prevision4'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(38,2)','N','finunified','N','','17','prevision4','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'prevision5')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'finunified',denynull = 'N',format = '',col_len = '17',field = 'prevision5',col_precision = '38' where tablename = 'finunified' AND field = 'prevision5'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(38,2)','N','finunified','N','','17','prevision5','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'printingorder')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'finunified',denynull = 'S',format = '',col_len = '50',field = 'printingorder',col_precision = '' where tablename = 'finunified' AND field = 'printingorder'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(50)','N','finunified','S','','50','printingorder','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'secondaryprev')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,2)',iskey = 'N',tablename = 'finunified',denynull = 'N',format = '',col_len = '17',field = 'secondaryprev',col_precision = '38' where tablename = 'finunified' AND field = 'secondaryprev'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(38,2)','N','finunified','N','','17','secondaryprev','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finunified' AND field = 'title')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'finunified',denynull = 'S',format = '',col_len = '150',field = 'title',col_precision = '' where tablename = 'finunified' AND field = 'title'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(150)','N','finunified','S','','150','title','')
GO

-- VERIFICA DI finunified IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'finunified')
UPDATE customobject set isreal = 'N' where objectname = 'finunified'
ELSE
INSERT INTO customobject (objectname, isreal) values('finunified', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA finview
IF EXISTS(select * from sysobjects where id = object_id(N'[finview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [finview]
GO




CREATE  VIEW [finview]
(
	idfin,
	ayear,
	finpart,
	codefin,
	nlevel,
	leveldescr,
	paridfin,
	idman,
	manager,
	printingorder,
	title,
	prevision,
	currentprevision,
	availableprevision,
	previousprevision,
	secondaryprev,
	currentsecondaryprev,
	availablesecondaryprev,
	previoussecondaryprev,
	currentarrears,
	previousarrears,
	prevision2,
	prevision3,
	prevision4,
	prevision5,
	expiration,
	flag,
	flagusable,
	idupb,
	codeupb,
	upb,
	cu, 
	ct, 
	lu, 
	lt
)
AS 
SELECT fin.idfin, fin.ayear, 
   	CASE
		when (( fin.flag & 1)=0) then 'E'
		when (( fin.flag & 1)=1) then 'S'
	End,
	fin.codefin, 
    	fin.nlevel, finlevel.description, 
    	fin.paridfin,
    ISNULL(upb.idman,finlast.idman),
    ISNULL(manager.title,managerfin.title),
    fin.printingorder,
    fin.title,
-- Calcolo Previsione Esercizio Corrente = SOMMA delle prevesercizio corr sottostanti, sul primo livello operativo di bilancio
	ISNULL(upbtotal.currentprev,0),
-- Calcolo Previsione Attuale = SOMMA delle prevesercizio corr sottostanti, sul primo livello operativo di bilancio +  la SOMMA di totbilancio.totvarprevisione 
	ISNULL(upbtotal.currentprev,0) + ISNULL(upbtotal.previsionvariation,0),
-- Calcolo Previsione Disponibile = Previsione attuale - somma totbilanciospesa.totalecompetenza (se bil.competenza) o  Previsione attuale - somma totalecompetenza-totaleresidui (se bil. Cassa)
	ISNULL(upbtotal.currentprev,0) + ISNULL(upbtotal.previsionvariation,0) -
    CASE
	WHEN ((fin.flag&1)=1)  THEN --Spesa
		(				
			CASE 
			WHEN (SELECT fin_kind from config where config.ayear=fin.ayear)IN (1,3) THEN
				ISNULL(upbexpensetotal.totalcompetency,0)
			ELSE
				ISNULL(upbexpensetotal.totalcompetency,0) + ISNULL(upbexpensetotal.totalarrears,0)
			END
		)
	WHEN  ((fin.flag&1)=0) THEN --Entrata
		(
			CASE 
			WHEN (SELECT fin_kind from config where config.ayear=fin.ayear) IN (1,3) THEN
				ISNULL(upbincometotal.totalcompetency,0)
			ELSE
				ISNULL(upbincometotal.totalcompetency,0) + ISNULL(upbincometotal.totalarrears,0)
			END
		)
   	END,
	-- Calcolo Previsione Esercizio Precedente = somma prevesercizioprec su livelli operativi sottostanti
	upbtotal.previousprev,
	-- Calcolo Previsione Secondaria Esercizio Corrente = somma prevseceserciziocorr su livelli operativi sottostanti
	upbtotal.currentsecondaryprev,
	-- Calcolo Previsione Secondaria Attuale
	ISNULL(upbtotal.currentsecondaryprev,0) + ISNULL(upbtotal.secondaryvariation,0),
	-- Calcolo Previsione Secondaria Disponibile  =  Previsione attuale - somma ( totalecompetenza+totaleresidui)
	ISNULL(upbtotal.currentsecondaryprev,0) + ISNULL(upbtotal.secondaryvariation,0) -
    	CASE
	WHEN ((fin.flag&1) = 1) THEN --Spesa
		ISNULL(upbexpensetotal.totalcompetency,0) + ISNULL(upbexpensetotal.totalarrears,0)
	WHEN ((fin.flag&1) = 0) THEN --Entrata
		ISNULL(upbincometotal.totalcompetency,0) + ISNULL(upbincometotal.totalarrears,0)
  	END,
	-- Calcolo Previsione Secondaria Esercizio Precedente
	upbtotal.previoussecondaryprev,
	-- Calcolo Ripartizione
	upbtotal.currentarrears,
	-- Calcolo Ripartizione Precedente
	upbtotal.previousarrears,
	finyear.prevision2,
	finyear.prevision3,
	finyear.prevision4,
	finyear.prevision5,
	finlast.expiration, 
	fin.flag,
   	CASE
		when (( finlevel.flag & 2)<>0) then 'S'
		else 'N'
	End,
	upb.idupb,
	upb.codeupb,
	upb.title,
	fin.cu, 
	fin.ct, fin.lu, 
	fin.lt
	FROM fin 
	CROSS JOIN upb
	CROSS JOIN uniconfig
	(NOLOCK) INNER JOIN finlevel
		ON finlevel.ayear = fin.ayear	
		AND finlevel.nlevel = fin.nlevel 
	LEFT OUTER JOIN upbtotal (NOLOCK)
		ON fin.idfin = upbtotal.idfin 
		AND upb.idupb = upbtotal.idupb
	LEFT OUTER JOIN upbincometotal
		(NOLOCK) ON fin.idfin = upbincometotal.idfin
		AND upb.idupb = upbincometotal.idupb
		AND upbincometotal.nphase = uniconfig.incomefinphase
	LEFT OUTER JOIN	upbexpensetotal (NOLOCK)
		ON fin.idfin = upbexpensetotal.idfin
		AND upb.idupb = upbexpensetotal.idupb
		AND upbexpensetotal.nphase = uniconfig.expensefinphase
	LEFT OUTER JOIN finlast (NOLOCK)
		ON fin.idfin = finlast.idfin
	LEFT OUTER JOIN manager (NOLOCK)
		ON manager.idman = upb.idman
	LEFT OUTER JOIN manager managerfin
		ON managerfin.idman = finlast.idman
	LEFT OUTER JOIN finyear
		ON fin.idfin = finyear.idfin
		AND upb.idupb = finyear.idupb







GO

-- VERIFICA DI finview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'finview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'availableprevision')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(21,2)',iskey = 'N',tablename = 'finview',denynull = 'N',format = '',col_len = '13',field = 'availableprevision',col_precision = '21' where tablename = 'finview' AND field = 'availableprevision'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(21,2)','N','finview','N','','13','availableprevision','21')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'availablesecondaryprev')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(21,2)',iskey = 'N',tablename = 'finview',denynull = 'N',format = '',col_len = '13',field = 'availablesecondaryprev',col_precision = '21' where tablename = 'finview' AND field = 'availablesecondaryprev'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(21,2)','N','finview','N','','13','availablesecondaryprev','21')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'ayear')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'finview',denynull = 'S',format = '',col_len = '2',field = 'ayear',col_precision = '' where tablename = 'finview' AND field = 'ayear'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','smallint','','N','System.Int16','smallint','N','finview','S','','2','ayear','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'codefin')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'finview',denynull = 'S',format = '',col_len = '50',field = 'codefin',col_precision = '' where tablename = 'finview' AND field = 'codefin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(50)','N','finview','S','','50','codefin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'finview',denynull = 'S',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'finview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(50)','N','finview','S','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'ct')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'finview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'finview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','datetime','','N','System.DateTime','datetime','N','finview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'cu')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'finview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'finview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(64)','N','finview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'currentarrears')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'finview',denynull = 'N',format = '',col_len = '9',field = 'currentarrears',col_precision = '19' where tablename = 'finview' AND field = 'currentarrears'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(19,2)','N','finview','N','','9','currentarrears','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'currentprevision')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(20,2)',iskey = 'N',tablename = 'finview',denynull = 'N',format = '',col_len = '13',field = 'currentprevision',col_precision = '20' where tablename = 'finview' AND field = 'currentprevision'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(20,2)','N','finview','N','','13','currentprevision','20')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'currentsecondaryprev')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(20,2)',iskey = 'N',tablename = 'finview',denynull = 'N',format = '',col_len = '13',field = 'currentsecondaryprev',col_precision = '20' where tablename = 'finview' AND field = 'currentsecondaryprev'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(20,2)','N','finview','N','','13','currentsecondaryprev','20')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'expiration')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'finview',denynull = 'N',format = '',col_len = '8',field = 'expiration',col_precision = '' where tablename = 'finview' AND field = 'expiration'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','datetime','','S','System.DateTime','datetime','N','finview','N','','8','expiration','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'finpart')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'finview',denynull = 'N',format = '',col_len = '1',field = 'finpart',col_precision = '' where tablename = 'finview' AND field = 'finpart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(1)','N','finview','N','','1','finpart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'flag')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'finview',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'finview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','tinyint','','N','System.Byte','tinyint','N','finview','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'flagusable')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'finview',denynull = 'S',format = '',col_len = '1',field = 'flagusable',col_precision = '' where tablename = 'finview' AND field = 'flagusable'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(1)','N','finview','S','','1','flagusable','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'idfin')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'finview',denynull = 'S',format = '',col_len = '4',field = 'idfin',col_precision = '' where tablename = 'finview' AND field = 'idfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','N','System.Int32','int','N','finview','S','','4','idfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'idman')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'finview',denynull = 'N',format = '',col_len = '4',field = 'idman',col_precision = '' where tablename = 'finview' AND field = 'idman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','finview','N','','4','idman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'idupb')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'finview',denynull = 'S',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'finview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(36)','N','finview','S','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'leveldescr')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'finview',denynull = 'S',format = '',col_len = '50',field = 'leveldescr',col_precision = '' where tablename = 'finview' AND field = 'leveldescr'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(50)','N','finview','S','','50','leveldescr','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'lt')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'finview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'finview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','datetime','','N','System.DateTime','datetime','N','finview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'lu')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'finview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'finview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(64)','N','finview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'manager')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'finview',denynull = 'N',format = '',col_len = '150',field = 'manager',col_precision = '' where tablename = 'finview' AND field = 'manager'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','S','System.String','varchar(150)','N','finview','N','','150','manager','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'nlevel')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'finview',denynull = 'S',format = '',col_len = '1',field = 'nlevel',col_precision = '' where tablename = 'finview' AND field = 'nlevel'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','tinyint','','N','System.Byte','tinyint','N','finview','S','','1','nlevel','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'paridfin')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'finview',denynull = 'N',format = '',col_len = '4',field = 'paridfin',col_precision = '' where tablename = 'finview' AND field = 'paridfin'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','int','','S','System.Int32','int','N','finview','N','','4','paridfin','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'previousarrears')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'finview',denynull = 'N',format = '',col_len = '9',field = 'previousarrears',col_precision = '19' where tablename = 'finview' AND field = 'previousarrears'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(19,2)','N','finview','N','','9','previousarrears','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'previousprevision')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'finview',denynull = 'N',format = '',col_len = '9',field = 'previousprevision',col_precision = '19' where tablename = 'finview' AND field = 'previousprevision'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(19,2)','N','finview','N','','9','previousprevision','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'previoussecondaryprev')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'finview',denynull = 'N',format = '',col_len = '9',field = 'previoussecondaryprev',col_precision = '19' where tablename = 'finview' AND field = 'previoussecondaryprev'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(19,2)','N','finview','N','','9','previoussecondaryprev','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'prevision')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'finview',denynull = 'S',format = '',col_len = '9',field = 'prevision',col_precision = '19' where tablename = 'finview' AND field = 'prevision'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','N','System.Decimal','decimal(19,2)','N','finview','S','','9','prevision','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'prevision2')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'finview',denynull = 'N',format = '',col_len = '9',field = 'prevision2',col_precision = '19' where tablename = 'finview' AND field = 'prevision2'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(19,2)','N','finview','N','','9','prevision2','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'prevision3')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'finview',denynull = 'N',format = '',col_len = '9',field = 'prevision3',col_precision = '19' where tablename = 'finview' AND field = 'prevision3'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(19,2)','N','finview','N','','9','prevision3','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'prevision4')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'finview',denynull = 'N',format = '',col_len = '9',field = 'prevision4',col_precision = '19' where tablename = 'finview' AND field = 'prevision4'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(19,2)','N','finview','N','','9','prevision4','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'prevision5')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'finview',denynull = 'N',format = '',col_len = '9',field = 'prevision5',col_precision = '19' where tablename = 'finview' AND field = 'prevision5'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(19,2)','N','finview','N','','9','prevision5','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'printingorder')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'finview',denynull = 'S',format = '',col_len = '50',field = 'printingorder',col_precision = '' where tablename = 'finview' AND field = 'printingorder'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(50)','N','finview','S','','50','printingorder','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'secondaryprev')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'finview',denynull = 'N',format = '',col_len = '9',field = 'secondaryprev',col_precision = '19' where tablename = 'finview' AND field = 'secondaryprev'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','2','decimal','','S','System.Decimal','decimal(19,2)','N','finview','N','','9','secondaryprev','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'title')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'finview',denynull = 'S',format = '',col_len = '150',field = 'title',col_precision = '' where tablename = 'finview' AND field = 'title'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(150)','N','finview','S','','150','title','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'finview' AND field = 'upb')
UPDATE columntypes set createuser = 'SARA',lastmoduser = '''SARA''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'finview',denynull = 'S',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'finview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('SARA','''SARA''','','varchar','','N','System.String','varchar(150)','N','finview','S','','150','upb','')
GO

-- VERIFICA DI finview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'finview')
UPDATE customobject set isreal = 'N' where objectname = 'finview'
ELSE
INSERT INTO customobject (objectname, isreal) values('finview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

-- CREAZIONE VISTA invoicedetailview
IF EXISTS(select * from sysobjects where id = object_id(N'[invoicedetailview]') and OBJECTPROPERTY(id, N'IsView') = 1)
DROP VIEW [invoicedetailview]
GO






CREATE VIEW invoicedetailview
(
	idinvkind,
	codeinvkind,
	invoicekind,
	yinv,
	ninv,
	flag,
	flagbuysell,
	flagvariation,
	rownum,
	detaildescription,
	idivakind,
	ivakind,
	rate,
	unabatabilitypercentage,
	number,
	taxable,
	discount,
	tax,
	unabatable,
	exchangerate,
	annotations,
	idmankind,
	mankind,
	yman,
	nman,
	manrownum,
	mandetaildescription,
	idupb, 
	codeupb,	
	upb, 
	adate,
	idexp_iva,
	idexp_taxable,
	idexp_ivamand,
	idexp_taxablemand,
	idinc_iva,
	idinc_taxable,
	idinc_ivaestim,
	idinc_taxableestim,
	taxable_euro,
	iva_euro,
	unabatable_euro,
	rowtotal,
	competencystart,
	competencystop,
	yinv_main,
	ninv_main,
	description,
	idaccmotive,
	codemotive,
	idsor1,
	idsor2,
	idsor3,
	sortcode1,
	sortcode2,
	sortcode3,
	cu, 
	ct, 
	lu, 
	lt
)
	AS SELECT
	invoicedetail.idinvkind,
	invoicekind.codeinvkind,
	invoicekind.description,
	invoicedetail.yinv,
	invoicedetail.ninv,
	invoicekind.flag,
	CASE
		WHEN ((invoicekind.flag&1)=0) THEN 'A'--flagbuysell
		WHEN ((invoicekind.flag&1)<>0) THEN 'V'
	END, 
	CASE
		WHEN ((invoicekind.flag&4)=0) THEN 'N'--flagvariation
		WHEN ((invoicekind.flag&4)<>0) THEN 'S'
	END, 
	invoicedetail.rownum,
	invoicedetail.detaildescription,
	invoicedetail.idivakind,
	ivakind.description,
	ivakind.rate,
	ivakind.unabatabilitypercentage,
	invoicedetail.number,
	invoicedetail.taxable,
	invoicedetail.discount,
	invoicedetail.tax,
	invoicedetail.unabatable,
	invoice.exchangerate,
	invoicedetail.annotations,
	invoicedetail.idmankind,
	mandatekind.description,
	invoicedetail.yman,
	invoicedetail.nman,
	invoicedetail.manrownum,
	mandatedetail.detaildescription,
	invoicedetail.idupb, 
	upb.codeupb,	
	upb.title, 
	invoice.adate,
	invoicedetail.idexp_iva,
	invoicedetail.idexp_taxable,
	mandatedetail.idexp_iva,
	mandatedetail.idexp_taxable,
	invoicedetail.idinc_iva,
	invoicedetail.idinc_taxable,
	estimatedetail.idinc_iva,
	estimatedetail.idinc_taxable,
 	    ROUND(invoicedetail.taxable * invoicedetail.number * 
		  CONVERT(DECIMAL(19,6),invoice.exchangerate) *
		  (1 - CONVERT(DECIMAL(19,6),ISNULL(invoicedetail.discount, 0.0))),2
		),
	ROUND(invoicedetail.tax * CONVERT(decimal(19,6), ISNULL(invoice.exchangerate,1)),2),
	ROUND(invoicedetail.unabatable * CONVERT(decimal(19,6), ISNULL(invoice.exchangerate,1)),2),
	ROUND(invoicedetail.taxable * invoicedetail.number * 
		  CONVERT(DECIMAL(19,6),ISNULL(invoice.exchangerate,1)) *
		  (1 - CONVERT(DECIMAL(19,6),ISNULL(invoicedetail.discount, 0.0))),2
		)+
	ROUND(ISNULL(invoicedetail.tax,0) * CONVERT(decimal(19,6), ISNULL(invoice.exchangerate,1)),2),
	invoicedetail.competencystart,
	invoicedetail.competencystop,
	invoicedetail.yinv_main,
	invoicedetail.ninv_main,
	invoice.description,
	invoicedetail.idaccmotive,
	accmotive.codemotive,
	invoicedetail.idsor1,
	invoicedetail.idsor2,
	invoicedetail.idsor3,
	sorting1.sortcode,
	sorting2.sortcode,
	sorting3.sortcode,
	invoicedetail.cu, 
	invoicedetail.ct, 
	invoicedetail.lu,
	invoicedetail.lt 
FROM invoicedetail
JOIN ivakind
	ON ivakind.idivakind = invoicedetail.idivakind
JOIN invoice
	ON invoice.ninv = invoicedetail.ninv
	AND invoice.yinv = invoicedetail.yinv
	AND invoice.idinvkind = invoicedetail.idinvkind
JOIN invoicekind
	ON invoicekind.idinvkind = invoicedetail.idinvkind
JOIN registry
	ON registry.idreg = invoice.idreg
LEFT OUTER JOIN mandatedetail
	ON invoicedetail.idmankind = mandatedetail.idmankind
	AND invoicedetail.yman = mandatedetail.yman
	AND invoicedetail.nman = mandatedetail.nman
	AND invoicedetail.manrownum = mandatedetail.rownum
LEFT OUTER JOIN mandatekind 
	ON mandatekind.idmankind = mandatedetail.idmankind
LEFT OUTER JOIN estimatedetail
	ON invoicedetail.idestimkind = estimatedetail.idestimkind
	AND invoicedetail.yestim = estimatedetail.yestim
	AND invoicedetail.nestim = estimatedetail.nestim
	AND invoicedetail.estimrownum = estimatedetail.rownum
LEFT OUTER JOIN upb
	ON upb.idupb = invoicedetail.idupb
LEFT OUTER JOIN accmotive
	ON accmotive.idaccmotive = invoicedetail.idaccmotive
LEFT OUTER JOIN sorting sorting1
	ON sorting1.idsor = invoicedetail.idsor1
LEFT OUTER JOIN sorting sorting2
	ON sorting2.idsor = invoicedetail.idsor2
LEFT OUTER JOIN sorting sorting3
	ON sorting3.idsor = invoicedetail.idsor3


GO

-- VERIFICA DI invoicedetailview IN COLUMNTYPES --
DELETE FROM columntypes WHERE tablename = 'invoicedetailview'
IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'adate')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'smalldatetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'smalldatetime',iskey = 'N',tablename = 'invoicedetailview',denynull = 'S',format = '',col_len = '4',field = 'adate',col_precision = '' where tablename = 'invoicedetailview' AND field = 'adate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','smalldatetime','','N','System.DateTime','smalldatetime','N','invoicedetailview','S','','4','adate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'annotations')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(400)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '400',field = 'annotations',col_precision = '' where tablename = 'invoicedetailview' AND field = 'annotations'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','S','System.String','varchar(400)','N','invoicedetailview','N','','400','annotations','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'codeinvkind')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'S',format = '',col_len = '20',field = 'codeinvkind',col_precision = '' where tablename = 'invoicedetailview' AND field = 'codeinvkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','N','System.String','varchar(20)','N','invoicedetailview','S','','20','codeinvkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'codemotive')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '50',field = 'codemotive',col_precision = '' where tablename = 'invoicedetailview' AND field = 'codemotive'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','S','System.String','varchar(50)','N','invoicedetailview','N','','50','codemotive','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'codeupb')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '50',field = 'codeupb',col_precision = '' where tablename = 'invoicedetailview' AND field = 'codeupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','S','System.String','varchar(50)','N','invoicedetailview','N','','50','codeupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'competencystart')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '8',field = 'competencystart',col_precision = '' where tablename = 'invoicedetailview' AND field = 'competencystart'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','datetime','','S','System.DateTime','datetime','N','invoicedetailview','N','','8','competencystart','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'competencystop')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'S',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '8',field = 'competencystop',col_precision = '' where tablename = 'invoicedetailview' AND field = 'competencystop'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','datetime','','S','System.DateTime','datetime','N','invoicedetailview','N','','8','competencystop','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'ct')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'invoicedetailview',denynull = 'S',format = '',col_len = '8',field = 'ct',col_precision = '' where tablename = 'invoicedetailview' AND field = 'ct'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','datetime','','N','System.DateTime','datetime','N','invoicedetailview','S','','8','ct','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'cu')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'S',format = '',col_len = '64',field = 'cu',col_precision = '' where tablename = 'invoicedetailview' AND field = 'cu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','N','System.String','varchar(64)','N','invoicedetailview','S','','64','cu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'description')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'S',format = '',col_len = '150',field = 'description',col_precision = '' where tablename = 'invoicedetailview' AND field = 'description'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','N','System.String','varchar(150)','N','invoicedetailview','S','','150','description','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'detaildescription')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '150',field = 'detaildescription',col_precision = '' where tablename = 'invoicedetailview' AND field = 'detaildescription'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','S','System.String','varchar(150)','N','invoicedetailview','N','','150','detaildescription','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'discount')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'float',defaultvalue = '',allownull = 'S',systemtype = 'System.Double',sqldeclaration = 'float',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '8',field = 'discount',col_precision = '' where tablename = 'invoicedetailview' AND field = 'discount'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','float','','S','System.Double','float','N','invoicedetailview','N','','8','discount','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'exchangerate')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'float',defaultvalue = '',allownull = 'S',systemtype = 'System.Double',sqldeclaration = 'float',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '8',field = 'exchangerate',col_precision = '' where tablename = 'invoicedetailview' AND field = 'exchangerate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','float','','S','System.Double','float','N','invoicedetailview','N','','8','exchangerate','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'flag')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'tinyint',defaultvalue = '',allownull = 'N',systemtype = 'System.Byte',sqldeclaration = 'tinyint',iskey = 'N',tablename = 'invoicedetailview',denynull = 'S',format = '',col_len = '1',field = 'flag',col_precision = '' where tablename = 'invoicedetailview' AND field = 'flag'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','tinyint','','N','System.Byte','tinyint','N','invoicedetailview','S','','1','flag','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'flagbuysell')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '1',field = 'flagbuysell',col_precision = '' where tablename = 'invoicedetailview' AND field = 'flagbuysell'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','S','System.String','varchar(1)','N','invoicedetailview','N','','1','flagbuysell','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'flagvariation')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(1)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '1',field = 'flagvariation',col_precision = '' where tablename = 'invoicedetailview' AND field = 'flagvariation'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','S','System.String','varchar(1)','N','invoicedetailview','N','','1','flagvariation','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'idaccmotive')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '36',field = 'idaccmotive',col_precision = '' where tablename = 'invoicedetailview' AND field = 'idaccmotive'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','S','System.String','varchar(36)','N','invoicedetailview','N','','36','idaccmotive','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'idexp_iva')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '4',field = 'idexp_iva',col_precision = '' where tablename = 'invoicedetailview' AND field = 'idexp_iva'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','int','','S','System.Int32','int','N','invoicedetailview','N','','4','idexp_iva','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'idexp_ivamand')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '4',field = 'idexp_ivamand',col_precision = '' where tablename = 'invoicedetailview' AND field = 'idexp_ivamand'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','int','','S','System.Int32','int','N','invoicedetailview','N','','4','idexp_ivamand','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'idexp_taxable')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '4',field = 'idexp_taxable',col_precision = '' where tablename = 'invoicedetailview' AND field = 'idexp_taxable'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','int','','S','System.Int32','int','N','invoicedetailview','N','','4','idexp_taxable','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'idexp_taxablemand')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '4',field = 'idexp_taxablemand',col_precision = '' where tablename = 'invoicedetailview' AND field = 'idexp_taxablemand'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','int','','S','System.Int32','int','N','invoicedetailview','N','','4','idexp_taxablemand','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'idinc_iva')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '4',field = 'idinc_iva',col_precision = '' where tablename = 'invoicedetailview' AND field = 'idinc_iva'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','int','','S','System.Int32','int','N','invoicedetailview','N','','4','idinc_iva','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'idinc_ivaestim')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '4',field = 'idinc_ivaestim',col_precision = '' where tablename = 'invoicedetailview' AND field = 'idinc_ivaestim'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','int','','S','System.Int32','int','N','invoicedetailview','N','','4','idinc_ivaestim','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'idinc_taxable')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '4',field = 'idinc_taxable',col_precision = '' where tablename = 'invoicedetailview' AND field = 'idinc_taxable'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','int','','S','System.Int32','int','N','invoicedetailview','N','','4','idinc_taxable','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'idinc_taxableestim')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '4',field = 'idinc_taxableestim',col_precision = '' where tablename = 'invoicedetailview' AND field = 'idinc_taxableestim'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','int','','S','System.Int32','int','N','invoicedetailview','N','','4','idinc_taxableestim','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'idinvkind')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicedetailview',denynull = 'S',format = '',col_len = '4',field = 'idinvkind',col_precision = '' where tablename = 'invoicedetailview' AND field = 'idinvkind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','int','','N','System.Int32','int','N','invoicedetailview','S','','4','idinvkind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'idivakind')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicedetailview',denynull = 'S',format = '',col_len = '4',field = 'idivakind',col_precision = '' where tablename = 'invoicedetailview' AND field = 'idivakind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','int','','N','System.Int32','int','N','invoicedetailview','S','','4','idivakind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'idmankind')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(20)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '20',field = 'idmankind',col_precision = '' where tablename = 'invoicedetailview' AND field = 'idmankind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','S','System.String','varchar(20)','N','invoicedetailview','N','','20','idmankind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'idsor1')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '4',field = 'idsor1',col_precision = '' where tablename = 'invoicedetailview' AND field = 'idsor1'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','int','','S','System.Int32','int','N','invoicedetailview','N','','4','idsor1','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'idsor2')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '4',field = 'idsor2',col_precision = '' where tablename = 'invoicedetailview' AND field = 'idsor2'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','int','','S','System.Int32','int','N','invoicedetailview','N','','4','idsor2','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'idsor3')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '4',field = 'idsor3',col_precision = '' where tablename = 'invoicedetailview' AND field = 'idsor3'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','int','','S','System.Int32','int','N','invoicedetailview','N','','4','idsor3','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'idupb')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(36)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '36',field = 'idupb',col_precision = '' where tablename = 'invoicedetailview' AND field = 'idupb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','S','System.String','varchar(36)','N','invoicedetailview','N','','36','idupb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'invoicekind')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'S',format = '',col_len = '50',field = 'invoicekind',col_precision = '' where tablename = 'invoicedetailview' AND field = 'invoicekind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','N','System.String','varchar(50)','N','invoicedetailview','S','','50','invoicekind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'iva_euro')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '7',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,7)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '17',field = 'iva_euro',col_precision = '38' where tablename = 'invoicedetailview' AND field = 'iva_euro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','7','decimal','','S','System.Decimal','decimal(38,7)','N','invoicedetailview','N','','17','iva_euro','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'ivakind')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'S',format = '',col_len = '50',field = 'ivakind',col_precision = '' where tablename = 'invoicedetailview' AND field = 'ivakind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','N','System.String','varchar(50)','N','invoicedetailview','S','','50','ivakind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'lt')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'datetime',defaultvalue = '',allownull = 'N',systemtype = 'System.DateTime',sqldeclaration = 'datetime',iskey = 'N',tablename = 'invoicedetailview',denynull = 'S',format = '',col_len = '8',field = 'lt',col_precision = '' where tablename = 'invoicedetailview' AND field = 'lt'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','datetime','','N','System.DateTime','datetime','N','invoicedetailview','S','','8','lt','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'lu')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'N',systemtype = 'System.String',sqldeclaration = 'varchar(64)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'S',format = '',col_len = '64',field = 'lu',col_precision = '' where tablename = 'invoicedetailview' AND field = 'lu'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','N','System.String','varchar(64)','N','invoicedetailview','S','','64','lu','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'mandetaildescription')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '150',field = 'mandetaildescription',col_precision = '' where tablename = 'invoicedetailview' AND field = 'mandetaildescription'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','S','System.String','varchar(150)','N','invoicedetailview','N','','150','mandetaildescription','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'mankind')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '150',field = 'mankind',col_precision = '' where tablename = 'invoicedetailview' AND field = 'mankind'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','S','System.String','varchar(150)','N','invoicedetailview','N','','150','mankind','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'manrownum')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '4',field = 'manrownum',col_precision = '' where tablename = 'invoicedetailview' AND field = 'manrownum'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','int','','S','System.Int32','int','N','invoicedetailview','N','','4','manrownum','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'ninv')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicedetailview',denynull = 'S',format = '',col_len = '4',field = 'ninv',col_precision = '' where tablename = 'invoicedetailview' AND field = 'ninv'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','int','','N','System.Int32','int','N','invoicedetailview','S','','4','ninv','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'ninv_main')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '4',field = 'ninv_main',col_precision = '' where tablename = 'invoicedetailview' AND field = 'ninv_main'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','int','','S','System.Int32','int','N','invoicedetailview','N','','4','ninv_main','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'nman')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'S',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '4',field = 'nman',col_precision = '' where tablename = 'invoicedetailview' AND field = 'nman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','int','','S','System.Int32','int','N','invoicedetailview','N','','4','nman','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'number')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '9',field = 'number',col_precision = '19' where tablename = 'invoicedetailview' AND field = 'number'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','invoicedetailview','N','','9','number','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'rate')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'S',format = '',col_len = '9',field = 'rate',col_precision = '19' where tablename = 'invoicedetailview' AND field = 'rate'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','6','decimal','','N','System.Decimal','decimal(19,6)','N','invoicedetailview','S','','9','rate','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'rownum')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'int',defaultvalue = '',allownull = 'N',systemtype = 'System.Int32',sqldeclaration = 'int',iskey = 'N',tablename = 'invoicedetailview',denynull = 'S',format = '',col_len = '4',field = 'rownum',col_precision = '' where tablename = 'invoicedetailview' AND field = 'rownum'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','int','','N','System.Int32','int','N','invoicedetailview','S','','4','rownum','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'rowtotal')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,6)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '17',field = 'rowtotal',col_precision = '38' where tablename = 'invoicedetailview' AND field = 'rowtotal'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','6','decimal','','S','System.Decimal','decimal(38,6)','N','invoicedetailview','N','','17','rowtotal','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'sortcode1')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '50',field = 'sortcode1',col_precision = '' where tablename = 'invoicedetailview' AND field = 'sortcode1'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','S','System.String','varchar(50)','N','invoicedetailview','N','','50','sortcode1','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'sortcode2')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '50',field = 'sortcode2',col_precision = '' where tablename = 'invoicedetailview' AND field = 'sortcode2'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','S','System.String','varchar(50)','N','invoicedetailview','N','','50','sortcode2','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'sortcode3')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(50)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '50',field = 'sortcode3',col_precision = '' where tablename = 'invoicedetailview' AND field = 'sortcode3'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','S','System.String','varchar(50)','N','invoicedetailview','N','','50','sortcode3','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'tax')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '9',field = 'tax',col_precision = '19' where tablename = 'invoicedetailview' AND field = 'tax'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','invoicedetailview','N','','9','tax','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'taxable')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '5',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,5)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '9',field = 'taxable',col_precision = '19' where tablename = 'invoicedetailview' AND field = 'taxable'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','5','decimal','','S','System.Decimal','decimal(19,5)','N','invoicedetailview','N','','9','taxable','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'taxable_euro')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,6)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '17',field = 'taxable_euro',col_precision = '38' where tablename = 'invoicedetailview' AND field = 'taxable_euro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','6','decimal','','S','System.Decimal','decimal(38,6)','N','invoicedetailview','N','','17','taxable_euro','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'unabatabilitypercentage')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '6',sqltype = 'decimal',defaultvalue = '',allownull = 'N',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,6)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'S',format = '',col_len = '9',field = 'unabatabilitypercentage',col_precision = '19' where tablename = 'invoicedetailview' AND field = 'unabatabilitypercentage'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','6','decimal','','N','System.Decimal','decimal(19,6)','N','invoicedetailview','S','','9','unabatabilitypercentage','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'unabatable')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '2',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(19,2)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '9',field = 'unabatable',col_precision = '19' where tablename = 'invoicedetailview' AND field = 'unabatable'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','2','decimal','','S','System.Decimal','decimal(19,2)','N','invoicedetailview','N','','9','unabatable','19')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'unabatable_euro')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '7',sqltype = 'decimal',defaultvalue = '',allownull = 'S',systemtype = 'System.Decimal',sqldeclaration = 'decimal(38,7)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '17',field = 'unabatable_euro',col_precision = '38' where tablename = 'invoicedetailview' AND field = 'unabatable_euro'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','7','decimal','','S','System.Decimal','decimal(38,7)','N','invoicedetailview','N','','17','unabatable_euro','38')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'upb')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'varchar',defaultvalue = '',allownull = 'S',systemtype = 'System.String',sqldeclaration = 'varchar(150)',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '150',field = 'upb',col_precision = '' where tablename = 'invoicedetailview' AND field = 'upb'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','varchar','','S','System.String','varchar(150)','N','invoicedetailview','N','','150','upb','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'yinv')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'N',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'invoicedetailview',denynull = 'S',format = '',col_len = '2',field = 'yinv',col_precision = '' where tablename = 'invoicedetailview' AND field = 'yinv'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','smallint','','N','System.Int16','smallint','N','invoicedetailview','S','','2','yinv','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'yinv_main')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '2',field = 'yinv_main',col_precision = '' where tablename = 'invoicedetailview' AND field = 'yinv_main'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','smallint','','S','System.Int16','smallint','N','invoicedetailview','N','','2','yinv_main','')
GO

IF exists(SELECT * FROM columntypes WHERE tablename = 'invoicedetailview' AND field = 'yman')
UPDATE columntypes set createuser = 'NINO',lastmoduser = '''NINO''',col_scale = '',sqltype = 'smallint',defaultvalue = '',allownull = 'S',systemtype = 'System.Int16',sqldeclaration = 'smallint',iskey = 'N',tablename = 'invoicedetailview',denynull = 'N',format = '',col_len = '2',field = 'yman',col_precision = '' where tablename = 'invoicedetailview' AND field = 'yman'
ELSE
INSERT INTO columntypes (createuser,lastmoduser,col_scale,sqltype,defaultvalue,allownull,systemtype,sqldeclaration,iskey,tablename,denynull,format,col_len,field,col_precision) VALUES('NINO','''NINO''','','smallint','','S','System.Int16','smallint','N','invoicedetailview','N','','2','yman','')
GO

-- VERIFICA DI invoicedetailview IN CUSTOMOBJECT --
IF EXISTS(select * from customobject where objectname = 'invoicedetailview')
UPDATE customobject set isreal = 'N' where objectname = 'invoicedetailview'
ELSE
INSERT INTO customobject (objectname, isreal) values('invoicedetailview', 'N')
GO
-- FINE GENERAZIONE SCRIPT --

