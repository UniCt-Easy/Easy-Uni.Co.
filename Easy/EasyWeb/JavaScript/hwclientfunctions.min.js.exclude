// JScript File
function GenLeaveTB(e,t,n){if(t.disabled)return;if(t.readOnly)return;if(t=="")return;try{var r=GetObjectFromString(e,t.value,n);t.value=StringValue(r,n)}catch(i){}}function GetObjectFromString(e,t,n){if(e==null)t="";var r;r=GetFieldLower(n,0);if(r=="")r=null;var i;i=t;var s=new Object;try{switch(e){case"String":s.TypeName="String";s.Obj=i;return s;break;case"Char":{s.TypeName="Char";s.Obj=i.charAt(0);return s}break;case"Double":{s.TypeName="Double";var o;o=0;if(i=="")return null;if(r==null){i=ConvertToJSNumber(i,GetNumberStyles(r));o=parseFloat(i);if(isNaN(o))return null;s.Obj=o;return s}if(IsStandardNumericFormatStyle(r)){var u;i=ConvertToJSNumber(i,GetNumberStyles(r));u=parseFloat(i);if(isNaN(u))return null;s.Obj=u;return s}if(r=="fixed"){var a=GetFieldLower(n,1);var f=GetFieldLower(n,2);if(f==null)f="";var l=GetFieldLower(n,3);if(l==null)l="";if(f!="")i=i.replace(f,"");if(l!="")i=i.replace(l,"");i=ConvertToJSNumber(i,GetNumberStyles(r));var c;c=parseInt(a);var h;h=GetFieldLower(n,4);if(h=="")h=null;o=parseFloat(i);if(isNaN(o))return null;o=o.toFixed(c);var p=0;if(h!=null)p=parseFloat(h);if(isNaN(p))return null;if(p!=0)o=o/p;s.Obj=o;return s}return null}break;case"Single":{var d;s.TypeName="Single";if(i=="")return null;if(r==null){i=ConvertToJSNumber(i,GetNumberStyles(r));d=parseFloat(i);if(isNaN(d))return null;s.Obj=d;return s}if(IsStandardNumericFormatStyle(r)){var v;i=ConvertToJSNumber(i);v=parseFloat(i);s.Obj=v;return s}if(r=="fixed"){var a=GetFieldLower(n,1);var f=GetFieldLower(n,2);if(f==null)f="";var l=GetFieldLower(n,3);if(l==null)l="";if(f!="")i=i.replace(f,"");if(l!="")i=i.replace(l,"");var c;c=parseInt(a);var h;h=GetFieldLower(n,4);if(h=="")h=null;i=ConvertToJSNumber(i,GetNumberStyles(r));d=parseFloat(i);if(isNaN(d))return null;d=d.toFixed(c);var p=0;if(h!=null)p=parseFloat(h);if(isNaN(p))return null;if(p!=0)d=d/p;s.Obj=d;return s}return null}break;case"Decimal":{s.TypeName="Decimal";if(i=="")return null;if(r==null){var m;m=0;i=ConvertToJSNumber(i,GetNumberStyles(r));m=parseFloat(i);if(isNaN(m))return null;m=m.toFixed(1);s.Obj=m;return s}if(IsStandardNumericFormatStyle(r)){var g;i=ConvertToJSNumber(i,GetNumberStyles(r));g=parseFloat(i);if(isNaN(g))return null;g=g.toFixed(2);s.Obj=g;return s}if(r=="fixed"){var a=GetFieldLower(n,1);var f=GetFieldLower(n,2);if(f==null)f="";var l=GetFieldLower(n,3);if(l==null)l="";if(f!="")i=i.replace(f,"");if(l!="")i=i.replace(l,"");var c;c=parseInt(a);var h;h=GetFieldLower(n,4);if(h=="")h=null;i=ConvertToJSNumber(i,GetNumberStyles(r));m=parseFloat(i);if(isNaN(m))return null;m=m.toFixed(c);var p=0;if(h!=null)p=parseFloat(h);if(isNaN(p))return null;if(p!=0)m=m/p;s.Obj=m;return s}}break;case"DateTime":{s.TypeName="DateTime";if(i=="")return null;var y;if(IsStandardDateFormatStyle(r)){y=ConvertDateStringToDate(i,r);s.Obj=y;return s}y=ConvertDateStringToDate(i,"d");s.Obj=y;return s}break;case"Byte":{s.TypeName="Byte";if(i=="")return null;var b;b=parseInt(i);if(isNaN(b))return null;if(r==null){s.Obj=b;return s}if(IsStandardNumericFormatStyle(r)){b=parseInt(i);if(isNaN(b))return null;s.Obj=b;return s}return b}break;case"Int16":{s.TypeName="Int16";if(i=="")return null;var w;w=parseInt(i);if(isNaN(w))return null;if(r==null){s.Obj=w;return s}if(IsStandardNumericFormatStyle(r)){w=parseInt(i);if(isNaN(w))return null;s.Obj=w;return s}if(r=="year"){if(w>=100){s.Obj=w;return s}var E=new Date;var S;S=myGetYear(E);var x;x=S%100;var T;T=S-x;w=w+T;if(x>50)w=w+100;s.Obj=w;return s}return null}break;case"Int32":{s.TypeName="Int32";if(i=="")return null;var N;N=parseInt(i);if(r==null){s.Obj=N;return s}if(IsStandardNumericFormatStyle(r)){N=parseInt(i);if(isNaN(N))return null;s.Obj=N;return s}if(r=="year"){if(N>=100){s.Obj=N;return s}var E=new Date;var S;S=myGetYear(E);var x;x=S%100;var T;T=S-x;N=N+T;if(x>50)N=N+100;s.Obj=N;return s}return null}break;default:s.Obj="'"+i+"'";return s}}catch(C){alert("Error converting "+i+" into "+e)}}function StringValue(e,t){if(e==null)return"";var n;var r;n=e.TypeName;localObject=e.Obj;if(localObject==null)return"";if(n=="DateTime"){var i=GetFieldLower(t,0);if(IsStandardDateFormatStyle(i)){r=ConvertDateToDateString(localObject,i);return r}r=ConvertDateToDateString(localObject,"d");return r}else{var i=GetFieldLower(t,0);var s;if(n=="Decimal"||n=="Single"||n=="Double"){if(i==null){return ConvertToNumberString(localObject,2,GetNumberStyles(i))}if(IsStandardNumericFormatStyle(i)){return ConvertToNumberString(localObject,2,GetNumberStyles(i))}if(i=="fixed"){s=parseFloat(localObject);var o=GetFieldLower(t,1);var u=GetFieldLower(t,2);if(u==null)u="";var a=GetFieldLower(t,3);if(a==null)a="";var f=parseInt(o);var l=GetFieldLower(t,4);if(l==null)l=0;var c;if(l!=null)c=parseFloat(l);if(c!=0&&!isNaN(c))s=s*c;var h=ConvertToNumberString(s,f,GetNumberStyles(i));if(u!="")h=u+" "+h;if(a!="")h=h+" "+a;return h}}}return localObject.toString()}function IsStandardNumericFormatStyle(e){switch(e){case"n":return true;break;case"c":return true;break;case"d":return true;break;case"e":return true;break;case"f":return true;break;case"g":return true;break;case"x":return true;break;case"p":return true;break;default:return false}}function GetNumberStyles(e){switch(e){case"n":return"Number";break;case"c":return"Currency";break;case"d":return"Integer";break;case"e":return"Float";break;case"f":return"Float";break;case"g":return"Any";break;case"x":return"HexNumber";break;case"p":return"Number";break}return"Any"}function IsStandardDateFormatStyle(e){switch(e){case"d":return true;break;case"D":return true;break;case"t":return true;break;case"T":return true;break;case"f":return true;break;case"F":return true;break;case"g":return true;break;case"G":return true;break;case"m":return true;break;case"M":return true;break;case"r":return true;break;case"R":return true;break;case"s":return true;break;case"u":return true;break;case"U":return true;break;case"y":return true;break;case"Y":return true;break;default:return false}}function GetFieldLower(e,t){var n;if(e==null||e=="")return null;n=e.split(".");if(t>n.length)return n[n.length].toLowerCase();return n[t].toLowerCase()}function ConvertDateStringToDate(e,t){if(e==null)return null;e=e.trim();if(e!=""){switch(t){case"d":{var n;if(e.indexOf("/")!=-1)e=e.replace(/\//g," ");if(e.indexOf("-")!=-1)e=e.replace(/\-/g," ");e=e.replace(/\s+/g," ");n=e.split(" ");if(isNaN(parseFloat(ParseYear(n[2])))||isNaN(parseFloat(n[1]))||isNaN(parseFloat(n[0])))return null;var r=new Date(ParseYear(n[2]),parseFloat(n[1])-1,parseFloat(n[0]));return r}break;case"D":{return null}break;case"g":{var n;var i=false;if(e.indexOf(":")!=-1||e.indexOf(".")!=-1){e=e.replace(/\:/g," ");e=e.replace(/\./g," ");i=true}if(e.indexOf("/")!=-1)e=e.replace(/\//g," ");if(e.indexOf("-")!=-1)e=e.replace(/\-/g," ");e=e.replace(/\s+/g," ");n=e.split(" ");switch(n.length){case 2:{if(i){var r=new Date;var s=ParseYear(myGetYear(r).toString());var o=r.getMonth();var u=r.getDate();var a=n[0];var f=n[1];if(isNaN(parseFloat(s))||isNaN(parseFloat(o))||isNaN(parseFloat(u))||isNaN(parseFloat(a))||isNaN(parseFloat(f)))return null;var r=new Date(s,o,u,a,f)}else{if(isNaN(ParseYear(n[2]))||isNaN(parseFloat(n[1]))||isNaN(parseFloat(n[0])))return null;var r=new Date(ParseYear(n[2]),parseFloat(n[1])-1,parseFloat(n[0]))}}break;case 3:if(isNaN(ParseYear(n[2]))||isNaN(parseFloat(n[1]))||isNaN(parseFloat(n[0])))return null;var r=new Date(ParseYear(n[2]),parseFloat(n[1])-1,parseFloat(n[0]),0,0);break;case 5:if(isNaN(ParseYear(n[2]))||isNaN(parseFloat(n[1]))||isNaN(parseFloat(n[0]))||isNaN(parseFloat(n[3]))||isNaN(parseFloat(n[4])))return null;var r=new Date(ParseYear(n[2]),parseFloat(n[1])-1,parseFloat(n[0]),parseFloat(n[3]),parseFloat(n[4]));break}return r}break}}else{return null}}function ConvertDateToDateString(e,t){var n;var r;var i;var s;var o;var u;var a;var f;var l;var c;var h;var p;var d;if(e==null)return null;n=e;r=myGetYear(n);i=n.getMonth()+1;s=n.getDate();switch(t){case"d":{f=s.toString();if(f.length==1)f="0"+f;l=i.toString();if(l.length==1)l="0"+l;c=r.toString();d=f+"/"+l+"/"+c;return d}break;case"D":{return null}break;case"g":{o=n.getHours();u=n.getMinutes();f=s.toString();if(f.length==1)f="0"+f;l=i.toString();if(l.length==1)l="0"+l;c=r.toString();h=o.toString();p=u.toString();if(p.length==1)p="0"+p;d=f+"/"+l+"/"+c+" "+h+"."+p;return d}}}function ConvertToJSNumber(e,t){var n;if(e==null||e=="")return null;switch(t){case"Currency":e=e.replace(CurrencySymbol,"");while(e.indexOf(".")!=-1)e=e.replace(CurrencyGroupSeparator,"");n=e.replace(CurrencyDecimalSeparator,".");break;default:while(e.indexOf(".")!=-1)e=e.replace(NumberGroupSeparator,"");n=e.replace(NumberDecimalSeparator,".");break}return n}function ConvertToNumberString(e,t,n){var r;var i;var s;var o;var u;var a;var f="";if(e==null)return null;if(e=="")e="0";o=parseFloat(e);if(parseInt(t)>0)o=o.toFixed(parseInt(t));else o=o.toFixed(0);e=o.toString();if(e.indexOf("-")!=-1){a=true;e=e.replace("-","")}if(e.indexOf(".")!=-1){r=e.split(".");i=r[0];s=r[1];u=NumberDecimalSeparator}else{i=e;u="";s=""}if(i.length>3){var l;var c;l=1;c="";for(var h=i.length-1;h>=0;h--){if(l%3==0&&h!=0)c=NumberGroupSeparator+i.charAt(h)+c;else c=i.charAt(h)+c;l++}i=c}if(n=="Currency")f=CurrencySymbol+" ";if(a)return"-"+f+i+u+s;else return f+i+u+s}function ExtEnterDecTextBox(e,t){if(e.disabled)return;if(e.readOnly)return;e.value=e.value.trim();if(e.value=="")return;var n=GetFieldLower(t,0);if(n==null||n=="c"){var r=e.value;r=r.replace(CurrencySymbol,"");while(r.indexOf(NumberGroupSeparator)!=-1)r=r.replace(NumberGroupSeparator,"");r=r.replace(" ","");e.value=r.trim();return}if(n=="n"){r=e.value;while(r.indexOf(NumberGroupSeparator)!=-1)r=r.replace(NumberGroupSeparator,"");r=r.replace(CurrencySymbol,"");e.value=r.trim()}if(n=="fixed"){var i=GetFieldLower(t,1);var s=parseInt(i);var o=GetFieldLower(t,2);if(o==null)o="";var u=GetFieldLower(t,3);if(u==null)u="";var a=e.value;if(o!="")a=a.replace(o,"");if(u!="")a=a.replace(u,"");while(a.indexOf(NumberGroupSeparator)!=-1)a=a.replace(NumberGroupSeparator,"");e.value=a.trim()}}function ExtEnterNumTextBox(e,t){if(e.disabled)return;if(e.readOnly)return;e.value=e.value.trim();if(e.value=="")return;var n=GetFieldLower(t,0);if(n==null||n=="n"){S=e.value;while(S.indexOf(NumberGroupSeparator)!=-1)S=S.replace(NumberGroupSeparator,"");e.value=S.trim()}if(n=="c"){S=e.value;while(S.indexOf(NumberGroupSeparator)!=-1)S=S.replace(NumberGroupSeparator,"");S=S.replace(CurrencySymbol,"");e.value=S.trim()}if(n=="fixed"){var r=GetFieldLower(t,1);var i=parseInt(r);var s=GetFieldLower(t,2);if(s==null)s="";var o=GetFieldLower(t,3);if(o==null)o="";var u=e.value;if(s!="")u=u.replace(s,"");if(o!="")u=u.replace(o,"");while(u.indexOf(NumberGroupSeparator)!=-1)u=u.replace(NumberGroupSeparator,"");e.value=u.trim()}}function FormatLikeYear(e){var t=parseInt(e.value);if(isNaN(t))return;if(t>=100)return;var n=new Date;var r=myGetYear(n);var i=r%100;var s=r-i;t=t+s;if(i>50)t=t+100;e.value=t.toString();return}function myGetYear(e){var t;if(e==null)return null;return e.getFullYear();t=e.getYear();if(Browser=="netscape"){return 1900+t}else{if(t>=0&&t<=99)return 1900+t;else return t}}function ParseYear(e){if(typeof e=="undefined"||e==null||e.trim()==""){var t=new Date;e=myGetYear(t)}var n=parseFloat(e);if(n>=0&&n<=29)return 2e3+n;if(n>=30&&n<=99)return 1900+n;return n}function CreateXSLTProcessObject(){var e;if(window.ActiveXObject){try{e=new ActiveXObject("Microsoft.XMLDOM")}catch(t){}}else e=new XSLTProcessor;return e}function CreateXmlHttpRequestObject(){var e;if(window.ActiveXObject){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){e=new ActiveXObject("Msxml2.XMLHTTP")}}else e=new XMLHttpRequest;return e}function SelectRow(e,t){if(typeof ElmElenco=="undefined")return;document.getElementById(ElmElenco).style.display="none";EnableControls();if(t!=null&&t!=""){document.getElementById(t).className="";document.getElementById(ElmRecordIsSelected).value="S";document.getElementById(t).blur()}else{document.getElementById(ElmRecordIsSelected).value="S"}document.getElementById(ElmSelectedRecord).value=e;document.getElementById(ElmPreservePreviousValue).value="N";document.getElementById(ElmSelectedRecord).onchange();return true}function CloseList(e){setTimeout("HideList()",200);DestroyCLM();EnableControls();ListHeight=0;ListWidth=0;TopWindowPos=200;LeftWindowPos=50;isListFullSized=false;PreviousSelectedRow=-1;PreviousRowClassName="";document.getElementById(ElmRecordIsSelected).value="N";RecordIsSelected=false;if(e!=null){document.getElementById(ElmPreservePreviousValue).value="S";e.focus()}else document.getElementById(ElmShowElenco).value="N";return}function DestroyCLM(){var e;e=CreateXmlHttpRequestObject();e.open("GET",XMLRequestURL+"?DestroyCLM=Y",false);var t=e.responseXML;e.send(null);return}function HideList(){document.getElementById(ElmElenco).style.display="none";return}function CreateList(e,t,n){var r;DisableControls();r=CreateXmlHttpRequestObject();if(t!="")r.open("GET",XMLRequestURL+"?TxtBoxId="+escape(t)+"&Value="+escape(e)+"&PageNumber="+n+"&DivElencoId="+ElmElenco,false);else r.open("GET",XMLRequestURL+"?PageNumber="+n+"&DivElencoId="+ElmElenco,false);var i=r.responseXML;r.send(null);xslHttpObj=CreateXmlHttpRequestObject();xslHttpObj.open("GET",XSLTRequestURL,false);var s=xslHttpObj.responseXML;xslHttpObj.send(null);if(window.ActiveXObject){var o=i.getElementsByTagName("totalpages")[0].firstChild.data;var u=i.transformNode(s)}else{var a=CreateXSLTProcessObject();a.importStylesheet(xslHttpObj.responseXML);var o=r.responseXML.getElementsByTagName("totalpages")[0].firstChild.data;var f=a.transformToFragment(r.responseXML,document);var u=(new XMLSerializer).serializeToString(f)}if(!window.ActiveXObject){u=u.replace(/&/gi,"&");u=u.replace(/</gi,"<");u=u.replace(/>/gi,">")}CurrentPageDisplayed=n;FirstPageDisplayedInList=n-NumberOfPagesInFooter/2;if(FirstPageDisplayedInList<1)FirstPageDisplayedInList=1;LastPageDisplayed=FirstPageDisplayedInList+NumberOfPagesInFooter-1;if(NumberOfPagesInFooter<NumberOfPagesInList){if(LastPageDisplayed>NumberOfPagesInList){FirstPageDisplayedInList=NumberOfPagesInList-NumberOfPagesInFooter+1;LastPageDisplayed=NumberOfPagesInList}}else{FirstPageDisplayedInList=1;LastPageDisplayed=NumberOfPagesInList}document.getElementById(ElmElenco).innerHTML="";document.getElementById(ElmElenco).innerHTML=u;document.getElementById(ElmElenco).style.display="block";CreateFooter();var l=1e3;if(navigator.appName=="Netscape"){l=window.innerWidth}if(navigator.appName.indexOf("Microsoft")!=-1){l=document.body.offsetWidth}$("table.to_pgrid").pgrid({pgrid_footer:false,pgrid_count:false,pgrid_select:false,pgrid_multi_select:false,pgrid_paginate:false,pgrid_page:2,pgrid_perpage:5,pgrid_filtering:false,pgrid_filter:"",pgrid_resize_cols:false,pgrid_sortable:false,pgrid_sort_col:false,pgrid_sort_ord:"asc",pgrid_stripe_rows:false,pgrid_row_hover_effect:true,pgrid_view_height:"auto",pgrid_resize:false});var c=(l-document.getElementById(ElmElenco).offsetWidth)/2;c=c.toFixed(0);$("#"+ElmElenco).draggable();return}function disable_at_start(e,t){if(e==null)return;try{if(e.disabled)t.push(e);else e.disabled=true}catch(n){}if(e.childNodes&&e.childNodes.length>0){for(var r=0;r<e.childNodes.length;r++){disable_at_start(e.childNodes[r],t)}}}function disable(e){if(!e)return;try{e.disabled=true}catch(t){}if(e.childNodes&&e.childNodes.length>0){for(var n=0;n<e.childNodes.length;n++){disable(e.childNodes[n])}}}function enable(e){if(!e)return;try{e.className=e.className.replace(new RegExp("(^|\\s)ui-state-disabled(\\s|$)")," ");e.disabled=false}catch(t){}if(e.childNodes&&e.childNodes.length>0){for(var n=0;n<e.childNodes.length;n++){enable(e.childNodes[n])}}}function hide(e){$("#"+e).hide("slide",{},1e3,null);return false}function show(e){$("#"+e).show("slide",{},1e3,null);return false}function StPrv(e){var t=document.getElementById(ElmPreservePreviousValue).value=="S"?true:false;if(!t){document.getElementById(ElmPreviousValue).value=e.value;return true}else{document.getElementById(ElmPreservePreviousValue).value="N";return false}}function TMod(e){if(document.getElementById(ElmPreviousValue).value==e.value){if(TextBoxIdForList==e.id&&!RecordIsSelected&&e.value!="")return true;else return false}else return true}function init(){if(typeof ElmElenco=="undefined")return;var e=document.getElementById(ElmElenco);RecordIsSelected=document.getElementById(ElmRecordIsSelected).value=="S"?true:false;if(document.getElementById(ElmShowElenco)!=null&&document.getElementById(ElmShowElenco).value=="S"){RenderListFooterAfterPostBack();e.style.display="block";DisableControls()}else{e.style.display="none"}if(navigator.appName=="Netscape"){var t=window.innerWidth}if(navigator.appName.indexOf("Microsoft")!=-1){var t=document.body.offsetWidth}e.style.margin="0px";e.style.position="absolute";var n=(t-e.offsetWidth)/2;n=n.toFixed(0);e.style.left=n+"px";e.style.top="20px";$("#"+ElmElenco).draggable();InitTabs();if(FocusOnStartup!=null&&FocusOnStartup!=""){try{SelectTabForControl(document.getElementById(FocusOnStartup));document.getElementById(FocusOnStartup).focus()}catch(r){return}try{if(SimulateTab=="S"){SelectNextAfter(document.getElementById(FocusOnStartup))}}catch(r){}FocusOnStartup=null}return}function SelectNextAfter(e){selectednext=null;$(":visible").each(function(t,n){if(n.tabIndex==null)return;if(n.tabIndex<=e.tabIndex)return;if(selectednext==null){selectednext=n;return}if(selectednext.tabIndex<n.tabIndex)return;selectednext=n});if(selectednext==null)return;selectednext.focus()}function mD(e,t){dragObject=e;if(window.event)t=window.event;var n=parseInt(dragObject.style.left);var r=parseInt(dragObject.style.top);var i=t.clientX;var s=t.clientY;offsetX=i-n;offsetY=s-r;isDragging=true;return false}function mM(e){if(!isDragging)return;if(window.event)e=window.event;var t=e.clientX-offsetX;var n=e.clientY-offsetY;if(isDragging){dragObject.style.left=t+"px";dragObject.style.top=n+"px"}}function mU(){if(!isDragging)return;isDragging=false;return false}function SetImageSrc(e,t){if(e==null){alert("SetImageSrcByID  --- Controllo non trovato : "+IDImg);return}e.src=t}function RenderListFooterAfterPostBack(){CreateFooter();return;var e}function CreateFooter(){var e;e=document.getElementById("tblFooter");var t="";if(NumberOfPagesInList<=1){t+="<table width='100%' height='27px' valign='center'><tr valign='center'><td valign='center'><center><span valign='center'>";t+="</span></center></td></tr></table>";e.innerHTML=t;return}t+="<table width='100%' height='27px' valign='center'><tr valign='center'><td valign='center'><center><span valign='center'>";if(FirstPageDisplayedInList+NumberOfPagesInFooter-1>NumberOfPagesInList)var n=NumberOfPagesInList;else var n=FirstPageDisplayedInList+NumberOfPagesInFooter-1;if(CurrentPageDisplayed>1)t+="<img align='middle' src='Immagini/First.gif' onclick='Javascript:GoFirstPage();'>";if(FirstPageDisplayedInList>1)t+="<img align='middle' src='Immagini/PreviousTen.gif' onclick='Javascript:ShowPreviousPages();'>";if(CurrentPageDisplayed>1)t+="<img align='middle' src='Immagini/Previous.gif' onclick='Javascript:GoPreviousPage();'>";var r=document.getElementById(TextBoxIdForList);for(var i=FirstPageDisplayedInList;i<=n;i++){if(i!=CurrentPageDisplayed){if(TextBoxIdForList!=""&&r!=null)t+="<a href=\"Javascript:CreateList('"+r.value+"','"+r.id+"',"+i+');">'+i+"</a> ";else t+="<a href=\"Javascript:CreateList('','',"+i+');">'+i+"</a> "}else t+="<b>"+i+" </b>"}if(CurrentPageDisplayed<NumberOfPagesInList)t+="<img align='middle' src='Immagini/Next.gif' onclick='Javascript:GoNextPage();'>";if(n<NumberOfPagesInList)t+="<img align='middle' src='Immagini/NextTen.gif' onclick='Javascript:ShowNextPages();'>";if(CurrentPageDisplayed!=NumberOfPagesInList)t+="<img align='middle' src='Immagini/Last.gif' onclick='Javascript:GoLastPage();'>";t+="</span></center></td>";t+="</tr></table>";e.innerHTML="";e.innerHTML=t;return}function GoNextPage(){CurrentPageDisplayed=CurrentPageDisplayed+1;if(CurrentPageDisplayed>NumberOfPagesInList)CurrentPageDisplayed=NumberOfPagesInList;var e=document.getElementById(TextBoxIdForList);if(e!=null)CreateList(e.value,e.id,CurrentPageDisplayed);else CreateList("","",CurrentPageDisplayed);return}function ShowNextPages(){if(CurrentPageDisplayed+NumberOfPagesInFooter>NumberOfPagesInList)CurrentPageDisplayed=NumberOfPagesInList;else CurrentPageDisplayed+=NumberOfPagesInFooter;var e=document.getElementById(TextBoxIdForList);if(e!=null)CreateList(e.value,e.id,CurrentPageDisplayed);else CreateList("","",CurrentPageDisplayed);return}function GoPreviousPage(){if(CurrentPageDisplayed>1)CurrentPageDisplayed-=1;var e=document.getElementById(TextBoxIdForList);if(e!=null)CreateList(e.value,e.id,CurrentPageDisplayed);else CreateList("","",CurrentPageDisplayed);return}function ShowPreviousPages(){CurrentPageDisplayed-=NumberOfPagesInFooter;if(CurrentPageDisplayed<1)CurrentPageDisplayed=1;var e=document.getElementById(TextBoxIdForList);if(e!=null)CreateList(e.value,e.id,CurrentPageDisplayed);else CreateList("","",CurrentPageDisplayed);return}function GoFirstPage(){CurrentPageDisplayed=1;var e=document.getElementById(TextBoxIdForList);if(e!=null)CreateList(e.value,e.id,CurrentPageDisplayed);else CreateList("","",CurrentPageDisplayed);return}function GoLastPage(){CurrentPageDisplayed=NumberOfPagesInList;var e=document.getElementById(TextBoxIdForList);if(e!=null)CreateList(e.value,e.id,CurrentPageDisplayed);else CreateList("","",CurrentPageDisplayed);return}function DisableControls(){if(document.getElementById(ElmContent)!=null)disable_at_start(document.getElementById(ElmContent),ControlsArray);if(document.getElementById(ElmToolbar)!=null)disable_at_start(document.getElementById(ElmToolbar),ControlsArray);if(document.getElementById(ElmList)!=null)disable_at_start(document.getElementById(ElmList),ControlsArray);return}function EnableControls(){if(document.getElementById(ElmContent)!=null)enable(document.getElementById(ElmContent));if(document.getElementById(ElmToolbar)!=null)enable(document.getElementById(ElmToolbar));if(document.getElementById(ElmList)!=null)enable(document.getElementById(ElmList));return}function Resize(){if(!isListFullSized){$("#icondialogresize").removeClass("ui-icon-arrow-4-diag");$("#icondialogresize").addClass("ui-icon-newwin");TopWindowPos=$("#"+ElmElenco).offset().top;LeftWindowPos=$("#"+ElmElenco).offset().left;$("#"+ElmElenco).offset({top:0,left:0});ListWidth=$("#"+ElmElenco).width();ListHeight=$("#"+ElmElenco).height();$("#"+ElmElenco).width("100%");$("#"+ElmElenco).height("100%");isListFullSized=true}else{$("#icondialogresize").addClass("ui-icon-arrow-4-diag");$("#icondialogresize").removeClass("ui-icon-newwin");$("#"+ElmElenco).offset({top:TopWindowPos,left:LeftWindowPos});$("#"+ElmElenco).width(ListWidth);$("#"+ElmElenco).height(ListHeight);isListFullSized=false}return}function ReplaceImg(){document.images.imgResize.src="Immagini/Resize.gif";return}function HighlightListRow(e){PreviousSelectedRow=e;return;if(PreviousSelectedRow!=-1){document.getElementById("tblListRow"+PreviousSelectedRow).className="";document.getElementById("tblListRow"+PreviousSelectedRow).className=PreviousRowClassName}PreviousRowClassName=document.getElementById("tblListRow"+e).className;document.getElementById("tblListRow"+e).className="ui-pgrid-table-row-selected ui-state-active";PreviousSelectedRow=e}function InitTabs(){for(var e=1;e<=MaxTabNumber;e++){if(document.getElementById("Tab"+e+"Folder1")!=null){for(var t=1;t<=MaxFolderPerTabNumber;t++){if(document.getElementById("Tab"+e+"Folder"+t)==null){FolderNumber[e]=t-1;break}}}}var n="";for(var e=1;e<=MaxTabNumber;e++){n="";if(FolderNumber[e]!=null){for(var t=1;t<=FolderNumber[e];t++)n+='<span id="HTab'+e+"Folder"+t+'" class="TabsHeaderUnselected" onclick="javascript:SwitchTab('+e+","+t+')">  '+document.getElementById("Tab"+e+"Folder"+t).title+"  </span>";document.getElementById("TabsHeader"+e).innerHTML=n}}var r=false;for(var e=1;e<=MaxTabNumber;e++){if(FolderNumber[e]!=null)if(document.getElementById(ElmCurrentFoldersConfig)!=null&&document.getElementById(ElmCurrentFoldersConfig).value!=null&&document.getElementById(ElmCurrentFoldersConfig).value!=""){var i=GetCurrentFolderForTab(e);SwitchTab(e,i)}else{SwitchTab(e,1);r=true}}if(r)BuildInitialFoldersConfig();return}function BuildInitialFoldersConfig(){var e="";for(var t=1;t<=MaxTabNumber;t++){e+="1|"}e=e.substring(0,e.length-1);document.getElementById(ElmCurrentFoldersConfig).value=e}function GetCurrentFolderForTab(e){var t;var n;if(document.getElementById(ElmCurrentFoldersConfig).value!=null&&document.getElementById(ElmCurrentFoldersConfig).value!=""){t=document.getElementById(ElmCurrentFoldersConfig).value;n=t.split("|");if(n[e-1]!=null)return n[e-1];else return 1}else return 1}function StoreFolderForTab(e,t){var n;var r;if(document.getElementById(ElmCurrentFoldersConfig).value!=null&&document.getElementById(ElmCurrentFoldersConfig).value!=""){n=document.getElementById(ElmCurrentFoldersConfig).value;r=n.split("|");r[e-1]=t;var i="";for(var s=0;s<r.length;s++)i+=r[s]+"|";i=i.substring(0,i.length-1);document.getElementById(ElmCurrentFoldersConfig).value=i}}function SwitchTab(e,t){for(var n=1;n<=FolderNumber[e];n++){document.getElementById("Tab"+e+"Folder"+n).style.display="none";document.getElementById("HTab"+e+"Folder"+n).className="TabsHeaderUnselected"}document.getElementById("Tab"+e+"Folder"+t).style.display="block";document.getElementById("HTab"+e+"Folder"+t).className="TabsHeaderSelected";StoreFolderForTab(e,t);return}function SelectTabForControl(e){if(!e)return;if(e.parentNode==null)return;var t=e.parentNode;var n=new RegExp("^Tab([\\d+])Folder([\\d+])");var r=n.exec(t.id);if(r==null){SelectTabForControl(t);return}try{SwitchTab(r[1],r[2])}catch(i){}}function CKen(e){TargetControl=e.id;if(OriginControl!=null&&OriginControl!=""){ForcedOnBlur=true;document.getElementById(OriginControl).onblur();return false}else return true}function CKlv(e){if(ForcedBlur)return false;if(e.id==TargetControl){OriginControl=e.id;return false}else{return true}}function ChkBox_MouseOver(e,t){var n=document.getElementById(e);var r=document.getElementById(e+"_img");if(t==3){if(n.value==0)r.src=UnCheckImgOver;else{if(n.value==1)r.src=CheckImgOver;else r.src=IndetImgOver}}else{r.src=n.value==1?CheckImgOver:UnCheckImgOver}}function ChkBox_MouseOut(e,t){var n=document.getElementById(e);var r=document.getElementById(e+"_img");if(t==3){if(n.value==0)r.src=UnCheckImg;else{if(n.value==1)r.src=CheckImg;else r.src=IndetImg}}else{r.src=n.value==1?CheckImg:UnCheckImg}}function ChkBox_MouseClick(e,t,n){var r=document.getElementById(e);var i=document.getElementById(e+"_img");var s;var o;var u;if(n){s=CheckImgOver;o=UnCheckImgOver;u=IndetImgOver}else{s=CheckImg;o=UnCheckImg;u=IndetImg}if(t==3){if(r.value==1){r.value=2;i.src=u}else{if(r.value==2){r.value=0;i.src=o}else{r.value=1;i.src=s}}}else{if(r.value==1){r.value=0;i.src=o}else{r.value=1;i.src=s}}}function ChkBox_Focus(e){if(CKen(e)==true){}}function ChkBox_Blur(e){if(CKlv(e)==true){}if(ForcedOnBlur){OriginControl="";ForcedOnBlur=false;if(e.id==TargetControl){ForcedBlur=true;document.getElementById(TargetControl).focus();ForcedBlur=false}else{document.getElementById(TargetControl).onfocus()}}}function checksubmit(){if(issubmitting){alert("Please wait..");return false}issumitting=true;return true}function ckblur(e){if(ForcedOnBlur){OriginControl="";ForcedOnBlur=false;if(e.id==TargetControl){ForcedBlur=true;document.getElementById(TargetControl).focus();ForcedBlur=false}else{document.getElementById(TargetControl).onfocus()}}}function ckleave(e){if(ForcedOnBlur){OriginControl="";ForcedOnBlur=false;if(e.id==TargetControl){ForcedBlur=true;document.getElementById(TargetControl).focus();ForcedBlur=false}else{document.getElementById(TargetControl).onfocus()}}}function EnableClientContent(){document.getElementById(ElmPreservePreviousValue).value="S";enable($("#_ctl0_CHP_PC_DIV"));enable($("#_ctl0_ToolBar_Div"));enable($("#_ctl0_Div_CHPList"));for(el in ShowClientMessage_disabled){el.disabled=true}hide("CHP_CM_DIV");if(FocusOnStartup!=null&&FocusOnStartup!=""){try{$("#"+FocusOnStartup).focus();FocusOnStartup=null}catch(e){}}return false}function disable_divs_atstart(){disable_at_start($("#_ctl0_CHP_PC_DIV"),ShowClientMessage_disabled);disable_at_start($("#_ctl0_ToolBar_Div"),ShowClientMessage_disabled);disable_at_start($("#_ctl0_Div_CHPList"),ShowClientMessage_disabled)}function savefocus(e){if(e==null)return;$(".savefocus").val(e.id)}function Tent(e){if(e==null)return;if(e.readOnly)return;$("#"+e.id).addClass("focused")}function Tlv(e){if(e==null)return;if(e.readOnly)return;if(e.disabled)return;$("#"+e.id).removeClass("focused")}function centerDiv(e){var t="#"+e.id;var n=$(t).outerWidth();var r=$(t).outerHeight();var i=$(window).width();var s=$(window).height();var o=$(window).scrollTop();var u=$(window).scrollLeft();$(e).css({position:"absolute"});$(t).css({top:(s-r)/2+o+"px"});$(e).css({"margin-left":"auto"});$(e).css({"margin-right":"auto"});$(t).css({"z-index":"1000"})}function disableF5Key(e){var t;if(e){t=e}else if(window.event){t=window.event}if(t){var n=t.keyCode?t.keyCode:t.charCode;var r=navigator.appName.toLowerCase();if(n==116){if(t.preventDefault){t.preventDefault();t.stopPropagation()}t.cancelBubble=true;if(r=="microsoft internet explorer")t.keyCode=0;else t.charCode=0;if(r=="opera")t.lastKey=null;return false}}}var NumberDecimalSeparator=",";var NumberGroupSeparator=".";var CurrencyDecimalSeparator=",";var CurrencyGroupSeparator=".";var CurrencySymbol=String.fromCharCode(8364);var Browser=navigator.appName.toLowerCase();var pTxtBoxToGiveFocus;var PreviousTxtBoxContent;var RecordIsSelected=false;var ControlsArray=new Array;var dragObject,offsetX,offsetY,isDragging=false;var dragObjectRes,offsetXRes,offsetYRes,isDraggingRes=false;var NumberOfPagesInFooter=20;var NumberOfPagesInList;var FirstPageDisplayedInList;var CurrentPageDisplayed;var issubmitting=false;var TextBoxIdForList;var ListHeight=0;var ListWidth=0;var TopWindowPos=200;var LeftWindowPos=50;var isListFullSized=false;var PreviousSelectedRow=-1;var PreviousRowClassName="";var DivNumber;var FolderNumber=new Array;var MaxTabNumber=10;var MaxFolderPerTabNumber=10;var FocusOnStartup;var OriginControl;var TargetControl;var ForcedOnBlur=false;var ForcedBlur=false;var isDetailMessageShown=false;window.onload=init;document.onmousemove=mM;document.onmouseup=mU;var CheckBoxImgPath="Immagini_CheckBox/";var CheckImg=CheckBoxImgPath+"checked.gif";var UnCheckImg=CheckBoxImgPath+"unchecked.gif";var IndetImg=CheckBoxImgPath+"checked-three.gif";var CheckImgOver=CheckBoxImgPath+"checked-over.gif";var UnCheckImgOver=CheckBoxImgPath+"unchecked-over.gif";var IndetImgOver=CheckBoxImgPath+"checked-three-over.gif";var checkImgDis=CheckBoxImgPath+"checked-dis.gif";var uncheckImgDis=CheckBoxImgPath+"unchecked-dis.gif";String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};var ShowClientMessage_disabled=new Array;$(function(){$("#_ctl0_CHP_PC_DIV button").button();$("button.masterbtn").button();$("table.to_pgrid").pgrid({pgrid_footer:false,pgrid_count:true,pgrid_select:false,pgrid_multi_select:false,pgrid_paginate:false,pgrid_row_hover_effect:false,pgrid_view_height:"auto",pgrid_resize:false});$(".btnsetsearch").button({icons:{primary:"ui-icon-search"}});$(".btndosearch").button({icons:{primary:"ui-icon-play"}});$(".btnmaininsert").button({icons:{primary:"ui-icon-plus"}});$(".btnmainsave").button({icons:{primary:"ui-icon-disk"}});$(".btnmainselect").button({icons:{primary:"ui-icon-folder-open"}});$(".btnmaindelete").button({icons:{primary:"ui-icon-trash"}});$(".btnmainclose").button({icons:{primary:"ui-icon-close"}});$("input[type='text'],textarea").hover(function(){savefocus(this)});$("input[type='select'],select").hover(function(){savefocus(this)});$("input[type='text'],textarea, input[type='password']").focus(function(){Tent(this)});$("input[type='text'],textarea").focus(function(){savefocus(this)});$("input[type='select'],select").focus(function(){savefocus(this)});$("input[type='text'],textarea, input[type='password']").focus(function(){Tent(this)});$("input[type='text'],textarea, input[type='password']").blur(function(){Tlv(this)})});if(document.addEventListener){document.addEventListener("keydown",disableF5Key,true)}else if(document.attachEvent){document.attachEvent("onkeydown",disableF5Key)}else{document.onkeydown=disableF5Key}window.history.forward(1);try{document.getElementById("_ctl0_txt_ClientConFirmed.ClientID").value="N"}catch(e){}